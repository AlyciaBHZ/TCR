Job: 1000775 on zgpuA402 at Sun Nov 30 11:02:44 +08 2025
============================================================
Scaffold Retrieval Training
============================================================
Data: flowtcr_fold/data/trn.jsonl
ESM-2: True (model: esm2_t12_35M_UR50D)
LoRA: True (rank: 8)
Classification weight: 0.2
Early stopping patience: 20
Bank mode: benchmark
============================================================
Device: cuda

Loading dataset...
Filtered: 189844 → 86282 (require pMHC + h_v_seq + h_j_seq)
Loaded 86282 samples
Gene vocab sizes: HV=113, HJ=59, LV=93, LJ=68
Loading validation data: flowtcr_fold/data/val.jsonl
Filtered: 11725 → 5313 (require pMHC + h_v_seq + h_j_seq)
Loaded 5313 samples
Gene vocab sizes: HV=113, HJ=59, LV=93, LJ=68
Validation samples: 5313

Initializing model...
LoRA injected. Trainable: 22,787,794 / 33,870,034 (67.28%)
Total params: 34,145,055
Trainable: 23,062,815 (67.54%)

Starting training...
------------------------------------------------------------

Epoch 1/100
  Batch 10/1349: loss=17.4119 (NCE=14.119, CLS=16.467)
  Batch 20/1349: loss=17.6236 (NCE=14.601, CLS=15.113)
  Batch 30/1349: loss=17.7301 (NCE=14.756, CLS=14.869)
  Batch 40/1349: loss=17.2793 (NCE=14.494, CLS=13.928)
  Batch 50/1349: loss=17.2832 (NCE=14.502, CLS=13.908)
  Batch 60/1349: loss=17.6657 (NCE=14.922, CLS=13.718)
  Batch 70/1349: loss=17.4200 (NCE=14.793, CLS=13.136)
  Batch 80/1349: loss=17.6537 (NCE=14.931, CLS=13.613)
  Batch 90/1349: loss=17.5664 (NCE=14.943, CLS=13.117)
  Batch 100/1349: loss=17.2656 (NCE=14.674, CLS=12.960)
  Batch 110/1349: loss=17.2010 (NCE=14.532, CLS=13.346)
  Batch 120/1349: loss=17.0054 (NCE=14.359, CLS=13.233)
  Batch 130/1349: loss=17.6828 (NCE=15.040, CLS=13.216)
  Batch 140/1349: loss=17.5854 (NCE=14.958, CLS=13.137)
  Batch 150/1349: loss=17.5077 (NCE=14.965, CLS=12.715)
  Batch 160/1349: loss=17.7765 (NCE=15.144, CLS=13.165)
  Batch 170/1349: loss=17.6380 (NCE=15.092, CLS=12.729)
  Batch 180/1349: loss=17.3918 (NCE=14.726, CLS=13.330)
  Batch 190/1349: loss=16.7530 (NCE=14.245, CLS=12.542)
  Batch 200/1349: loss=17.1646 (NCE=14.616, CLS=12.745)
  Batch 210/1349: loss=16.7035 (NCE=14.134, CLS=12.847)
  Batch 220/1349: loss=16.6736 (NCE=14.182, CLS=12.456)
  Batch 230/1349: loss=17.2220 (NCE=14.550, CLS=13.363)
  Batch 240/1349: loss=16.0916 (NCE=13.480, CLS=13.059)
  Batch 250/1349: loss=17.0488 (NCE=14.471, CLS=12.889)
  Batch 260/1349: loss=17.2930 (NCE=14.612, CLS=13.404)
  Batch 270/1349: loss=17.2700 (NCE=14.569, CLS=13.504)
  Batch 280/1349: loss=16.6765 (NCE=14.206, CLS=12.354)
  Batch 290/1349: loss=17.6666 (NCE=15.155, CLS=12.558)
  Batch 300/1349: loss=16.9286 (NCE=14.355, CLS=12.870)
  Batch 310/1349: loss=17.2275 (NCE=14.594, CLS=13.169)
  Batch 320/1349: loss=16.0913 (NCE=13.607, CLS=12.421)
  Batch 330/1349: loss=17.4380 (NCE=14.765, CLS=13.367)
  Batch 340/1349: loss=16.9354 (NCE=14.387, CLS=12.744)
  Batch 350/1349: loss=16.8062 (NCE=14.311, CLS=12.477)
  Batch 360/1349: loss=16.6926 (NCE=14.179, CLS=12.570)
  Batch 370/1349: loss=17.4740 (NCE=14.983, CLS=12.454)
  Batch 380/1349: loss=17.0491 (NCE=14.418, CLS=13.156)
  Batch 390/1349: loss=17.2577 (NCE=14.694, CLS=12.819)
  Batch 400/1349: loss=16.4161 (NCE=13.916, CLS=12.499)
  Batch 410/1349: loss=17.2554 (NCE=14.649, CLS=13.033)
  Batch 420/1349: loss=16.2739 (NCE=13.738, CLS=12.682)
  Batch 430/1349: loss=16.6155 (NCE=13.959, CLS=13.281)
  Batch 440/1349: loss=17.2933 (NCE=14.558, CLS=13.678)
  Batch 450/1349: loss=17.0159 (NCE=14.427, CLS=12.944)
  Batch 460/1349: loss=17.4833 (NCE=14.880, CLS=13.018)
  Batch 470/1349: loss=16.8952 (NCE=14.193, CLS=13.509)
  Batch 480/1349: loss=16.7021 (NCE=14.129, CLS=12.863)
  Batch 490/1349: loss=16.8593 (NCE=14.336, CLS=12.615)
  Batch 500/1349: loss=16.6818 (NCE=14.163, CLS=12.596)
  Batch 510/1349: loss=16.6787 (NCE=14.142, CLS=12.685)
  Batch 520/1349: loss=16.4432 (NCE=14.083, CLS=11.799)
  Batch 530/1349: loss=17.2647 (NCE=14.650, CLS=13.075)
  Batch 540/1349: loss=17.0249 (NCE=14.515, CLS=12.548)
  Batch 550/1349: loss=17.1108 (NCE=14.492, CLS=13.092)
  Batch 560/1349: loss=15.8508 (NCE=13.301, CLS=12.750)
  Batch 570/1349: loss=17.0548 (NCE=14.422, CLS=13.164)
  Batch 580/1349: loss=16.2867 (NCE=13.800, CLS=12.435)
  Batch 590/1349: loss=16.1029 (NCE=13.642, CLS=12.307)
  Batch 600/1349: loss=16.4724 (NCE=14.077, CLS=11.977)
  Batch 610/1349: loss=16.7514 (NCE=14.307, CLS=12.223)
  Batch 620/1349: loss=16.8518 (NCE=14.358, CLS=12.467)
  Batch 630/1349: loss=16.8745 (NCE=14.437, CLS=12.186)
  Batch 640/1349: loss=17.0323 (NCE=14.387, CLS=13.228)
  Batch 650/1349: loss=17.4011 (NCE=14.877, CLS=12.621)
  Batch 660/1349: loss=17.0371 (NCE=14.534, CLS=12.518)
  Batch 670/1349: loss=17.4302 (NCE=14.826, CLS=13.022)
  Batch 680/1349: loss=17.1206 (NCE=14.684, CLS=12.181)
  Batch 690/1349: loss=16.2313 (NCE=13.745, CLS=12.430)
  Batch 700/1349: loss=16.9535 (NCE=14.350, CLS=13.018)
  Batch 710/1349: loss=16.3822 (NCE=13.736, CLS=13.231)
  Batch 720/1349: loss=16.4103 (NCE=13.916, CLS=12.469)
  Batch 730/1349: loss=17.0337 (NCE=14.382, CLS=13.257)
  Batch 740/1349: loss=16.9810 (NCE=14.406, CLS=12.875)
  Batch 750/1349: loss=16.8700 (NCE=14.383, CLS=12.436)
  Batch 760/1349: loss=16.7495 (NCE=14.204, CLS=12.730)
  Batch 770/1349: loss=16.8798 (NCE=14.501, CLS=11.892)
  Batch 780/1349: loss=16.8278 (NCE=14.326, CLS=12.511)
  Batch 790/1349: loss=17.0094 (NCE=14.461, CLS=12.741)
  Batch 800/1349: loss=16.0269 (NCE=13.656, CLS=11.857)
  Batch 810/1349: loss=17.1929 (NCE=14.701, CLS=12.458)
  Batch 820/1349: loss=17.3356 (NCE=14.636, CLS=13.500)
  Batch 830/1349: loss=16.5001 (NCE=14.140, CLS=11.801)
  Batch 840/1349: loss=17.1390 (NCE=14.689, CLS=12.250)
  Batch 850/1349: loss=16.9016 (NCE=14.423, CLS=12.392)
  Batch 860/1349: loss=17.4150 (NCE=14.787, CLS=13.141)
  Batch 870/1349: loss=16.9606 (NCE=14.385, CLS=12.877)
  Batch 880/1349: loss=16.6359 (NCE=14.050, CLS=12.930)
  Batch 890/1349: loss=16.5630 (NCE=14.093, CLS=12.350)
  Batch 900/1349: loss=16.2237 (NCE=13.580, CLS=13.219)
  Batch 910/1349: loss=17.0777 (NCE=14.464, CLS=13.068)
  Batch 920/1349: loss=15.4071 (NCE=12.906, CLS=12.504)
  Batch 930/1349: loss=16.1724 (NCE=13.718, CLS=12.270)
  Batch 940/1349: loss=16.1854 (NCE=13.724, CLS=12.306)
  Batch 950/1349: loss=16.4685 (NCE=14.067, CLS=12.008)
  Batch 960/1349: loss=17.4354 (NCE=14.861, CLS=12.870)
  Batch 970/1349: loss=17.2867 (NCE=14.662, CLS=13.125)
  Batch 980/1349: loss=16.3895 (NCE=13.847, CLS=12.712)
  Batch 990/1349: loss=16.0983 (NCE=13.582, CLS=12.583)
  Batch 1000/1349: loss=17.3678 (NCE=14.847, CLS=12.606)
  Batch 1010/1349: loss=17.0538 (NCE=14.247, CLS=14.035)
  Batch 1020/1349: loss=16.4903 (NCE=14.092, CLS=11.990)
  Batch 1030/1349: loss=16.3441 (NCE=13.995, CLS=11.745)
  Batch 1040/1349: loss=16.3539 (NCE=13.905, CLS=12.247)
  Batch 1050/1349: loss=16.6786 (NCE=14.022, CLS=13.282)
  Batch 1060/1349: loss=16.9922 (NCE=14.441, CLS=12.758)
  Batch 1070/1349: loss=17.1592 (NCE=14.601, CLS=12.791)
  Batch 1080/1349: loss=17.0816 (NCE=14.558, CLS=12.619)
  Batch 1090/1349: loss=16.7859 (NCE=14.162, CLS=13.120)
  Batch 1100/1349: loss=16.1943 (NCE=13.563, CLS=13.158)
  Batch 1110/1349: loss=16.7665 (NCE=14.176, CLS=12.952)
  Batch 1120/1349: loss=16.3048 (NCE=13.892, CLS=12.066)
  Batch 1130/1349: loss=16.9134 (NCE=14.470, CLS=12.215)
  Batch 1140/1349: loss=16.9030 (NCE=14.402, CLS=12.507)
  Batch 1150/1349: loss=16.6670 (NCE=14.043, CLS=13.121)
  Batch 1160/1349: loss=16.5176 (NCE=14.007, CLS=12.553)
  Batch 1170/1349: loss=16.2951 (NCE=13.913, CLS=11.909)
  Batch 1180/1349: loss=16.3611 (NCE=13.926, CLS=12.178)
  Batch 1190/1349: loss=16.0905 (NCE=13.729, CLS=11.806)
  Batch 1200/1349: loss=16.0088 (NCE=13.624, CLS=11.922)
  Batch 1210/1349: loss=16.3252 (NCE=13.704, CLS=13.108)
  Batch 1220/1349: loss=15.5954 (NCE=13.003, CLS=12.960)
  Batch 1230/1349: loss=16.5742 (NCE=14.073, CLS=12.505)
  Batch 1240/1349: loss=16.3186 (NCE=13.930, CLS=11.942)
  Batch 1250/1349: loss=16.3686 (NCE=13.890, CLS=12.393)
  Batch 1260/1349: loss=16.5360 (NCE=13.970, CLS=12.829)
  Batch 1270/1349: loss=16.7524 (NCE=14.270, CLS=12.411)
  Batch 1280/1349: loss=15.6624 (NCE=13.243, CLS=12.095)
  Batch 1290/1349: loss=16.8366 (NCE=14.321, CLS=12.580)
  Batch 1300/1349: loss=16.5574 (NCE=13.812, CLS=13.728)
  Batch 1310/1349: loss=17.3863 (NCE=14.927, CLS=12.295)
  Batch 1320/1349: loss=16.4593 (NCE=14.021, CLS=12.189)
  Batch 1330/1349: loss=16.4514 (NCE=13.995, CLS=12.280)
  Batch 1340/1349: loss=16.7190 (NCE=14.262, CLS=12.285)
  Train: loss=16.8574 (NCE=14.302, CLS=12.778)
  Acc: HV=0.133, HJ=0.212, LV=0.121, LJ=0.069
  Val: loss=13.9658, R@10_HV=0.007
  New best model! (loss=13.9658)

Epoch 2/100
  Batch 10/1349: loss=17.2373 (NCE=14.731, CLS=12.530)
  Batch 20/1349: loss=16.8955 (NCE=14.387, CLS=12.545)
  Batch 30/1349: loss=16.4092 (NCE=13.988, CLS=12.105)
  Batch 40/1349: loss=16.8452 (NCE=14.355, CLS=12.451)
  Batch 50/1349: loss=16.5178 (NCE=14.059, CLS=12.293)
  Batch 60/1349: loss=17.3212 (NCE=14.634, CLS=13.436)
  Batch 70/1349: loss=16.4168 (NCE=13.883, CLS=12.670)
  Batch 80/1349: loss=17.1974 (NCE=14.747, CLS=12.252)
  Batch 90/1349: loss=17.0031 (NCE=14.323, CLS=13.403)
  Batch 100/1349: loss=16.4939 (NCE=14.102, CLS=11.962)
  Batch 110/1349: loss=16.9531 (NCE=14.503, CLS=12.249)
  Batch 120/1349: loss=16.7227 (NCE=14.004, CLS=13.595)
  Batch 130/1349: loss=16.8143 (NCE=14.211, CLS=13.015)
  Batch 140/1349: loss=16.8772 (NCE=14.382, CLS=12.475)
  Batch 150/1349: loss=16.5592 (NCE=14.051, CLS=12.541)
  Batch 160/1349: loss=16.5829 (NCE=13.963, CLS=13.101)
  Batch 170/1349: loss=16.4896 (NCE=14.003, CLS=12.434)
  Batch 180/1349: loss=16.5894 (NCE=13.847, CLS=13.711)
  Batch 190/1349: loss=16.3251 (NCE=13.669, CLS=13.281)
  Batch 200/1349: loss=16.7006 (NCE=14.269, CLS=12.157)
  Batch 210/1349: loss=16.3021 (NCE=13.827, CLS=12.375)
  Batch 220/1349: loss=16.5416 (NCE=14.089, CLS=12.263)
  Batch 230/1349: loss=16.7710 (NCE=14.079, CLS=13.461)
  Batch 240/1349: loss=15.7428 (NCE=13.520, CLS=11.115)
  Batch 250/1349: loss=16.2959 (NCE=13.862, CLS=12.171)
  Batch 260/1349: loss=17.5558 (NCE=14.938, CLS=13.088)
  Batch 270/1349: loss=16.7888 (NCE=14.299, CLS=12.447)
  Batch 280/1349: loss=16.8261 (NCE=14.376, CLS=12.253)
  Batch 290/1349: loss=17.3749 (NCE=14.841, CLS=12.670)
  Batch 300/1349: loss=16.6009 (NCE=14.150, CLS=12.253)
  Batch 310/1349: loss=16.8266 (NCE=14.391, CLS=12.177)
  Batch 320/1349: loss=15.8621 (NCE=13.443, CLS=12.095)
  Batch 330/1349: loss=16.3798 (NCE=13.765, CLS=13.075)
  Batch 340/1349: loss=16.1938 (NCE=13.442, CLS=13.757)
  Batch 350/1349: loss=16.9975 (NCE=14.379, CLS=13.092)
  Batch 360/1349: loss=16.3171 (NCE=13.783, CLS=12.668)
  Batch 370/1349: loss=17.2366 (NCE=14.583, CLS=13.270)
  Batch 380/1349: loss=16.6656 (NCE=14.003, CLS=13.311)
  Batch 390/1349: loss=16.6796 (NCE=14.260, CLS=12.100)
  Batch 400/1349: loss=17.3540 (NCE=14.601, CLS=13.765)
  Batch 410/1349: loss=15.9572 (NCE=13.504, CLS=12.267)
  Batch 420/1349: loss=16.6830 (NCE=14.316, CLS=11.837)
  Batch 430/1349: loss=16.5790 (NCE=14.120, CLS=12.297)
  Batch 440/1349: loss=16.4303 (NCE=13.990, CLS=12.204)
  Batch 450/1349: loss=16.0160 (NCE=13.637, CLS=11.895)
  Batch 460/1349: loss=16.9687 (NCE=14.351, CLS=13.087)
  Batch 470/1349: loss=16.5415 (NCE=14.010, CLS=12.657)
  Batch 480/1349: loss=16.6994 (NCE=14.097, CLS=13.014)
  Batch 490/1349: loss=16.8949 (NCE=14.425, CLS=12.351)
  Batch 500/1349: loss=17.2054 (NCE=14.548, CLS=13.286)
  Batch 510/1349: loss=16.1905 (NCE=13.837, CLS=11.768)
  Batch 520/1349: loss=16.4332 (NCE=14.066, CLS=11.833)
  Batch 530/1349: loss=17.3400 (NCE=14.713, CLS=13.135)
  Batch 540/1349: loss=17.2218 (NCE=14.717, CLS=12.523)
  Batch 550/1349: loss=15.9001 (NCE=13.478, CLS=12.112)
  Batch 560/1349: loss=16.9504 (NCE=14.495, CLS=12.278)
  Batch 570/1349: loss=16.3308 (NCE=13.731, CLS=12.998)
  Batch 580/1349: loss=16.3159 (NCE=13.898, CLS=12.091)
  Batch 590/1349: loss=15.4886 (NCE=13.145, CLS=11.718)
  Batch 600/1349: loss=16.4332 (NCE=13.930, CLS=12.515)
  Batch 610/1349: loss=16.4085 (NCE=13.956, CLS=12.262)
  Batch 620/1349: loss=16.6424 (NCE=14.062, CLS=12.900)
  Batch 630/1349: loss=16.9929 (NCE=14.485, CLS=12.542)
  Batch 640/1349: loss=17.3225 (NCE=14.834, CLS=12.443)
  Batch 650/1349: loss=17.1365 (NCE=14.517, CLS=13.095)
  Batch 660/1349: loss=16.9796 (NCE=14.507, CLS=12.364)
  Batch 670/1349: loss=16.6069 (NCE=13.941, CLS=13.331)
  Batch 680/1349: loss=16.0683 (NCE=13.629, CLS=12.195)
  Batch 690/1349: loss=17.4679 (NCE=14.822, CLS=13.228)
  Batch 700/1349: loss=16.3855 (NCE=13.852, CLS=12.670)
  Batch 710/1349: loss=16.8469 (NCE=14.092, CLS=13.774)
  Batch 720/1349: loss=15.8478 (NCE=13.476, CLS=11.860)
  Batch 730/1349: loss=16.9764 (NCE=14.401, CLS=12.877)
  Batch 740/1349: loss=16.7030 (NCE=14.285, CLS=12.091)
  Batch 750/1349: loss=16.0018 (NCE=13.587, CLS=12.073)
  Batch 760/1349: loss=16.7728 (NCE=14.140, CLS=13.164)
  Batch 770/1349: loss=17.0731 (NCE=14.659, CLS=12.071)
  Batch 780/1349: loss=17.0906 (NCE=14.483, CLS=13.039)
  Batch 790/1349: loss=16.8743 (NCE=14.220, CLS=13.271)
  Batch 800/1349: loss=17.0921 (NCE=14.600, CLS=12.460)
  Batch 810/1349: loss=16.5133 (NCE=14.016, CLS=12.488)
  Batch 820/1349: loss=17.1536 (NCE=14.615, CLS=12.693)
  Batch 830/1349: loss=16.3186 (NCE=13.921, CLS=11.988)
  Batch 840/1349: loss=16.4118 (NCE=13.836, CLS=12.879)
  Batch 850/1349: loss=16.7233 (NCE=14.181, CLS=12.709)
  Batch 860/1349: loss=16.3584 (NCE=13.877, CLS=12.408)
  Batch 870/1349: loss=16.7473 (NCE=14.075, CLS=13.360)
  Batch 880/1349: loss=17.4122 (NCE=14.908, CLS=12.520)
  Batch 890/1349: loss=16.0368 (NCE=13.654, CLS=11.915)
  Batch 900/1349: loss=15.7936 (NCE=13.348, CLS=12.227)
  Batch 910/1349: loss=16.8201 (NCE=14.418, CLS=12.009)
  Batch 920/1349: loss=16.7578 (NCE=14.293, CLS=12.324)
  Batch 930/1349: loss=16.9302 (NCE=14.540, CLS=11.950)
  Batch 940/1349: loss=16.6235 (NCE=14.163, CLS=12.304)
  Batch 950/1349: loss=16.3452 (NCE=13.973, CLS=11.862)
  Batch 960/1349: loss=16.8612 (NCE=14.406, CLS=12.277)
  Batch 970/1349: loss=16.4056 (NCE=13.939, CLS=12.331)
  Batch 980/1349: loss=16.8435 (NCE=14.388, CLS=12.276)
  Batch 990/1349: loss=16.0643 (NCE=13.617, CLS=12.238)
  Batch 1000/1349: loss=16.9051 (NCE=14.408, CLS=12.485)
  Batch 1010/1349: loss=16.6839 (NCE=14.141, CLS=12.713)
  Batch 1020/1349: loss=16.4040 (NCE=13.784, CLS=13.102)
  Batch 1030/1349: loss=16.6126 (NCE=14.329, CLS=11.419)
  Batch 1040/1349: loss=16.9603 (NCE=14.579, CLS=11.906)
  Batch 1050/1349: loss=16.1174 (NCE=13.733, CLS=11.921)
  Batch 1060/1349: loss=16.0840 (NCE=13.610, CLS=12.371)
  Batch 1070/1349: loss=16.3337 (NCE=14.013, CLS=11.606)
  Batch 1080/1349: loss=16.5525 (NCE=13.985, CLS=12.837)
  Batch 1090/1349: loss=15.6111 (NCE=13.286, CLS=11.625)
  Batch 1100/1349: loss=16.2774 (NCE=13.784, CLS=12.464)
  Batch 1110/1349: loss=16.8933 (NCE=14.495, CLS=11.989)
  Batch 1120/1349: loss=15.9481 (NCE=13.523, CLS=12.127)
  Batch 1130/1349: loss=16.2240 (NCE=13.604, CLS=13.099)
  Batch 1140/1349: loss=16.2494 (NCE=13.879, CLS=11.850)
  Batch 1150/1349: loss=16.0920 (NCE=13.509, CLS=12.914)
  Batch 1160/1349: loss=16.6191 (NCE=14.070, CLS=12.744)
  Batch 1170/1349: loss=16.2601 (NCE=13.861, CLS=11.996)
  Batch 1180/1349: loss=16.6260 (NCE=14.028, CLS=12.990)
  Batch 1190/1349: loss=16.6798 (NCE=14.067, CLS=13.065)
  Batch 1200/1349: loss=16.1962 (NCE=13.780, CLS=12.079)
  Batch 1210/1349: loss=16.8313 (NCE=14.288, CLS=12.715)
  Batch 1220/1349: loss=16.5550 (NCE=14.141, CLS=12.070)
  Batch 1230/1349: loss=17.1517 (NCE=14.601, CLS=12.752)
  Batch 1240/1349: loss=16.3376 (NCE=13.917, CLS=12.104)
  Batch 1250/1349: loss=16.1056 (NCE=13.675, CLS=12.155)
  Batch 1260/1349: loss=16.0626 (NCE=13.642, CLS=12.102)
  Batch 1270/1349: loss=16.1768 (NCE=13.813, CLS=11.821)
  Batch 1280/1349: loss=16.7740 (NCE=14.307, CLS=12.336)
  Batch 1290/1349: loss=17.4425 (NCE=14.952, CLS=12.455)
  Batch 1300/1349: loss=16.6127 (NCE=14.061, CLS=12.757)
  Batch 1310/1349: loss=16.2882 (NCE=13.733, CLS=12.774)
  Batch 1320/1349: loss=16.6211 (NCE=14.212, CLS=12.044)
  Batch 1330/1349: loss=16.8098 (NCE=14.287, CLS=12.615)
  Batch 1340/1349: loss=16.5071 (NCE=14.030, CLS=12.383)
  Train: loss=16.5797 (NCE=14.097, CLS=12.415)
  Acc: HV=0.154, HJ=0.221, LV=0.150, LJ=0.086
  Val: loss=13.8762, R@10_HV=0.008
  New best model! (loss=13.8762)

Epoch 3/100
  Batch 10/1349: loss=17.6332 (NCE=14.985, CLS=13.241)
  Batch 20/1349: loss=16.3935 (NCE=13.926, CLS=12.339)
  Batch 30/1349: loss=16.6091 (NCE=14.198, CLS=12.054)
  Batch 40/1349: loss=16.6376 (NCE=14.236, CLS=12.010)
  Batch 50/1349: loss=16.3217 (NCE=13.832, CLS=12.449)
  Batch 60/1349: loss=15.6666 (NCE=13.205, CLS=12.307)
  Batch 70/1349: loss=15.5413 (NCE=13.164, CLS=11.887)
  Batch 80/1349: loss=16.2477 (NCE=13.839, CLS=12.043)
  Batch 90/1349: loss=17.4264 (NCE=14.666, CLS=13.804)
  Batch 100/1349: loss=16.6513 (NCE=14.232, CLS=12.095)
  Batch 110/1349: loss=17.3138 (NCE=14.784, CLS=12.651)
  Batch 120/1349: loss=16.4198 (NCE=13.907, CLS=12.566)
  Batch 130/1349: loss=16.1475 (NCE=13.811, CLS=11.681)
  Batch 140/1349: loss=17.0843 (NCE=14.617, CLS=12.335)
  Batch 150/1349: loss=16.9668 (NCE=14.307, CLS=13.299)
  Batch 160/1349: loss=16.6472 (NCE=14.147, CLS=12.503)
  Batch 170/1349: loss=15.5980 (NCE=13.277, CLS=11.606)
  Batch 180/1349: loss=16.5663 (NCE=14.187, CLS=11.897)
  Batch 190/1349: loss=16.9693 (NCE=14.441, CLS=12.640)
  Batch 200/1349: loss=16.2862 (NCE=13.893, CLS=11.968)
  Batch 210/1349: loss=16.4663 (NCE=14.108, CLS=11.790)
  Batch 220/1349: loss=16.3344 (NCE=13.919, CLS=12.079)
  Batch 230/1349: loss=16.0710 (NCE=13.617, CLS=12.271)
  Batch 240/1349: loss=15.6811 (NCE=13.404, CLS=11.387)
  Batch 250/1349: loss=16.8553 (NCE=14.347, CLS=12.541)
  Batch 260/1349: loss=16.4723 (NCE=14.172, CLS=11.501)
  Batch 270/1349: loss=16.2839 (NCE=13.927, CLS=11.785)
  Batch 280/1349: loss=16.7113 (NCE=14.312, CLS=11.996)
  Batch 290/1349: loss=17.5513 (NCE=15.072, CLS=12.398)
  Batch 300/1349: loss=17.0167 (NCE=14.434, CLS=12.916)
  Batch 310/1349: loss=17.2266 (NCE=14.669, CLS=12.790)
  Batch 320/1349: loss=16.8358 (NCE=14.280, CLS=12.779)
  Batch 330/1349: loss=16.8192 (NCE=14.305, CLS=12.571)
  Batch 340/1349: loss=17.4148 (NCE=14.875, CLS=12.700)
  Batch 350/1349: loss=16.3585 (NCE=13.943, CLS=12.079)
  Batch 360/1349: loss=16.1707 (NCE=13.759, CLS=12.056)
  Batch 370/1349: loss=17.0066 (NCE=14.476, CLS=12.655)
  Batch 380/1349: loss=16.4664 (NCE=14.040, CLS=12.131)
  Batch 390/1349: loss=16.6824 (NCE=14.223, CLS=12.298)
  Batch 400/1349: loss=16.5977 (NCE=14.053, CLS=12.722)
  Batch 410/1349: loss=16.3931 (NCE=13.926, CLS=12.333)
  Batch 420/1349: loss=16.1120 (NCE=13.812, CLS=11.500)
  Batch 430/1349: loss=16.2744 (NCE=13.837, CLS=12.188)
  Batch 440/1349: loss=16.3685 (NCE=13.836, CLS=12.662)
  Batch 450/1349: loss=16.3849 (NCE=13.901, CLS=12.421)
  Batch 460/1349: loss=15.9087 (NCE=13.508, CLS=12.003)
  Batch 470/1349: loss=15.7156 (NCE=13.277, CLS=12.194)
  Batch 480/1349: loss=16.6655 (NCE=14.074, CLS=12.960)
  Batch 490/1349: loss=16.4123 (NCE=14.012, CLS=12.000)
  Batch 500/1349: loss=16.5067 (NCE=14.042, CLS=12.326)
  Batch 510/1349: loss=17.1512 (NCE=14.627, CLS=12.623)
  Batch 520/1349: loss=17.1965 (NCE=14.708, CLS=12.443)
  Batch 530/1349: loss=17.7069 (NCE=15.119, CLS=12.939)
  Batch 540/1349: loss=16.3545 (NCE=13.980, CLS=11.874)
  Batch 550/1349: loss=16.0727 (NCE=13.568, CLS=12.524)
  Batch 560/1349: loss=17.1113 (NCE=14.646, CLS=12.326)
  Batch 570/1349: loss=16.6906 (NCE=14.270, CLS=12.105)
  Batch 580/1349: loss=17.2880 (NCE=14.668, CLS=13.099)
  Batch 590/1349: loss=17.0023 (NCE=14.567, CLS=12.175)
  Batch 600/1349: loss=16.3249 (NCE=13.975, CLS=11.750)
  Batch 610/1349: loss=16.7635 (NCE=14.205, CLS=12.794)
  Batch 620/1349: loss=16.1848 (NCE=13.801, CLS=11.917)
  Batch 630/1349: loss=15.8220 (NCE=13.428, CLS=11.970)
  Batch 640/1349: loss=16.7925 (NCE=14.347, CLS=12.227)
  Batch 650/1349: loss=16.4941 (NCE=13.874, CLS=13.100)
  Batch 660/1349: loss=15.6072 (NCE=13.125, CLS=12.409)
  Batch 670/1349: loss=16.3646 (NCE=13.876, CLS=12.444)
  Batch 680/1349: loss=16.8335 (NCE=14.161, CLS=13.362)
  Batch 690/1349: loss=16.1282 (NCE=13.756, CLS=11.862)
  Batch 700/1349: loss=16.4459 (NCE=13.983, CLS=12.316)
  Batch 710/1349: loss=16.6211 (NCE=14.236, CLS=11.923)
  Batch 720/1349: loss=16.7397 (NCE=14.314, CLS=12.129)
  Batch 730/1349: loss=15.8715 (NCE=13.519, CLS=11.763)
  Batch 740/1349: loss=16.2091 (NCE=13.811, CLS=11.992)
  Batch 750/1349: loss=16.4460 (NCE=14.131, CLS=11.577)
  Batch 760/1349: loss=16.5855 (NCE=14.206, CLS=11.897)
  Batch 770/1349: loss=16.1741 (NCE=13.862, CLS=11.560)
  Batch 780/1349: loss=16.9483 (NCE=14.526, CLS=12.113)
  Batch 790/1349: loss=16.2113 (NCE=13.736, CLS=12.378)
  Batch 800/1349: loss=16.3449 (NCE=13.894, CLS=12.252)
  Batch 810/1349: loss=16.4429 (NCE=13.927, CLS=12.580)
  Batch 820/1349: loss=16.8133 (NCE=14.413, CLS=12.003)
  Batch 830/1349: loss=16.6333 (NCE=14.286, CLS=11.738)
  Batch 840/1349: loss=16.1612 (NCE=13.791, CLS=11.853)
  Batch 850/1349: loss=16.5233 (NCE=14.179, CLS=11.722)
  Batch 860/1349: loss=16.7315 (NCE=14.164, CLS=12.837)
  Batch 870/1349: loss=16.2625 (NCE=13.763, CLS=12.497)
  Batch 880/1349: loss=16.3621 (NCE=13.901, CLS=12.305)
  Batch 890/1349: loss=16.3727 (NCE=13.872, CLS=12.505)
  Batch 900/1349: loss=16.4282 (NCE=14.001, CLS=12.137)
  Batch 910/1349: loss=15.6040 (NCE=13.193, CLS=12.057)
  Batch 920/1349: loss=16.3322 (NCE=13.926, CLS=12.031)
  Batch 930/1349: loss=17.0145 (NCE=14.551, CLS=12.317)
  Batch 940/1349: loss=16.7441 (NCE=14.354, CLS=11.950)
  Batch 950/1349: loss=16.2817 (NCE=13.887, CLS=11.975)
  Batch 960/1349: loss=16.8473 (NCE=14.275, CLS=12.860)
  Batch 970/1349: loss=15.3671 (NCE=13.007, CLS=11.799)
  Batch 980/1349: loss=17.1309 (NCE=14.649, CLS=12.410)
  Batch 990/1349: loss=17.0048 (NCE=14.507, CLS=12.488)
  Batch 1000/1349: loss=17.1171 (NCE=14.672, CLS=12.228)
  Batch 1010/1349: loss=16.6040 (NCE=14.141, CLS=12.314)
  Batch 1020/1349: loss=16.3587 (NCE=13.916, CLS=12.214)
  Batch 1030/1349: loss=16.1295 (NCE=13.753, CLS=11.884)
  Batch 1040/1349: loss=16.9473 (NCE=14.419, CLS=12.644)
  Batch 1050/1349: loss=16.2208 (NCE=13.807, CLS=12.069)
  Batch 1060/1349: loss=16.5378 (NCE=14.107, CLS=12.153)
  Batch 1070/1349: loss=16.2492 (NCE=13.808, CLS=12.204)
  Batch 1080/1349: loss=17.1385 (NCE=14.620, CLS=12.594)
  Batch 1090/1349: loss=16.2052 (NCE=13.906, CLS=11.497)
  Batch 1100/1349: loss=15.4217 (NCE=12.986, CLS=12.180)
  Batch 1110/1349: loss=15.9767 (NCE=13.637, CLS=11.699)
  Batch 1120/1349: loss=16.4917 (NCE=14.015, CLS=12.385)
  Batch 1130/1349: loss=17.0257 (NCE=14.622, CLS=12.018)
  Batch 1140/1349: loss=17.0174 (NCE=14.594, CLS=12.119)
  Batch 1150/1349: loss=16.1475 (NCE=13.574, CLS=12.868)
  Batch 1160/1349: loss=15.9675 (NCE=13.676, CLS=11.455)
  Batch 1170/1349: loss=15.9330 (NCE=13.562, CLS=11.857)
  Batch 1180/1349: loss=16.5284 (NCE=13.905, CLS=13.119)
  Batch 1190/1349: loss=16.2390 (NCE=13.825, CLS=12.072)
  Batch 1200/1349: loss=16.3820 (NCE=13.859, CLS=12.615)
  Batch 1210/1349: loss=16.1850 (NCE=13.687, CLS=12.492)
  Batch 1220/1349: loss=16.6441 (NCE=14.132, CLS=12.562)
  Batch 1230/1349: loss=16.3229 (NCE=13.936, CLS=11.936)
  Batch 1240/1349: loss=16.1477 (NCE=13.514, CLS=13.167)
  Batch 1250/1349: loss=16.9090 (NCE=14.476, CLS=12.165)
  Batch 1260/1349: loss=15.9391 (NCE=13.512, CLS=12.138)
  Batch 1270/1349: loss=16.2547 (NCE=13.951, CLS=11.520)
  Batch 1280/1349: loss=17.2319 (NCE=14.717, CLS=12.575)
  Batch 1290/1349: loss=16.5324 (NCE=14.182, CLS=11.754)
  Batch 1300/1349: loss=16.2395 (NCE=13.911, CLS=11.642)
  Batch 1310/1349: loss=16.2270 (NCE=13.894, CLS=11.666)
  Batch 1320/1349: loss=16.7303 (NCE=14.371, CLS=11.797)
  Batch 1330/1349: loss=16.8529 (NCE=14.359, CLS=12.472)
  Batch 1340/1349: loss=17.2249 (NCE=14.698, CLS=12.635)
  Train: loss=16.4926 (NCE=14.028, CLS=12.322)
  Acc: HV=0.161, HJ=0.225, LV=0.159, LJ=0.089
  Val: loss=13.8323, R@10_HV=0.009
  New best model! (loss=13.8323)

Epoch 4/100
  Batch 10/1349: loss=16.6093 (NCE=14.176, CLS=12.165)
  Batch 20/1349: loss=15.9724 (NCE=13.641, CLS=11.657)
  Batch 30/1349: loss=16.1963 (NCE=13.942, CLS=11.274)
  Batch 40/1349: loss=15.7095 (NCE=13.362, CLS=11.738)
  Batch 50/1349: loss=16.0326 (NCE=13.637, CLS=11.979)
  Batch 60/1349: loss=16.4454 (NCE=13.947, CLS=12.491)
  Batch 70/1349: loss=15.8613 (NCE=13.460, CLS=12.008)
  Batch 80/1349: loss=16.7749 (NCE=14.191, CLS=12.918)
  Batch 90/1349: loss=16.7054 (NCE=14.153, CLS=12.760)
  Batch 100/1349: loss=16.3953 (NCE=13.957, CLS=12.191)
  Batch 110/1349: loss=17.0048 (NCE=14.455, CLS=12.751)
  Batch 120/1349: loss=16.7976 (NCE=14.252, CLS=12.726)
  Batch 130/1349: loss=16.7194 (NCE=14.247, CLS=12.364)
  Batch 140/1349: loss=16.5118 (NCE=14.014, CLS=12.488)
  Batch 150/1349: loss=17.0208 (NCE=14.519, CLS=12.508)
  Batch 160/1349: loss=16.8123 (NCE=14.343, CLS=12.347)
  Batch 170/1349: loss=16.6306 (NCE=14.271, CLS=11.797)
  Batch 180/1349: loss=16.1544 (NCE=13.718, CLS=12.183)
  Batch 190/1349: loss=16.4557 (NCE=14.059, CLS=11.982)
  Batch 200/1349: loss=16.2590 (NCE=13.870, CLS=11.947)
  Batch 210/1349: loss=16.1162 (NCE=13.848, CLS=11.340)
  Batch 220/1349: loss=16.6548 (NCE=14.169, CLS=12.427)
  Batch 230/1349: loss=15.6666 (NCE=13.218, CLS=12.243)
  Batch 240/1349: loss=16.2103 (NCE=13.762, CLS=12.240)
  Batch 250/1349: loss=16.5430 (NCE=13.980, CLS=12.817)
  Batch 260/1349: loss=16.4741 (NCE=14.134, CLS=11.700)
  Batch 270/1349: loss=15.7900 (NCE=13.502, CLS=11.440)
  Batch 280/1349: loss=16.6496 (NCE=14.191, CLS=12.291)
  Batch 290/1349: loss=16.2999 (NCE=13.952, CLS=11.740)
  Batch 300/1349: loss=16.6939 (NCE=14.350, CLS=11.722)
  Batch 310/1349: loss=16.8151 (NCE=14.360, CLS=12.277)
  Batch 320/1349: loss=16.5757 (NCE=14.142, CLS=12.170)
  Batch 330/1349: loss=16.7603 (NCE=14.211, CLS=12.744)
  Batch 340/1349: loss=16.5124 (NCE=14.010, CLS=12.515)
  Batch 350/1349: loss=15.4499 (NCE=13.081, CLS=11.845)
  Batch 360/1349: loss=16.4842 (NCE=14.026, CLS=12.292)
  Batch 370/1349: loss=16.7628 (NCE=14.324, CLS=12.194)
  Batch 380/1349: loss=16.0581 (NCE=13.654, CLS=12.018)
  Batch 390/1349: loss=17.2271 (NCE=14.699, CLS=12.638)
  Batch 400/1349: loss=16.8857 (NCE=14.433, CLS=12.262)
  Batch 410/1349: loss=16.3806 (NCE=13.899, CLS=12.410)
  Batch 420/1349: loss=17.2992 (NCE=14.763, CLS=12.683)
  Batch 430/1349: loss=15.7273 (NCE=12.979, CLS=13.740)
  Batch 440/1349: loss=16.1952 (NCE=13.715, CLS=12.400)
  Batch 450/1349: loss=16.3938 (NCE=13.918, CLS=12.380)
  Batch 460/1349: loss=15.9420 (NCE=13.553, CLS=11.945)
  Batch 470/1349: loss=16.2221 (NCE=13.810, CLS=12.063)
  Batch 480/1349: loss=16.0680 (NCE=13.789, CLS=11.396)
  Batch 490/1349: loss=15.9416 (NCE=13.612, CLS=11.647)
  Batch 500/1349: loss=16.0311 (NCE=13.731, CLS=11.502)
  Batch 510/1349: loss=16.6776 (NCE=14.064, CLS=13.070)
  Batch 520/1349: loss=15.5953 (NCE=13.310, CLS=11.425)
  Batch 530/1349: loss=16.7305 (NCE=14.240, CLS=12.451)
  Batch 540/1349: loss=16.6868 (NCE=13.956, CLS=13.656)
  Batch 550/1349: loss=16.5091 (NCE=14.108, CLS=12.005)
  Batch 560/1349: loss=15.7856 (NCE=13.479, CLS=11.533)
  Batch 570/1349: loss=16.5348 (NCE=13.981, CLS=12.769)
  Batch 580/1349: loss=16.3802 (NCE=13.913, CLS=12.338)
  Batch 590/1349: loss=16.4723 (NCE=13.958, CLS=12.569)
  Batch 600/1349: loss=15.9796 (NCE=13.483, CLS=12.484)
  Batch 610/1349: loss=15.7831 (NCE=13.450, CLS=11.664)
  Batch 620/1349: loss=17.1278 (NCE=14.643, CLS=12.424)
  Batch 630/1349: loss=15.6878 (NCE=13.186, CLS=12.509)
  Batch 640/1349: loss=16.6603 (NCE=14.109, CLS=12.754)
  Batch 650/1349: loss=16.7474 (NCE=14.333, CLS=12.073)
  Batch 660/1349: loss=16.5843 (NCE=14.140, CLS=12.220)
  Batch 670/1349: loss=16.3213 (NCE=13.881, CLS=12.203)
  Batch 680/1349: loss=16.3903 (NCE=13.907, CLS=12.418)
  Batch 690/1349: loss=15.9582 (NCE=13.550, CLS=12.041)
  Batch 700/1349: loss=15.8704 (NCE=13.284, CLS=12.930)
  Batch 710/1349: loss=16.4060 (NCE=14.073, CLS=11.667)
  Batch 720/1349: loss=16.9062 (NCE=14.523, CLS=11.915)
  Batch 730/1349: loss=16.3784 (NCE=13.831, CLS=12.736)
  Batch 740/1349: loss=16.7262 (NCE=14.266, CLS=12.299)
  Batch 750/1349: loss=16.5934 (NCE=13.997, CLS=12.981)
  Batch 760/1349: loss=16.8531 (NCE=14.279, CLS=12.868)
  Batch 770/1349: loss=16.6536 (NCE=14.175, CLS=12.394)
  Batch 780/1349: loss=16.5011 (NCE=14.022, CLS=12.396)
  Batch 790/1349: loss=16.7195 (NCE=14.148, CLS=12.859)
  Batch 800/1349: loss=16.3299 (NCE=13.799, CLS=12.653)
  Batch 810/1349: loss=15.8952 (NCE=13.527, CLS=11.843)
  Batch 820/1349: loss=16.5802 (NCE=14.021, CLS=12.794)
  Batch 830/1349: loss=16.5365 (NCE=14.124, CLS=12.062)
  Batch 840/1349: loss=16.4255 (NCE=13.930, CLS=12.478)
  Batch 850/1349: loss=16.4528 (NCE=13.959, CLS=12.469)
  Batch 860/1349: loss=16.3600 (NCE=13.893, CLS=12.336)
  Batch 870/1349: loss=17.3810 (NCE=14.795, CLS=12.930)
  Batch 880/1349: loss=16.8366 (NCE=14.245, CLS=12.958)
  Batch 890/1349: loss=16.3254 (NCE=14.008, CLS=11.588)
  Batch 900/1349: loss=16.6003 (NCE=14.153, CLS=12.238)
  Batch 910/1349: loss=16.6364 (NCE=14.160, CLS=12.383)
  Batch 920/1349: loss=16.3775 (NCE=13.999, CLS=11.894)
  Batch 930/1349: loss=16.9244 (NCE=14.473, CLS=12.259)
  Batch 940/1349: loss=17.2715 (NCE=14.753, CLS=12.591)
  Batch 950/1349: loss=16.4262 (NCE=13.900, CLS=12.633)
  Batch 960/1349: loss=17.0437 (NCE=14.561, CLS=12.413)
  Batch 970/1349: loss=16.8322 (NCE=14.367, CLS=12.323)
  Batch 980/1349: loss=16.4479 (NCE=13.980, CLS=12.339)
  Batch 990/1349: loss=15.6621 (NCE=13.230, CLS=12.159)
  Batch 1000/1349: loss=15.8023 (NCE=13.393, CLS=12.045)
  Batch 1010/1349: loss=16.0793 (NCE=13.718, CLS=11.808)
  Batch 1020/1349: loss=16.7987 (NCE=14.347, CLS=12.260)
  Batch 1030/1349: loss=16.2495 (NCE=13.809, CLS=12.203)
  Batch 1040/1349: loss=16.7929 (NCE=14.288, CLS=12.527)
  Batch 1050/1349: loss=16.4615 (NCE=14.085, CLS=11.881)
  Batch 1060/1349: loss=17.0177 (NCE=14.536, CLS=12.410)
  Batch 1070/1349: loss=16.9851 (NCE=14.480, CLS=12.526)
  Batch 1080/1349: loss=15.9582 (NCE=13.394, CLS=12.819)
  Batch 1090/1349: loss=17.3201 (NCE=14.795, CLS=12.625)
  Batch 1100/1349: loss=15.7543 (NCE=13.458, CLS=11.483)
  Batch 1110/1349: loss=16.7142 (NCE=14.288, CLS=12.129)
  Batch 1120/1349: loss=16.1892 (NCE=13.680, CLS=12.544)
  Batch 1130/1349: loss=16.0138 (NCE=13.688, CLS=11.628)
  Batch 1140/1349: loss=16.8107 (NCE=14.297, CLS=12.571)
  Batch 1150/1349: loss=16.3353 (NCE=13.793, CLS=12.711)
  Batch 1160/1349: loss=16.6928 (NCE=14.361, CLS=11.661)
  Batch 1170/1349: loss=15.7838 (NCE=13.341, CLS=12.216)
  Batch 1180/1349: loss=16.0200 (NCE=13.485, CLS=12.673)
  Batch 1190/1349: loss=15.9282 (NCE=13.573, CLS=11.778)
  Batch 1200/1349: loss=16.8292 (NCE=14.284, CLS=12.725)
  Batch 1210/1349: loss=16.7983 (NCE=14.341, CLS=12.289)
  Batch 1220/1349: loss=16.2761 (NCE=13.759, CLS=12.587)
  Batch 1230/1349: loss=15.8302 (NCE=13.499, CLS=11.655)
  Batch 1240/1349: loss=16.3396 (NCE=13.950, CLS=11.948)
  Batch 1250/1349: loss=16.3287 (NCE=13.964, CLS=11.821)
  Batch 1260/1349: loss=16.8680 (NCE=14.216, CLS=13.263)
  Batch 1270/1349: loss=17.0982 (NCE=14.618, CLS=12.402)
  Batch 1280/1349: loss=17.0953 (NCE=14.584, CLS=12.556)
  Batch 1290/1349: loss=16.6434 (NCE=14.211, CLS=12.160)
  Batch 1300/1349: loss=16.1597 (NCE=13.725, CLS=12.174)
  Batch 1310/1349: loss=16.2271 (NCE=13.835, CLS=11.959)
  Batch 1320/1349: loss=16.3190 (NCE=13.883, CLS=12.179)
  Batch 1330/1349: loss=15.9945 (NCE=13.494, CLS=12.501)
  Batch 1340/1349: loss=16.6988 (NCE=14.240, CLS=12.295)
  Train: loss=16.4305 (NCE=13.980, CLS=12.251)
  Acc: HV=0.165, HJ=0.228, LV=0.164, LJ=0.092
  Val: loss=13.8111, R@10_HV=0.009
  New best model! (loss=13.8111)

Epoch 5/100
  Batch 10/1349: loss=16.5880 (NCE=14.161, CLS=12.133)
  Batch 20/1349: loss=16.2601 (NCE=13.956, CLS=11.519)
  Batch 30/1349: loss=16.4474 (NCE=14.114, CLS=11.665)
  Batch 40/1349: loss=17.5521 (NCE=15.002, CLS=12.751)
  Batch 50/1349: loss=16.8496 (NCE=14.417, CLS=12.162)
  Batch 60/1349: loss=16.3334 (NCE=13.915, CLS=12.093)
  Batch 70/1349: loss=16.1728 (NCE=13.726, CLS=12.236)
  Batch 80/1349: loss=16.7597 (NCE=14.348, CLS=12.060)
  Batch 90/1349: loss=16.9319 (NCE=14.365, CLS=12.835)
  Batch 100/1349: loss=16.4221 (NCE=13.954, CLS=12.341)
  Batch 110/1349: loss=15.6750 (NCE=13.220, CLS=12.276)
  Batch 120/1349: loss=16.1867 (NCE=13.574, CLS=13.062)
  Batch 130/1349: loss=17.0096 (NCE=14.508, CLS=12.506)
  Batch 140/1349: loss=16.0163 (NCE=13.735, CLS=11.408)
  Batch 150/1349: loss=16.0382 (NCE=13.712, CLS=11.629)
  Batch 160/1349: loss=16.7294 (NCE=14.363, CLS=11.832)
  Batch 170/1349: loss=16.5413 (NCE=14.089, CLS=12.261)
  Batch 180/1349: loss=16.3439 (NCE=13.728, CLS=13.080)
  Batch 190/1349: loss=16.1195 (NCE=13.711, CLS=12.042)
  Batch 200/1349: loss=16.2663 (NCE=13.900, CLS=11.831)
  Batch 210/1349: loss=16.1161 (NCE=13.675, CLS=12.207)
  Batch 220/1349: loss=16.5699 (NCE=14.013, CLS=12.786)
  Batch 230/1349: loss=16.5189 (NCE=13.974, CLS=12.724)
  Batch 240/1349: loss=16.3505 (NCE=13.907, CLS=12.216)
  Batch 250/1349: loss=16.4185 (NCE=14.088, CLS=11.651)
  Batch 260/1349: loss=15.8406 (NCE=13.532, CLS=11.545)
  Batch 270/1349: loss=16.2866 (NCE=13.895, CLS=11.957)
  Batch 280/1349: loss=16.6836 (NCE=14.251, CLS=12.164)
  Batch 290/1349: loss=16.7167 (NCE=14.111, CLS=13.028)
  Batch 300/1349: loss=15.7608 (NCE=13.488, CLS=11.362)
  Batch 310/1349: loss=15.4602 (NCE=13.156, CLS=11.520)
  Batch 320/1349: loss=15.4313 (NCE=13.112, CLS=11.596)
  Batch 330/1349: loss=16.4674 (NCE=14.070, CLS=11.984)
  Batch 340/1349: loss=16.7108 (NCE=14.329, CLS=11.907)
  Batch 350/1349: loss=16.0796 (NCE=13.645, CLS=12.173)
  Batch 360/1349: loss=16.5647 (NCE=13.996, CLS=12.843)
  Batch 370/1349: loss=16.4229 (NCE=13.989, CLS=12.171)
  Batch 380/1349: loss=16.2142 (NCE=13.862, CLS=11.762)
  Batch 390/1349: loss=16.8565 (NCE=14.214, CLS=13.210)
  Batch 400/1349: loss=16.5452 (NCE=14.006, CLS=12.697)
  Batch 410/1349: loss=16.5668 (NCE=14.132, CLS=12.172)
  Batch 420/1349: loss=16.3541 (NCE=13.715, CLS=13.195)
  Batch 430/1349: loss=16.6114 (NCE=14.225, CLS=11.933)
  Batch 440/1349: loss=15.6658 (NCE=13.336, CLS=11.647)
  Batch 450/1349: loss=15.8697 (NCE=13.554, CLS=11.577)
  Batch 460/1349: loss=16.8501 (NCE=14.477, CLS=11.865)
  Batch 470/1349: loss=17.1604 (NCE=14.662, CLS=12.490)
  Batch 480/1349: loss=16.3596 (NCE=14.019, CLS=11.703)
  Batch 490/1349: loss=16.5425 (NCE=14.245, CLS=11.485)
  Batch 500/1349: loss=16.4335 (NCE=13.977, CLS=12.283)
  Batch 510/1349: loss=15.4927 (NCE=13.080, CLS=12.063)
  Batch 520/1349: loss=17.1925 (NCE=14.801, CLS=11.957)
  Batch 530/1349: loss=15.7271 (NCE=13.226, CLS=12.506)
  Batch 540/1349: loss=16.1049 (NCE=13.688, CLS=12.084)
  Batch 550/1349: loss=16.3871 (NCE=13.794, CLS=12.967)
  Batch 560/1349: loss=16.6594 (NCE=14.190, CLS=12.345)
  Batch 570/1349: loss=16.5299 (NCE=14.054, CLS=12.381)
  Batch 580/1349: loss=16.1084 (NCE=13.724, CLS=11.922)
  Batch 590/1349: loss=16.1336 (NCE=13.609, CLS=12.622)
  Batch 600/1349: loss=16.4701 (NCE=14.081, CLS=11.946)
  Batch 610/1349: loss=16.1906 (NCE=13.775, CLS=12.077)
  Batch 620/1349: loss=16.4697 (NCE=14.115, CLS=11.773)
  Batch 630/1349: loss=17.1369 (NCE=14.506, CLS=13.156)
  Batch 640/1349: loss=16.8202 (NCE=14.392, CLS=12.139)
  Batch 650/1349: loss=16.5645 (NCE=13.963, CLS=13.006)
  Batch 660/1349: loss=15.4874 (NCE=13.080, CLS=12.035)
  Batch 670/1349: loss=16.0093 (NCE=13.575, CLS=12.173)
  Batch 680/1349: loss=15.3594 (NCE=13.042, CLS=11.586)
  Batch 690/1349: loss=16.8100 (NCE=14.270, CLS=12.701)
  Batch 700/1349: loss=15.7456 (NCE=13.410, CLS=11.677)
  Batch 710/1349: loss=16.5163 (NCE=13.933, CLS=12.916)
  Batch 720/1349: loss=16.8535 (NCE=14.408, CLS=12.227)
  Batch 730/1349: loss=16.2568 (NCE=13.774, CLS=12.413)
  Batch 740/1349: loss=16.4105 (NCE=14.129, CLS=11.409)
  Batch 750/1349: loss=16.8786 (NCE=14.320, CLS=12.793)
  Batch 760/1349: loss=16.9141 (NCE=14.464, CLS=12.249)
  Batch 770/1349: loss=16.9348 (NCE=14.290, CLS=13.226)
  Batch 780/1349: loss=16.3676 (NCE=13.893, CLS=12.374)
  Batch 790/1349: loss=16.5121 (NCE=14.106, CLS=12.030)
  Batch 800/1349: loss=15.8294 (NCE=13.445, CLS=11.922)
  Batch 810/1349: loss=17.1424 (NCE=14.591, CLS=12.757)
  Batch 820/1349: loss=16.9658 (NCE=14.574, CLS=11.959)
  Batch 830/1349: loss=16.7368 (NCE=14.293, CLS=12.218)
  Batch 840/1349: loss=16.7453 (NCE=14.335, CLS=12.052)
  Batch 850/1349: loss=16.8114 (NCE=14.318, CLS=12.466)
  Batch 860/1349: loss=16.6169 (NCE=14.044, CLS=12.867)
  Batch 870/1349: loss=16.6806 (NCE=14.331, CLS=11.748)
  Batch 880/1349: loss=17.1988 (NCE=14.663, CLS=12.681)
  Batch 890/1349: loss=16.4147 (NCE=14.005, CLS=12.047)
  Batch 900/1349: loss=15.6994 (NCE=13.472, CLS=11.136)
  Batch 910/1349: loss=16.9120 (NCE=14.336, CLS=12.882)
  Batch 920/1349: loss=16.4864 (NCE=14.052, CLS=12.173)
  Batch 930/1349: loss=17.0079 (NCE=14.588, CLS=12.100)
  Batch 940/1349: loss=15.9557 (NCE=13.410, CLS=12.731)
  Batch 950/1349: loss=16.9803 (NCE=14.565, CLS=12.078)
  Batch 960/1349: loss=16.3780 (NCE=13.914, CLS=12.321)
  Batch 970/1349: loss=16.1060 (NCE=13.706, CLS=12.000)
  Batch 980/1349: loss=16.1509 (NCE=13.703, CLS=12.240)
  Batch 990/1349: loss=16.8753 (NCE=14.473, CLS=12.009)
  Batch 1000/1349: loss=16.4701 (NCE=14.029, CLS=12.207)
  Batch 1010/1349: loss=17.0845 (NCE=14.585, CLS=12.500)
  Batch 1020/1349: loss=16.4181 (NCE=13.862, CLS=12.780)
  Batch 1030/1349: loss=15.5839 (NCE=13.169, CLS=12.076)
  Batch 1040/1349: loss=16.8131 (NCE=14.281, CLS=12.663)
  Batch 1050/1349: loss=16.9911 (NCE=14.553, CLS=12.190)
  Batch 1060/1349: loss=16.4685 (NCE=14.155, CLS=11.565)
  Batch 1070/1349: loss=16.1748 (NCE=13.805, CLS=11.848)
  Batch 1080/1349: loss=16.6359 (NCE=14.246, CLS=11.951)
  Batch 1090/1349: loss=16.5535 (NCE=14.028, CLS=12.625)
  Batch 1100/1349: loss=16.0360 (NCE=13.656, CLS=11.902)
  Batch 1110/1349: loss=17.1525 (NCE=14.661, CLS=12.455)
  Batch 1120/1349: loss=17.1396 (NCE=14.654, CLS=12.429)
  Batch 1130/1349: loss=16.4060 (NCE=13.853, CLS=12.766)
  Batch 1140/1349: loss=16.4898 (NCE=14.049, CLS=12.202)
  Batch 1150/1349: loss=16.4904 (NCE=14.090, CLS=12.003)
  Batch 1160/1349: loss=16.6482 (NCE=14.227, CLS=12.108)
  Batch 1170/1349: loss=16.4143 (NCE=13.926, CLS=12.439)
  Batch 1180/1349: loss=16.4010 (NCE=13.787, CLS=13.070)
  Batch 1190/1349: loss=16.6002 (NCE=14.177, CLS=12.117)
  Batch 1200/1349: loss=15.7658 (NCE=13.424, CLS=11.709)
  Batch 1210/1349: loss=16.5834 (NCE=14.079, CLS=12.522)
  Batch 1220/1349: loss=16.4408 (NCE=13.936, CLS=12.524)
  Batch 1230/1349: loss=16.7290 (NCE=14.395, CLS=11.668)
  Batch 1240/1349: loss=16.5877 (NCE=14.177, CLS=12.054)
  Batch 1250/1349: loss=16.3635 (NCE=13.946, CLS=12.086)
  Batch 1260/1349: loss=16.4717 (NCE=14.004, CLS=12.341)
  Batch 1270/1349: loss=16.2660 (NCE=13.925, CLS=11.704)
  Batch 1280/1349: loss=16.1195 (NCE=13.659, CLS=12.301)
  Batch 1290/1349: loss=16.8111 (NCE=14.296, CLS=12.577)
  Batch 1300/1349: loss=16.7674 (NCE=14.106, CLS=13.309)
  Batch 1310/1349: loss=16.6860 (NCE=14.255, CLS=12.157)
  Batch 1320/1349: loss=16.3735 (NCE=13.921, CLS=12.261)
  Batch 1330/1349: loss=16.3617 (NCE=14.037, CLS=11.626)
  Batch 1340/1349: loss=16.5022 (NCE=13.929, CLS=12.866)
  Train: loss=16.3803 (NCE=13.940, CLS=12.201)
  Acc: HV=0.167, HJ=0.228, LV=0.169, LJ=0.093
  Val: loss=13.7861, R@10_HV=0.010
  New best model! (loss=13.7861)

Epoch 6/100
  Batch 10/1349: loss=16.1817 (NCE=13.761, CLS=12.104)
  Batch 20/1349: loss=16.2083 (NCE=13.697, CLS=12.558)
  Batch 30/1349: loss=15.4408 (NCE=13.186, CLS=11.276)
  Batch 40/1349: loss=16.4963 (NCE=13.974, CLS=12.609)
  Batch 50/1349: loss=15.4358 (NCE=13.084, CLS=11.760)
  Batch 60/1349: loss=16.8657 (NCE=14.414, CLS=12.257)
  Batch 70/1349: loss=16.4038 (NCE=13.877, CLS=12.635)
  Batch 80/1349: loss=17.2843 (NCE=14.672, CLS=13.060)
  Batch 90/1349: loss=16.5226 (NCE=14.054, CLS=12.344)
  Batch 100/1349: loss=16.4955 (NCE=13.937, CLS=12.793)
  Batch 110/1349: loss=16.4105 (NCE=13.841, CLS=12.847)
  Batch 120/1349: loss=16.5536 (NCE=14.074, CLS=12.396)
  Batch 130/1349: loss=16.4545 (NCE=14.102, CLS=11.762)
  Batch 140/1349: loss=15.8374 (NCE=13.643, CLS=10.974)
  Batch 150/1349: loss=16.3958 (NCE=13.951, CLS=12.224)
  Batch 160/1349: loss=17.0714 (NCE=14.618, CLS=12.268)
  Batch 170/1349: loss=16.9188 (NCE=14.409, CLS=12.551)
  Batch 180/1349: loss=16.0447 (NCE=13.657, CLS=11.941)
  Batch 190/1349: loss=16.6050 (NCE=14.025, CLS=12.902)
  Batch 200/1349: loss=16.0437 (NCE=13.644, CLS=11.997)
  Batch 210/1349: loss=16.8985 (NCE=14.307, CLS=12.958)
  Batch 220/1349: loss=16.5851 (NCE=14.178, CLS=12.037)
  Batch 230/1349: loss=17.2792 (NCE=14.735, CLS=12.720)
  Batch 240/1349: loss=16.5083 (NCE=14.174, CLS=11.673)
  Batch 250/1349: loss=15.9466 (NCE=13.490, CLS=12.283)
  Batch 260/1349: loss=16.4836 (NCE=14.071, CLS=12.061)
  Batch 270/1349: loss=16.3834 (NCE=13.897, CLS=12.432)
  Batch 280/1349: loss=16.7766 (NCE=14.330, CLS=12.234)
  Batch 290/1349: loss=16.2574 (NCE=13.789, CLS=12.340)
  Batch 300/1349: loss=16.0018 (NCE=13.668, CLS=11.668)
  Batch 310/1349: loss=16.4229 (NCE=14.063, CLS=11.801)
  Batch 320/1349: loss=15.3991 (NCE=13.055, CLS=11.723)
  Batch 330/1349: loss=16.2210 (NCE=13.763, CLS=12.289)
  Batch 340/1349: loss=16.0123 (NCE=13.706, CLS=11.530)
  Batch 350/1349: loss=17.1785 (NCE=14.706, CLS=12.363)
  Batch 360/1349: loss=16.3171 (NCE=13.913, CLS=12.018)
  Batch 370/1349: loss=16.0543 (NCE=13.707, CLS=11.734)
  Batch 380/1349: loss=16.0536 (NCE=13.685, CLS=11.843)
  Batch 390/1349: loss=16.0310 (NCE=13.718, CLS=11.566)
  Batch 400/1349: loss=16.1178 (NCE=13.722, CLS=11.978)
  Batch 410/1349: loss=16.5869 (NCE=13.992, CLS=12.974)
  Batch 420/1349: loss=16.2203 (NCE=13.765, CLS=12.275)
  Batch 430/1349: loss=16.3053 (NCE=13.901, CLS=12.023)
  Batch 440/1349: loss=16.1423 (NCE=13.803, CLS=11.696)
  Batch 450/1349: loss=16.3759 (NCE=13.844, CLS=12.659)
  Batch 460/1349: loss=16.5561 (NCE=14.095, CLS=12.304)
  Batch 470/1349: loss=16.2372 (NCE=13.838, CLS=11.995)
  Batch 480/1349: loss=16.5770 (NCE=14.192, CLS=11.925)
  Batch 490/1349: loss=16.4958 (NCE=14.073, CLS=12.114)
  Batch 500/1349: loss=17.3137 (NCE=14.639, CLS=13.373)
  Batch 510/1349: loss=17.0600 (NCE=14.503, CLS=12.783)
  Batch 520/1349: loss=16.2778 (NCE=13.980, CLS=11.488)
  Batch 530/1349: loss=16.0289 (NCE=13.683, CLS=11.729)
  Batch 540/1349: loss=16.3221 (NCE=13.979, CLS=11.716)
  Batch 550/1349: loss=16.4484 (NCE=13.950, CLS=12.491)
  Batch 560/1349: loss=15.6554 (NCE=13.275, CLS=11.901)
  Batch 570/1349: loss=15.7333 (NCE=13.408, CLS=11.625)
  Batch 580/1349: loss=16.6755 (NCE=14.149, CLS=12.633)
  Batch 590/1349: loss=16.4953 (NCE=14.009, CLS=12.432)
  Batch 600/1349: loss=15.9896 (NCE=13.609, CLS=11.904)
  Batch 610/1349: loss=15.3942 (NCE=13.123, CLS=11.356)
  Batch 620/1349: loss=16.4058 (NCE=13.932, CLS=12.369)
  Batch 630/1349: loss=16.3852 (NCE=13.983, CLS=12.013)
  Batch 640/1349: loss=16.1127 (NCE=13.765, CLS=11.738)
  Batch 650/1349: loss=15.7670 (NCE=13.365, CLS=12.009)
  Batch 660/1349: loss=16.3476 (NCE=13.948, CLS=12.000)
  Batch 670/1349: loss=16.8099 (NCE=14.210, CLS=13.000)
  Batch 680/1349: loss=16.0891 (NCE=13.673, CLS=12.078)
  Batch 690/1349: loss=16.7085 (NCE=14.335, CLS=11.867)
  Batch 700/1349: loss=16.7176 (NCE=14.320, CLS=11.988)
  Batch 710/1349: loss=15.6456 (NCE=13.357, CLS=11.443)
  Batch 720/1349: loss=15.9499 (NCE=13.567, CLS=11.914)
  Batch 730/1349: loss=16.6068 (NCE=14.252, CLS=11.774)
  Batch 740/1349: loss=16.3478 (NCE=13.854, CLS=12.469)
  Batch 750/1349: loss=16.1124 (NCE=13.810, CLS=11.512)
  Batch 760/1349: loss=15.9798 (NCE=13.464, CLS=12.582)
  Batch 770/1349: loss=16.5241 (NCE=14.032, CLS=12.460)
  Batch 780/1349: loss=15.7760 (NCE=13.525, CLS=11.257)
  Batch 790/1349: loss=16.4084 (NCE=13.944, CLS=12.323)
  Batch 800/1349: loss=16.6418 (NCE=14.113, CLS=12.643)
  Batch 810/1349: loss=16.0006 (NCE=13.725, CLS=11.377)
  Batch 820/1349: loss=16.7198 (NCE=14.216, CLS=12.520)
  Batch 830/1349: loss=16.5571 (NCE=14.002, CLS=12.774)
  Batch 840/1349: loss=16.1823 (NCE=13.827, CLS=11.775)
  Batch 850/1349: loss=17.1825 (NCE=14.617, CLS=12.829)
  Batch 860/1349: loss=16.8856 (NCE=14.438, CLS=12.236)
  Batch 870/1349: loss=16.3604 (NCE=13.921, CLS=12.198)
  Batch 880/1349: loss=16.7013 (NCE=14.300, CLS=12.006)
  Batch 890/1349: loss=16.8658 (NCE=14.354, CLS=12.557)
  Batch 900/1349: loss=15.5742 (NCE=13.343, CLS=11.154)
  Batch 910/1349: loss=17.1078 (NCE=14.725, CLS=11.915)
  Batch 920/1349: loss=15.8831 (NCE=13.596, CLS=11.434)
  Batch 930/1349: loss=16.0051 (NCE=13.575, CLS=12.151)
  Batch 940/1349: loss=16.6139 (NCE=14.202, CLS=12.059)
  Batch 950/1349: loss=17.2439 (NCE=14.734, CLS=12.551)
  Batch 960/1349: loss=16.6827 (NCE=14.121, CLS=12.810)
  Batch 970/1349: loss=14.7720 (NCE=12.599, CLS=10.864)
  Batch 980/1349: loss=16.7033 (NCE=14.275, CLS=12.140)
  Batch 990/1349: loss=16.4367 (NCE=13.897, CLS=12.700)
  Batch 1000/1349: loss=16.9671 (NCE=14.437, CLS=12.650)
  Batch 1010/1349: loss=16.4191 (NCE=13.885, CLS=12.672)
  Batch 1020/1349: loss=15.8811 (NCE=13.541, CLS=11.703)
  Batch 1030/1349: loss=17.0338 (NCE=14.558, CLS=12.378)
  Batch 1040/1349: loss=15.7303 (NCE=13.352, CLS=11.889)
  Batch 1050/1349: loss=16.6941 (NCE=14.280, CLS=12.071)
  Batch 1060/1349: loss=14.8857 (NCE=12.691, CLS=10.972)
  Batch 1070/1349: loss=15.5915 (NCE=13.126, CLS=12.329)
  Batch 1080/1349: loss=16.0962 (NCE=13.555, CLS=12.704)
  Batch 1090/1349: loss=16.7027 (NCE=14.286, CLS=12.085)
  Batch 1100/1349: loss=16.2776 (NCE=13.809, CLS=12.344)
  Batch 1110/1349: loss=16.1974 (NCE=13.715, CLS=12.413)
  Batch 1120/1349: loss=16.4193 (NCE=13.909, CLS=12.552)
  Batch 1130/1349: loss=16.4391 (NCE=13.875, CLS=12.818)
  Batch 1140/1349: loss=16.3001 (NCE=13.931, CLS=11.847)
  Batch 1150/1349: loss=17.1036 (NCE=14.677, CLS=12.134)
  Batch 1160/1349: loss=16.4595 (NCE=14.013, CLS=12.235)
  Batch 1170/1349: loss=16.4665 (NCE=13.962, CLS=12.522)
  Batch 1180/1349: loss=15.9944 (NCE=13.548, CLS=12.232)
  Batch 1190/1349: loss=15.4372 (NCE=13.092, CLS=11.728)
  Batch 1200/1349: loss=16.6041 (NCE=13.983, CLS=13.105)
  Batch 1210/1349: loss=16.4827 (NCE=13.966, CLS=12.586)
  Batch 1220/1349: loss=16.9380 (NCE=14.347, CLS=12.955)
  Batch 1230/1349: loss=17.2894 (NCE=14.769, CLS=12.600)
  Batch 1240/1349: loss=16.7908 (NCE=14.188, CLS=13.014)
  Batch 1250/1349: loss=16.1114 (NCE=13.667, CLS=12.220)
  Batch 1260/1349: loss=16.6894 (NCE=14.237, CLS=12.261)
  Batch 1270/1349: loss=16.0705 (NCE=13.582, CLS=12.443)
  Batch 1280/1349: loss=16.2098 (NCE=13.860, CLS=11.747)
  Batch 1290/1349: loss=16.4472 (NCE=14.082, CLS=11.828)
  Batch 1300/1349: loss=15.4312 (NCE=12.985, CLS=12.228)
  Batch 1310/1349: loss=16.4224 (NCE=14.034, CLS=11.943)
  Batch 1320/1349: loss=16.9095 (NCE=14.270, CLS=13.198)
  Batch 1330/1349: loss=17.1636 (NCE=14.741, CLS=12.114)
  Batch 1340/1349: loss=15.9361 (NCE=13.335, CLS=13.006)
  Train: loss=16.3378 (NCE=13.907, CLS=12.152)
  Acc: HV=0.170, HJ=0.230, LV=0.173, LJ=0.098
  Val: loss=13.7754, R@10_HV=0.009
  New best model! (loss=13.7754)

Epoch 7/100
  Batch 10/1349: loss=16.2620 (NCE=13.762, CLS=12.500)
  Batch 20/1349: loss=15.9980 (NCE=13.627, CLS=11.857)
  Batch 30/1349: loss=15.1294 (NCE=12.687, CLS=12.213)
  Batch 40/1349: loss=16.2963 (NCE=13.816, CLS=12.400)
  Batch 50/1349: loss=16.6344 (NCE=14.176, CLS=12.292)
  Batch 60/1349: loss=17.1389 (NCE=14.730, CLS=12.045)
  Batch 70/1349: loss=17.4272 (NCE=14.929, CLS=12.492)
  Batch 80/1349: loss=16.6945 (NCE=14.343, CLS=11.755)
  Batch 90/1349: loss=16.3734 (NCE=13.929, CLS=12.221)
  Batch 100/1349: loss=17.3446 (NCE=14.811, CLS=12.667)
  Batch 110/1349: loss=16.1700 (NCE=13.771, CLS=11.997)
  Batch 120/1349: loss=15.9550 (NCE=13.463, CLS=12.459)
  Batch 130/1349: loss=16.6667 (NCE=14.100, CLS=12.835)
  Batch 140/1349: loss=16.1082 (NCE=13.648, CLS=12.299)
  Batch 150/1349: loss=15.9285 (NCE=13.548, CLS=11.902)
  Batch 160/1349: loss=17.2666 (NCE=14.797, CLS=12.349)
  Batch 170/1349: loss=16.2430 (NCE=13.792, CLS=12.255)
  Batch 180/1349: loss=15.7628 (NCE=13.551, CLS=11.060)
  Batch 190/1349: loss=16.4444 (NCE=14.091, CLS=11.766)
  Batch 200/1349: loss=16.2830 (NCE=13.862, CLS=12.106)
  Batch 210/1349: loss=16.2446 (NCE=13.749, CLS=12.477)
  Batch 220/1349: loss=15.9191 (NCE=13.397, CLS=12.609)
  Batch 230/1349: loss=17.0410 (NCE=14.624, CLS=12.085)
  Batch 240/1349: loss=17.0259 (NCE=14.380, CLS=13.227)
  Batch 250/1349: loss=16.6967 (NCE=14.291, CLS=12.029)
  Batch 260/1349: loss=15.6823 (NCE=13.263, CLS=12.095)
  Batch 270/1349: loss=16.0766 (NCE=13.644, CLS=12.161)
  Batch 280/1349: loss=16.1278 (NCE=13.697, CLS=12.153)
  Batch 290/1349: loss=16.3112 (NCE=14.020, CLS=11.458)
  Batch 300/1349: loss=16.4799 (NCE=14.003, CLS=12.385)
  Batch 310/1349: loss=17.1038 (NCE=14.580, CLS=12.620)
  Batch 320/1349: loss=16.3975 (NCE=14.009, CLS=11.942)
  Batch 330/1349: loss=15.3276 (NCE=13.067, CLS=11.303)
  Batch 340/1349: loss=15.7858 (NCE=13.439, CLS=11.735)
  Batch 350/1349: loss=16.3301 (NCE=13.902, CLS=12.140)
  Batch 360/1349: loss=16.0322 (NCE=13.768, CLS=11.321)
  Batch 370/1349: loss=16.2358 (NCE=13.866, CLS=11.851)
  Batch 380/1349: loss=16.1771 (NCE=13.797, CLS=11.900)
  Batch 390/1349: loss=16.8101 (NCE=14.366, CLS=12.220)
  Batch 400/1349: loss=14.9831 (NCE=12.908, CLS=10.378)
  Batch 410/1349: loss=15.8279 (NCE=13.459, CLS=11.845)
  Batch 420/1349: loss=16.1650 (NCE=13.761, CLS=12.018)
  Batch 430/1349: loss=16.2795 (NCE=13.838, CLS=12.209)
  Batch 440/1349: loss=16.7641 (NCE=14.377, CLS=11.935)
  Batch 450/1349: loss=16.6011 (NCE=14.154, CLS=12.235)
  Batch 460/1349: loss=16.5482 (NCE=14.105, CLS=12.218)
  Batch 470/1349: loss=15.3258 (NCE=13.138, CLS=10.941)
  Batch 480/1349: loss=15.9135 (NCE=13.655, CLS=11.295)
  Batch 490/1349: loss=16.5877 (NCE=14.101, CLS=12.433)
  Batch 500/1349: loss=16.6840 (NCE=14.193, CLS=12.453)
  Batch 510/1349: loss=16.5655 (NCE=14.037, CLS=12.643)
  Batch 520/1349: loss=15.8557 (NCE=13.457, CLS=11.992)
  Batch 530/1349: loss=16.3076 (NCE=13.915, CLS=11.964)
  Batch 540/1349: loss=17.0788 (NCE=14.654, CLS=12.122)
  Batch 550/1349: loss=16.3368 (NCE=13.859, CLS=12.389)
  Batch 560/1349: loss=15.8196 (NCE=13.418, CLS=12.007)
  Batch 570/1349: loss=15.8494 (NCE=13.498, CLS=11.756)
  Batch 580/1349: loss=16.3740 (NCE=13.916, CLS=12.292)
  Batch 590/1349: loss=16.1153 (NCE=13.680, CLS=12.176)
  Batch 600/1349: loss=16.9303 (NCE=14.485, CLS=12.226)
  Batch 610/1349: loss=17.4986 (NCE=15.059, CLS=12.200)
  Batch 620/1349: loss=15.7458 (NCE=13.405, CLS=11.703)
  Batch 630/1349: loss=15.7050 (NCE=13.338, CLS=11.836)
  Batch 640/1349: loss=15.2798 (NCE=13.066, CLS=11.072)
  Batch 650/1349: loss=16.5199 (NCE=14.113, CLS=12.035)
  Batch 660/1349: loss=15.8268 (NCE=13.449, CLS=11.888)
  Batch 670/1349: loss=16.1451 (NCE=13.759, CLS=11.932)
  Batch 680/1349: loss=15.9830 (NCE=13.640, CLS=11.717)
  Batch 690/1349: loss=15.7684 (NCE=13.451, CLS=11.585)
  Batch 700/1349: loss=16.3311 (NCE=13.850, CLS=12.407)
  Batch 710/1349: loss=16.0644 (NCE=13.691, CLS=11.867)
  Batch 720/1349: loss=16.0324 (NCE=13.623, CLS=12.047)
  Batch 730/1349: loss=16.8078 (NCE=14.276, CLS=12.660)
  Batch 740/1349: loss=15.6566 (NCE=13.280, CLS=11.882)
  Batch 750/1349: loss=15.3990 (NCE=13.142, CLS=11.285)
  Batch 760/1349: loss=16.7938 (NCE=14.389, CLS=12.025)
  Batch 770/1349: loss=16.7726 (NCE=14.200, CLS=12.862)
  Batch 780/1349: loss=15.4527 (NCE=13.099, CLS=11.770)
  Batch 790/1349: loss=16.1904 (NCE=13.789, CLS=12.007)
  Batch 800/1349: loss=16.2958 (NCE=13.880, CLS=12.077)
  Batch 810/1349: loss=16.5227 (NCE=13.976, CLS=12.731)
  Batch 820/1349: loss=16.8879 (NCE=14.479, CLS=12.046)
  Batch 830/1349: loss=15.9984 (NCE=13.633, CLS=11.828)
  Batch 840/1349: loss=15.1048 (NCE=12.931, CLS=10.870)
  Batch 850/1349: loss=15.5640 (NCE=13.002, CLS=12.811)
  Batch 860/1349: loss=16.4499 (NCE=14.120, CLS=11.650)
  Batch 870/1349: loss=16.1919 (NCE=13.724, CLS=12.339)
  Batch 880/1349: loss=15.1590 (NCE=12.907, CLS=11.262)
  Batch 890/1349: loss=16.5398 (NCE=14.047, CLS=12.467)
  Batch 900/1349: loss=16.4457 (NCE=13.927, CLS=12.593)
  Batch 910/1349: loss=16.5216 (NCE=14.171, CLS=11.755)
  Batch 920/1349: loss=16.3001 (NCE=13.662, CLS=13.190)
  Batch 930/1349: loss=16.5101 (NCE=14.198, CLS=11.559)
  Batch 940/1349: loss=15.9948 (NCE=13.674, CLS=11.603)
  Batch 950/1349: loss=16.6963 (NCE=14.321, CLS=11.878)
  Batch 960/1349: loss=15.8564 (NCE=13.475, CLS=11.906)
  Batch 970/1349: loss=16.1623 (NCE=13.893, CLS=11.347)
  Batch 980/1349: loss=17.1996 (NCE=14.746, CLS=12.267)
  Batch 990/1349: loss=15.8490 (NCE=13.477, CLS=11.859)
  Batch 1000/1349: loss=15.5455 (NCE=13.338, CLS=11.039)
  Batch 1010/1349: loss=15.8145 (NCE=13.512, CLS=11.513)
  Batch 1020/1349: loss=16.6749 (NCE=14.232, CLS=12.214)
  Batch 1030/1349: loss=15.8840 (NCE=13.371, CLS=12.564)
  Batch 1040/1349: loss=17.0834 (NCE=14.545, CLS=12.691)
  Batch 1050/1349: loss=15.8266 (NCE=13.481, CLS=11.726)
  Batch 1060/1349: loss=16.6080 (NCE=14.234, CLS=11.869)
  Batch 1070/1349: loss=16.0945 (NCE=13.787, CLS=11.538)
  Batch 1080/1349: loss=16.6171 (NCE=14.053, CLS=12.823)
  Batch 1090/1349: loss=15.7591 (NCE=13.298, CLS=12.305)
  Batch 1100/1349: loss=16.0783 (NCE=13.839, CLS=11.198)
  Batch 1110/1349: loss=17.0076 (NCE=14.495, CLS=12.563)
  Batch 1120/1349: loss=15.9326 (NCE=13.618, CLS=11.574)
  Batch 1130/1349: loss=16.1431 (NCE=13.847, CLS=11.481)
  Batch 1140/1349: loss=16.1887 (NCE=13.720, CLS=12.341)
  Batch 1150/1349: loss=16.6028 (NCE=14.169, CLS=12.172)
  Batch 1160/1349: loss=15.9223 (NCE=13.391, CLS=12.657)
  Batch 1170/1349: loss=15.4889 (NCE=13.070, CLS=12.095)
  Batch 1180/1349: loss=17.2571 (NCE=14.865, CLS=11.960)
  Batch 1190/1349: loss=16.1880 (NCE=13.798, CLS=11.952)
  Batch 1200/1349: loss=16.4703 (NCE=14.019, CLS=12.258)
  Batch 1210/1349: loss=16.2945 (NCE=13.796, CLS=12.490)
  Batch 1220/1349: loss=17.3454 (NCE=14.724, CLS=13.108)
  Batch 1230/1349: loss=16.3291 (NCE=13.960, CLS=11.847)
  Batch 1240/1349: loss=16.1879 (NCE=13.748, CLS=12.201)
  Batch 1250/1349: loss=15.9798 (NCE=13.640, CLS=11.699)
  Batch 1260/1349: loss=15.4165 (NCE=12.953, CLS=12.320)
  Batch 1270/1349: loss=15.8804 (NCE=13.509, CLS=11.858)
  Batch 1280/1349: loss=15.5603 (NCE=13.152, CLS=12.040)
  Batch 1290/1349: loss=16.1590 (NCE=13.883, CLS=11.379)
  Batch 1300/1349: loss=15.2879 (NCE=13.015, CLS=11.365)
  Batch 1310/1349: loss=16.1213 (NCE=13.601, CLS=12.604)
  Batch 1320/1349: loss=16.1585 (NCE=13.798, CLS=11.802)
  Batch 1330/1349: loss=15.9981 (NCE=13.545, CLS=12.268)
  Batch 1340/1349: loss=16.2977 (NCE=13.932, CLS=11.827)
  Train: loss=16.2984 (NCE=13.876, CLS=12.113)
  Acc: HV=0.171, HJ=0.230, LV=0.173, LJ=0.103
  Val: loss=13.7870, R@10_HV=0.010

Epoch 8/100
  Batch 10/1349: loss=16.3690 (NCE=14.016, CLS=11.766)
  Batch 20/1349: loss=15.9711 (NCE=13.666, CLS=11.524)
  Batch 30/1349: loss=16.5842 (NCE=14.212, CLS=11.861)
  Batch 40/1349: loss=16.5841 (NCE=14.119, CLS=12.324)
  Batch 50/1349: loss=15.8117 (NCE=13.427, CLS=11.922)
  Batch 60/1349: loss=16.2566 (NCE=13.804, CLS=12.263)
  Batch 70/1349: loss=15.2268 (NCE=12.851, CLS=11.881)
  Batch 80/1349: loss=16.6643 (NCE=14.237, CLS=12.136)
  Batch 90/1349: loss=15.9762 (NCE=13.576, CLS=12.001)
  Batch 100/1349: loss=16.7458 (NCE=14.258, CLS=12.440)
  Batch 110/1349: loss=15.4312 (NCE=12.969, CLS=12.310)
  Batch 120/1349: loss=16.9021 (NCE=14.450, CLS=12.261)
  Batch 130/1349: loss=16.4037 (NCE=14.061, CLS=11.713)
  Batch 140/1349: loss=15.7517 (NCE=13.242, CLS=12.548)
  Batch 150/1349: loss=16.3586 (NCE=13.974, CLS=11.922)
  Batch 160/1349: loss=16.1494 (NCE=13.752, CLS=11.987)
  Batch 170/1349: loss=16.5290 (NCE=13.978, CLS=12.757)
  Batch 180/1349: loss=16.3183 (NCE=13.803, CLS=12.578)
  Batch 190/1349: loss=16.6806 (NCE=14.227, CLS=12.268)
  Batch 200/1349: loss=15.8077 (NCE=13.453, CLS=11.775)
  Batch 210/1349: loss=16.9572 (NCE=14.550, CLS=12.035)
  Batch 220/1349: loss=16.4776 (NCE=13.902, CLS=12.877)
  Batch 230/1349: loss=16.1316 (NCE=13.755, CLS=11.881)
  Batch 240/1349: loss=16.4874 (NCE=14.041, CLS=12.230)
  Batch 250/1349: loss=16.5464 (NCE=14.040, CLS=12.531)
  Batch 260/1349: loss=16.0712 (NCE=13.565, CLS=12.530)
  Batch 270/1349: loss=16.1747 (NCE=13.747, CLS=12.140)
  Batch 280/1349: loss=16.3060 (NCE=13.928, CLS=11.889)
  Batch 290/1349: loss=16.6851 (NCE=14.205, CLS=12.400)
  Batch 300/1349: loss=15.7262 (NCE=13.443, CLS=11.416)
  Batch 310/1349: loss=16.2106 (NCE=13.817, CLS=11.969)
  Batch 320/1349: loss=16.4963 (NCE=13.967, CLS=12.645)
  Batch 330/1349: loss=16.7806 (NCE=14.365, CLS=12.078)
  Batch 340/1349: loss=16.3395 (NCE=13.797, CLS=12.712)
  Batch 350/1349: loss=16.9719 (NCE=14.476, CLS=12.480)
  Batch 360/1349: loss=16.4218 (NCE=13.848, CLS=12.867)
  Batch 370/1349: loss=17.0798 (NCE=14.564, CLS=12.580)
  Batch 380/1349: loss=16.7689 (NCE=14.146, CLS=13.116)
  Batch 390/1349: loss=15.9723 (NCE=13.660, CLS=11.563)
  Batch 400/1349: loss=17.2739 (NCE=14.745, CLS=12.643)
  Batch 410/1349: loss=15.9483 (NCE=13.563, CLS=11.924)
  Batch 420/1349: loss=15.6466 (NCE=13.211, CLS=12.176)
  Batch 430/1349: loss=16.2789 (NCE=13.849, CLS=12.149)
  Batch 440/1349: loss=16.0752 (NCE=13.822, CLS=11.268)
  Batch 450/1349: loss=16.6103 (NCE=14.166, CLS=12.222)
  Batch 460/1349: loss=16.2809 (NCE=13.794, CLS=12.435)
  Batch 470/1349: loss=15.7153 (NCE=13.243, CLS=12.362)
  Batch 480/1349: loss=17.4446 (NCE=14.928, CLS=12.585)
  Batch 490/1349: loss=16.8588 (NCE=14.461, CLS=11.990)
  Batch 500/1349: loss=16.5324 (NCE=13.916, CLS=13.080)
  Batch 510/1349: loss=16.5597 (NCE=14.072, CLS=12.440)
  Batch 520/1349: loss=16.5541 (NCE=14.160, CLS=11.973)
  Batch 530/1349: loss=15.0322 (NCE=12.831, CLS=11.008)
  Batch 540/1349: loss=15.9955 (NCE=13.471, CLS=12.623)
  Batch 550/1349: loss=15.8595 (NCE=13.494, CLS=11.827)
  Batch 560/1349: loss=16.8655 (NCE=14.446, CLS=12.095)
  Batch 570/1349: loss=15.2966 (NCE=12.956, CLS=11.705)
  Batch 580/1349: loss=16.4239 (NCE=14.036, CLS=11.938)
  Batch 590/1349: loss=16.8897 (NCE=14.357, CLS=12.662)
  Batch 600/1349: loss=15.9246 (NCE=13.545, CLS=11.900)
  Batch 610/1349: loss=16.2140 (NCE=13.825, CLS=11.947)
  Batch 620/1349: loss=16.7200 (NCE=14.235, CLS=12.427)
  Batch 630/1349: loss=16.3392 (NCE=13.828, CLS=12.555)
  Batch 640/1349: loss=16.2359 (NCE=13.925, CLS=11.555)
  Batch 650/1349: loss=16.0637 (NCE=13.726, CLS=11.687)
  Batch 660/1349: loss=16.2303 (NCE=13.717, CLS=12.568)
  Batch 670/1349: loss=16.3910 (NCE=14.022, CLS=11.846)
  Batch 680/1349: loss=15.9949 (NCE=13.563, CLS=12.159)
  Batch 690/1349: loss=17.0297 (NCE=14.478, CLS=12.760)
  Batch 700/1349: loss=16.3662 (NCE=14.106, CLS=11.303)
  Batch 710/1349: loss=16.9129 (NCE=14.311, CLS=13.012)
  Batch 720/1349: loss=16.4413 (NCE=14.029, CLS=12.063)
  Batch 730/1349: loss=16.7591 (NCE=14.403, CLS=11.780)
  Batch 740/1349: loss=16.2928 (NCE=13.864, CLS=12.142)
  Batch 750/1349: loss=16.1428 (NCE=13.740, CLS=12.013)
  Batch 760/1349: loss=16.6743 (NCE=14.202, CLS=12.363)
  Batch 770/1349: loss=16.7179 (NCE=14.352, CLS=11.831)
  Batch 780/1349: loss=15.3869 (NCE=12.945, CLS=12.208)
  Batch 790/1349: loss=16.7684 (NCE=14.311, CLS=12.288)
  Batch 800/1349: loss=16.8227 (NCE=14.335, CLS=12.439)
  Batch 810/1349: loss=15.4844 (NCE=13.183, CLS=11.505)
  Batch 820/1349: loss=16.6101 (NCE=14.013, CLS=12.984)
  Batch 830/1349: loss=15.9998 (NCE=13.681, CLS=11.593)
  Batch 840/1349: loss=16.7284 (NCE=14.371, CLS=11.785)
  Batch 850/1349: loss=16.2377 (NCE=13.879, CLS=11.792)
  Batch 860/1349: loss=15.7117 (NCE=13.373, CLS=11.694)
  Batch 870/1349: loss=15.0082 (NCE=12.696, CLS=11.561)
  Batch 880/1349: loss=16.6075 (NCE=14.122, CLS=12.427)
  Batch 890/1349: loss=15.8053 (NCE=13.413, CLS=11.962)
  Batch 900/1349: loss=16.7038 (NCE=14.198, CLS=12.531)
  Batch 910/1349: loss=16.4067 (NCE=14.009, CLS=11.990)
  Batch 920/1349: loss=16.7586 (NCE=14.286, CLS=12.362)
  Batch 930/1349: loss=17.1537 (NCE=14.594, CLS=12.798)
  Batch 940/1349: loss=16.3031 (NCE=13.863, CLS=12.201)
  Batch 950/1349: loss=16.1787 (NCE=13.802, CLS=11.884)
  Batch 960/1349: loss=15.8782 (NCE=13.567, CLS=11.558)
  Batch 970/1349: loss=15.9939 (NCE=13.558, CLS=12.181)
  Batch 980/1349: loss=16.3490 (NCE=13.826, CLS=12.613)
  Batch 990/1349: loss=16.6695 (NCE=14.210, CLS=12.296)
  Batch 1000/1349: loss=16.5496 (NCE=14.025, CLS=12.624)
  Batch 1010/1349: loss=15.9475 (NCE=13.637, CLS=11.551)
  Batch 1020/1349: loss=16.1651 (NCE=13.812, CLS=11.763)
  Batch 1030/1349: loss=16.1599 (NCE=13.785, CLS=11.877)
  Batch 1040/1349: loss=16.5469 (NCE=14.193, CLS=11.770)
  Batch 1050/1349: loss=17.0878 (NCE=14.583, CLS=12.524)
  Batch 1060/1349: loss=17.2642 (NCE=14.848, CLS=12.084)
  Batch 1070/1349: loss=16.2753 (NCE=13.807, CLS=12.343)
  Batch 1080/1349: loss=17.2402 (NCE=14.826, CLS=12.073)
  Batch 1090/1349: loss=16.7675 (NCE=14.357, CLS=12.052)
  Batch 1100/1349: loss=15.3937 (NCE=13.089, CLS=11.523)
  Batch 1110/1349: loss=16.4332 (NCE=13.963, CLS=12.352)
  Batch 1120/1349: loss=16.4473 (NCE=14.117, CLS=11.650)
  Batch 1130/1349: loss=15.3218 (NCE=12.863, CLS=12.292)
  Batch 1140/1349: loss=16.7904 (NCE=14.301, CLS=12.449)
  Batch 1150/1349: loss=15.9531 (NCE=13.623, CLS=11.649)
  Batch 1160/1349: loss=15.3467 (NCE=13.052, CLS=11.472)
  Batch 1170/1349: loss=16.2879 (NCE=13.908, CLS=11.898)
  Batch 1180/1349: loss=16.6244 (NCE=14.185, CLS=12.197)
  Batch 1190/1349: loss=16.4449 (NCE=13.922, CLS=12.615)
  Batch 1200/1349: loss=16.5098 (NCE=13.886, CLS=13.121)
  Batch 1210/1349: loss=16.7742 (NCE=14.173, CLS=13.007)
  Batch 1220/1349: loss=15.5297 (NCE=13.166, CLS=11.816)
  Batch 1230/1349: loss=16.8687 (NCE=14.534, CLS=11.676)
  Batch 1240/1349: loss=16.1962 (NCE=13.767, CLS=12.148)
  Batch 1250/1349: loss=16.5304 (NCE=14.092, CLS=12.191)
  Batch 1260/1349: loss=15.8131 (NCE=13.527, CLS=11.430)
  Batch 1270/1349: loss=16.0245 (NCE=13.823, CLS=11.006)
  Batch 1280/1349: loss=16.9543 (NCE=14.509, CLS=12.229)
  Batch 1290/1349: loss=16.2213 (NCE=13.717, CLS=12.523)
  Batch 1300/1349: loss=16.1831 (NCE=13.772, CLS=12.058)
  Batch 1310/1349: loss=16.0872 (NCE=13.759, CLS=11.641)
  Batch 1320/1349: loss=16.0307 (NCE=13.704, CLS=11.631)
  Batch 1330/1349: loss=16.3082 (NCE=13.832, CLS=12.380)
  Batch 1340/1349: loss=16.4279 (NCE=14.044, CLS=11.919)
  Train: loss=16.2612 (NCE=13.844, CLS=12.087)
  Acc: HV=0.172, HJ=0.230, LV=0.177, LJ=0.101
  Val: loss=13.7699, R@10_HV=0.010
  New best model! (loss=13.7699)

Epoch 9/100
  Batch 10/1349: loss=16.0431 (NCE=13.606, CLS=12.186)
  Batch 20/1349: loss=16.7380 (NCE=14.334, CLS=12.021)
  Batch 30/1349: loss=16.2479 (NCE=13.816, CLS=12.157)
  Batch 40/1349: loss=15.5138 (NCE=13.119, CLS=11.976)
  Batch 50/1349: loss=15.7941 (NCE=13.531, CLS=11.314)
  Batch 60/1349: loss=16.4031 (NCE=13.968, CLS=12.173)
  Batch 70/1349: loss=16.8489 (NCE=14.353, CLS=12.478)
  Batch 80/1349: loss=16.4435 (NCE=14.022, CLS=12.107)
  Batch 90/1349: loss=15.9462 (NCE=13.672, CLS=11.369)
  Batch 100/1349: loss=16.8990 (NCE=14.459, CLS=12.200)
  Batch 110/1349: loss=15.7261 (NCE=13.461, CLS=11.326)
  Batch 120/1349: loss=16.5671 (NCE=14.131, CLS=12.181)
  Batch 130/1349: loss=16.1682 (NCE=13.758, CLS=12.052)
  Batch 140/1349: loss=16.1367 (NCE=13.698, CLS=12.194)
  Batch 150/1349: loss=16.9998 (NCE=14.605, CLS=11.975)
  Batch 160/1349: loss=16.4266 (NCE=13.975, CLS=12.258)
  Batch 170/1349: loss=16.0828 (NCE=13.774, CLS=11.543)
  Batch 180/1349: loss=16.0303 (NCE=13.519, CLS=12.559)
  Batch 190/1349: loss=16.2302 (NCE=13.824, CLS=12.031)
  Batch 200/1349: loss=15.7062 (NCE=13.352, CLS=11.770)
  Batch 210/1349: loss=15.8043 (NCE=13.497, CLS=11.537)
  Batch 220/1349: loss=16.4547 (NCE=14.017, CLS=12.187)
  Batch 230/1349: loss=15.9863 (NCE=13.653, CLS=11.668)
  Batch 240/1349: loss=16.3210 (NCE=14.016, CLS=11.526)
  Batch 250/1349: loss=15.4349 (NCE=13.149, CLS=11.430)
  Batch 260/1349: loss=15.9976 (NCE=13.544, CLS=12.268)
  Batch 270/1349: loss=16.4956 (NCE=14.133, CLS=11.815)
  Batch 280/1349: loss=16.4453 (NCE=14.021, CLS=12.120)
  Batch 290/1349: loss=15.8371 (NCE=13.601, CLS=11.181)
  Batch 300/1349: loss=16.1097 (NCE=13.657, CLS=12.263)
  Batch 310/1349: loss=16.6684 (NCE=14.253, CLS=12.077)
  Batch 320/1349: loss=16.9036 (NCE=14.505, CLS=11.993)
  Batch 330/1349: loss=16.5676 (NCE=14.120, CLS=12.239)
  Batch 340/1349: loss=16.4927 (NCE=14.021, CLS=12.361)
  Batch 350/1349: loss=16.4799 (NCE=14.189, CLS=11.453)
  Batch 360/1349: loss=16.4290 (NCE=14.061, CLS=11.840)
  Batch 370/1349: loss=15.9995 (NCE=13.691, CLS=11.543)
  Batch 380/1349: loss=15.7971 (NCE=13.404, CLS=11.964)
  Batch 390/1349: loss=16.5396 (NCE=14.108, CLS=12.160)
  Batch 400/1349: loss=16.0980 (NCE=13.705, CLS=11.967)
  Batch 410/1349: loss=15.6966 (NCE=13.347, CLS=11.749)
  Batch 420/1349: loss=17.1032 (NCE=14.665, CLS=12.192)
  Batch 430/1349: loss=15.7805 (NCE=13.451, CLS=11.646)
  Batch 440/1349: loss=15.9060 (NCE=13.586, CLS=11.598)
  Batch 450/1349: loss=16.7718 (NCE=14.190, CLS=12.911)
  Batch 460/1349: loss=17.2265 (NCE=14.720, CLS=12.533)
  Batch 470/1349: loss=16.2230 (NCE=13.913, CLS=11.550)
  Batch 480/1349: loss=16.6168 (NCE=14.067, CLS=12.748)
  Batch 490/1349: loss=16.1671 (NCE=13.611, CLS=12.780)
  Batch 500/1349: loss=15.3430 (NCE=13.145, CLS=10.990)
  Batch 510/1349: loss=15.5226 (NCE=13.177, CLS=11.728)
  Batch 520/1349: loss=16.1610 (NCE=13.720, CLS=12.206)
  Batch 530/1349: loss=16.1976 (NCE=13.894, CLS=11.520)
  Batch 540/1349: loss=16.5641 (NCE=14.053, CLS=12.557)
  Batch 550/1349: loss=16.4555 (NCE=14.018, CLS=12.190)
  Batch 560/1349: loss=15.9530 (NCE=13.507, CLS=12.230)
  Batch 570/1349: loss=16.3350 (NCE=13.944, CLS=11.955)
  Batch 580/1349: loss=16.3195 (NCE=13.821, CLS=12.494)
  Batch 590/1349: loss=15.5082 (NCE=13.265, CLS=11.216)
  Batch 600/1349: loss=16.2104 (NCE=13.848, CLS=11.813)
  Batch 610/1349: loss=16.6038 (NCE=14.171, CLS=12.166)
  Batch 620/1349: loss=16.6114 (NCE=14.185, CLS=12.133)
  Batch 630/1349: loss=15.9157 (NCE=13.592, CLS=11.621)
  Batch 640/1349: loss=15.9727 (NCE=13.758, CLS=11.074)
  Batch 650/1349: loss=16.3454 (NCE=13.968, CLS=11.887)
  Batch 660/1349: loss=16.7455 (NCE=14.260, CLS=12.428)
  Batch 670/1349: loss=16.8506 (NCE=14.420, CLS=12.152)
  Batch 680/1349: loss=17.4430 (NCE=14.978, CLS=12.327)
  Batch 690/1349: loss=15.9988 (NCE=13.567, CLS=12.160)
  Batch 700/1349: loss=16.2252 (NCE=13.853, CLS=11.859)
  Batch 710/1349: loss=16.4278 (NCE=13.827, CLS=13.004)
  Batch 720/1349: loss=14.9527 (NCE=12.865, CLS=10.441)
  Batch 730/1349: loss=15.7781 (NCE=13.484, CLS=11.472)
  Batch 740/1349: loss=17.1415 (NCE=14.620, CLS=12.608)
  Batch 750/1349: loss=16.3405 (NCE=13.914, CLS=12.130)
  Batch 760/1349: loss=16.3797 (NCE=14.038, CLS=11.710)
  Batch 770/1349: loss=16.7495 (NCE=14.145, CLS=13.025)
  Batch 780/1349: loss=16.7567 (NCE=14.264, CLS=12.462)
  Batch 790/1349: loss=15.9703 (NCE=13.550, CLS=12.102)
  Batch 800/1349: loss=15.9399 (NCE=13.558, CLS=11.911)
  Batch 810/1349: loss=15.7902 (NCE=13.440, CLS=11.751)
  Batch 820/1349: loss=16.0733 (NCE=13.705, CLS=11.842)
  Batch 830/1349: loss=15.6907 (NCE=13.420, CLS=11.354)
  Batch 840/1349: loss=16.4507 (NCE=13.945, CLS=12.527)
  Batch 850/1349: loss=17.3117 (NCE=14.741, CLS=12.856)
  Batch 860/1349: loss=16.7763 (NCE=14.274, CLS=12.512)
  Batch 870/1349: loss=15.6465 (NCE=13.336, CLS=11.553)
  Batch 880/1349: loss=16.4355 (NCE=13.914, CLS=12.605)
  Batch 890/1349: loss=17.0898 (NCE=14.570, CLS=12.597)
  Batch 900/1349: loss=16.2706 (NCE=13.822, CLS=12.244)
  Batch 910/1349: loss=16.8499 (NCE=14.323, CLS=12.636)
  Batch 920/1349: loss=16.4643 (NCE=14.077, CLS=11.935)
  Batch 930/1349: loss=16.3244 (NCE=13.997, CLS=11.635)
  Batch 940/1349: loss=16.8447 (NCE=14.469, CLS=11.876)
  Batch 950/1349: loss=15.9230 (NCE=13.394, CLS=12.644)
  Batch 960/1349: loss=16.8483 (NCE=14.378, CLS=12.353)
  Batch 970/1349: loss=15.5250 (NCE=13.168, CLS=11.785)
  Batch 980/1349: loss=16.3285 (NCE=13.819, CLS=12.545)
  Batch 990/1349: loss=15.8248 (NCE=13.447, CLS=11.890)
  Batch 1000/1349: loss=15.9337 (NCE=13.449, CLS=12.425)
  Batch 1010/1349: loss=15.5665 (NCE=13.215, CLS=11.760)
  Batch 1020/1349: loss=16.5115 (NCE=14.035, CLS=12.381)
  Batch 1030/1349: loss=15.4329 (NCE=13.215, CLS=11.090)
  Batch 1040/1349: loss=15.7829 (NCE=13.469, CLS=11.568)
  Batch 1050/1349: loss=16.6229 (NCE=14.114, CLS=12.544)
  Batch 1060/1349: loss=17.1514 (NCE=14.698, CLS=12.269)
  Batch 1070/1349: loss=16.4943 (NCE=14.041, CLS=12.266)
  Batch 1080/1349: loss=16.0610 (NCE=13.756, CLS=11.526)
  Batch 1090/1349: loss=15.5032 (NCE=13.176, CLS=11.638)
  Batch 1100/1349: loss=15.8407 (NCE=13.610, CLS=11.155)
  Batch 1110/1349: loss=16.1033 (NCE=13.716, CLS=11.938)
  Batch 1120/1349: loss=16.5079 (NCE=14.084, CLS=12.119)
  Batch 1130/1349: loss=16.8185 (NCE=14.410, CLS=12.043)
  Batch 1140/1349: loss=16.2608 (NCE=13.766, CLS=12.475)
  Batch 1150/1349: loss=16.4325 (NCE=13.939, CLS=12.466)
  Batch 1160/1349: loss=16.8489 (NCE=14.478, CLS=11.856)
  Batch 1170/1349: loss=17.7047 (NCE=15.017, CLS=13.437)
  Batch 1180/1349: loss=16.8009 (NCE=14.394, CLS=12.035)
  Batch 1190/1349: loss=16.5397 (NCE=14.055, CLS=12.422)
  Batch 1200/1349: loss=16.1514 (NCE=13.830, CLS=11.609)
  Batch 1210/1349: loss=16.0701 (NCE=13.782, CLS=11.441)
  Batch 1220/1349: loss=15.4269 (NCE=13.154, CLS=11.363)
  Batch 1230/1349: loss=16.2596 (NCE=13.873, CLS=11.933)
  Batch 1240/1349: loss=15.5155 (NCE=13.254, CLS=11.308)
  Batch 1250/1349: loss=15.3954 (NCE=13.039, CLS=11.780)
  Batch 1260/1349: loss=16.0093 (NCE=13.445, CLS=12.823)
  Batch 1270/1349: loss=17.0985 (NCE=14.641, CLS=12.289)
  Batch 1280/1349: loss=16.2303 (NCE=13.793, CLS=12.186)
  Batch 1290/1349: loss=15.8251 (NCE=13.328, CLS=12.487)
  Batch 1300/1349: loss=16.3874 (NCE=13.904, CLS=12.415)
  Batch 1310/1349: loss=15.7973 (NCE=13.469, CLS=11.640)
  Batch 1320/1349: loss=16.7705 (NCE=14.201, CLS=12.850)
  Batch 1330/1349: loss=16.5130 (NCE=13.852, CLS=13.305)
  Batch 1340/1349: loss=15.7538 (NCE=13.409, CLS=11.723)
  Train: loss=16.2256 (NCE=13.816, CLS=12.049)
  Acc: HV=0.173, HJ=0.233, LV=0.180, LJ=0.105
  Val: loss=13.7521, R@10_HV=0.011
  New best model! (loss=13.7521)

Epoch 10/100
  Batch 10/1349: loss=15.1993 (NCE=12.661, CLS=12.691)
  Batch 20/1349: loss=16.5682 (NCE=14.178, CLS=11.951)
  Batch 30/1349: loss=15.8499 (NCE=13.554, CLS=11.480)
  Batch 40/1349: loss=16.7739 (NCE=14.250, CLS=12.617)
  Batch 50/1349: loss=15.5541 (NCE=13.328, CLS=11.128)
  Batch 60/1349: loss=16.3423 (NCE=14.037, CLS=11.528)
  Batch 70/1349: loss=16.0773 (NCE=13.695, CLS=11.913)
  Batch 80/1349: loss=16.7997 (NCE=14.325, CLS=12.372)
  Batch 90/1349: loss=16.7788 (NCE=14.328, CLS=12.256)
  Batch 100/1349: loss=16.1343 (NCE=13.649, CLS=12.424)
  Batch 110/1349: loss=16.7291 (NCE=14.300, CLS=12.145)
  Batch 120/1349: loss=15.6830 (NCE=13.358, CLS=11.623)
  Batch 130/1349: loss=16.0229 (NCE=13.579, CLS=12.218)
  Batch 140/1349: loss=15.5450 (NCE=13.219, CLS=11.628)
  Batch 150/1349: loss=15.5911 (NCE=13.407, CLS=10.918)
  Batch 160/1349: loss=16.6537 (NCE=14.107, CLS=12.736)
  Batch 170/1349: loss=16.5546 (NCE=14.121, CLS=12.169)
  Batch 180/1349: loss=16.1649 (NCE=13.753, CLS=12.059)
  Batch 190/1349: loss=15.7325 (NCE=13.425, CLS=11.540)
  Batch 200/1349: loss=16.7310 (NCE=14.297, CLS=12.168)
  Batch 210/1349: loss=16.5238 (NCE=13.994, CLS=12.649)
  Batch 220/1349: loss=16.1575 (NCE=13.751, CLS=12.034)
  Batch 230/1349: loss=17.0787 (NCE=14.540, CLS=12.694)
  Batch 240/1349: loss=15.7324 (NCE=13.383, CLS=11.749)
  Batch 250/1349: loss=16.2753 (NCE=13.886, CLS=11.945)
  Batch 260/1349: loss=16.5556 (NCE=14.029, CLS=12.633)
  Batch 270/1349: loss=16.0214 (NCE=13.617, CLS=12.022)
  Batch 280/1349: loss=15.8615 (NCE=13.529, CLS=11.661)
  Batch 290/1349: loss=16.5126 (NCE=14.154, CLS=11.794)
  Batch 300/1349: loss=16.5786 (NCE=14.126, CLS=12.263)
  Batch 310/1349: loss=15.1968 (NCE=12.923, CLS=11.368)
  Batch 320/1349: loss=16.3617 (NCE=13.864, CLS=12.490)
  Batch 330/1349: loss=16.5364 (NCE=13.903, CLS=13.168)
  Batch 340/1349: loss=15.0374 (NCE=12.757, CLS=11.400)
  Batch 350/1349: loss=16.4295 (NCE=13.899, CLS=12.652)
  Batch 360/1349: loss=15.7900 (NCE=13.236, CLS=12.771)
  Batch 370/1349: loss=15.4941 (NCE=13.243, CLS=11.257)
  Batch 380/1349: loss=16.2043 (NCE=13.807, CLS=11.986)
  Batch 390/1349: loss=16.7314 (NCE=14.297, CLS=12.174)
  Batch 400/1349: loss=16.2063 (NCE=13.866, CLS=11.700)
  Batch 410/1349: loss=16.6544 (NCE=14.243, CLS=12.059)
  Batch 420/1349: loss=16.7866 (NCE=14.114, CLS=13.365)
  Batch 430/1349: loss=15.7600 (NCE=13.474, CLS=11.432)
  Batch 440/1349: loss=16.2774 (NCE=13.912, CLS=11.826)
  Batch 450/1349: loss=16.8378 (NCE=14.475, CLS=11.816)
  Batch 460/1349: loss=16.4371 (NCE=14.042, CLS=11.975)
  Batch 470/1349: loss=17.0087 (NCE=14.540, CLS=12.342)
  Batch 480/1349: loss=16.0543 (NCE=13.695, CLS=11.794)
  Batch 490/1349: loss=15.9415 (NCE=13.627, CLS=11.574)
  Batch 500/1349: loss=17.0711 (NCE=14.588, CLS=12.416)
  Batch 510/1349: loss=16.9184 (NCE=14.415, CLS=12.518)
  Batch 520/1349: loss=16.4488 (NCE=13.979, CLS=12.351)
  Batch 530/1349: loss=15.7389 (NCE=13.309, CLS=12.150)
  Batch 540/1349: loss=17.0857 (NCE=14.499, CLS=12.932)
  Batch 550/1349: loss=15.9057 (NCE=13.564, CLS=11.710)
  Batch 560/1349: loss=16.7126 (NCE=14.314, CLS=11.991)
  Batch 570/1349: loss=16.4448 (NCE=14.000, CLS=12.224)
  Batch 580/1349: loss=16.5590 (NCE=14.053, CLS=12.532)
  Batch 590/1349: loss=16.4802 (NCE=14.030, CLS=12.251)
  Batch 600/1349: loss=16.0254 (NCE=13.526, CLS=12.499)
  Batch 610/1349: loss=16.9436 (NCE=14.401, CLS=12.715)
  Batch 620/1349: loss=15.5432 (NCE=13.141, CLS=12.008)
  Batch 630/1349: loss=16.5515 (NCE=14.194, CLS=11.789)
  Batch 640/1349: loss=15.2791 (NCE=12.997, CLS=11.411)
  Batch 650/1349: loss=15.3044 (NCE=13.083, CLS=11.108)
  Batch 660/1349: loss=15.7345 (NCE=13.448, CLS=11.430)
  Batch 670/1349: loss=15.6170 (NCE=13.322, CLS=11.473)
  Batch 680/1349: loss=15.3910 (NCE=13.117, CLS=11.372)
  Batch 690/1349: loss=16.3484 (NCE=14.020, CLS=11.643)
  Batch 700/1349: loss=16.3549 (NCE=13.806, CLS=12.743)
  Batch 710/1349: loss=15.9151 (NCE=13.581, CLS=11.669)
  Batch 720/1349: loss=16.0387 (NCE=13.678, CLS=11.803)
  Batch 730/1349: loss=15.8721 (NCE=13.583, CLS=11.446)
  Batch 740/1349: loss=16.2337 (NCE=13.762, CLS=12.360)
  Batch 750/1349: loss=16.9510 (NCE=14.433, CLS=12.588)
  Batch 760/1349: loss=16.7082 (NCE=14.190, CLS=12.591)
  Batch 770/1349: loss=16.4761 (NCE=13.950, CLS=12.630)
  Batch 780/1349: loss=16.2945 (NCE=13.818, CLS=12.383)
  Batch 790/1349: loss=15.4986 (NCE=13.139, CLS=11.799)
  Batch 800/1349: loss=16.2507 (NCE=13.685, CLS=12.830)
  Batch 810/1349: loss=16.1957 (NCE=13.792, CLS=12.020)
  Batch 820/1349: loss=16.9041 (NCE=14.323, CLS=12.904)
  Batch 830/1349: loss=15.6195 (NCE=13.434, CLS=10.927)
  Batch 840/1349: loss=17.5525 (NCE=14.983, CLS=12.847)
  Batch 850/1349: loss=16.0228 (NCE=13.651, CLS=11.857)
  Batch 860/1349: loss=15.4540 (NCE=13.159, CLS=11.474)
  Batch 870/1349: loss=16.4486 (NCE=13.937, CLS=12.556)
  Batch 880/1349: loss=15.7157 (NCE=13.412, CLS=11.519)
  Batch 890/1349: loss=16.4639 (NCE=14.047, CLS=12.086)
  Batch 900/1349: loss=15.9095 (NCE=13.512, CLS=11.986)
  Batch 910/1349: loss=16.8153 (NCE=14.298, CLS=12.587)
  Batch 920/1349: loss=15.9891 (NCE=13.606, CLS=11.914)
  Batch 930/1349: loss=16.4188 (NCE=14.050, CLS=11.845)
  Batch 940/1349: loss=16.1596 (NCE=13.767, CLS=11.965)
  Batch 950/1349: loss=17.4062 (NCE=14.827, CLS=12.897)
  Batch 960/1349: loss=15.7088 (NCE=13.374, CLS=11.674)
  Batch 970/1349: loss=16.6253 (NCE=14.162, CLS=12.318)
  Batch 980/1349: loss=16.0993 (NCE=13.730, CLS=11.845)
  Batch 990/1349: loss=16.7558 (NCE=14.283, CLS=12.365)
  Batch 1000/1349: loss=16.3935 (NCE=14.004, CLS=11.950)
  Batch 1010/1349: loss=15.8170 (NCE=13.282, CLS=12.673)
  Batch 1020/1349: loss=16.6010 (NCE=14.253, CLS=11.740)
  Batch 1030/1349: loss=16.4274 (NCE=14.039, CLS=11.942)
  Batch 1040/1349: loss=16.5714 (NCE=14.031, CLS=12.702)
  Batch 1050/1349: loss=15.1192 (NCE=12.780, CLS=11.698)
  Batch 1060/1349: loss=16.1481 (NCE=13.812, CLS=11.678)
  Batch 1070/1349: loss=16.5415 (NCE=14.144, CLS=11.990)
  Batch 1080/1349: loss=15.6619 (NCE=13.383, CLS=11.396)
  Batch 1090/1349: loss=16.2060 (NCE=13.798, CLS=12.039)
  Batch 1100/1349: loss=16.8171 (NCE=14.296, CLS=12.603)
  Batch 1110/1349: loss=15.9363 (NCE=13.393, CLS=12.716)
  Batch 1120/1349: loss=16.7371 (NCE=14.262, CLS=12.377)
  Batch 1130/1349: loss=15.9456 (NCE=13.668, CLS=11.388)
  Batch 1140/1349: loss=16.4145 (NCE=13.974, CLS=12.201)
  Batch 1150/1349: loss=15.4284 (NCE=13.048, CLS=11.900)
  Batch 1160/1349: loss=16.0759 (NCE=13.856, CLS=11.098)
  Batch 1170/1349: loss=16.2869 (NCE=13.813, CLS=12.370)
  Batch 1180/1349: loss=16.8123 (NCE=14.262, CLS=12.749)
  Batch 1190/1349: loss=15.9058 (NCE=13.671, CLS=11.176)
  Batch 1200/1349: loss=16.2048 (NCE=13.652, CLS=12.764)
  Batch 1210/1349: loss=16.8827 (NCE=14.445, CLS=12.190)
  Batch 1220/1349: loss=15.4437 (NCE=13.156, CLS=11.440)
  Batch 1230/1349: loss=16.6169 (NCE=14.172, CLS=12.226)
  Batch 1240/1349: loss=16.2875 (NCE=13.915, CLS=11.862)
  Batch 1250/1349: loss=17.1458 (NCE=14.676, CLS=12.351)
  Batch 1260/1349: loss=15.9097 (NCE=13.487, CLS=12.112)
  Batch 1270/1349: loss=15.4456 (NCE=13.130, CLS=11.577)
  Batch 1280/1349: loss=15.9258 (NCE=13.515, CLS=12.056)
  Batch 1290/1349: loss=16.6423 (NCE=14.167, CLS=12.378)
  Batch 1300/1349: loss=16.7136 (NCE=14.257, CLS=12.284)
  Batch 1310/1349: loss=15.8452 (NCE=13.460, CLS=11.924)
  Batch 1320/1349: loss=16.7396 (NCE=14.220, CLS=12.597)
  Batch 1330/1349: loss=17.4577 (NCE=15.016, CLS=12.209)
  Batch 1340/1349: loss=16.5663 (NCE=14.085, CLS=12.409)
  Train: loss=16.1893 (NCE=13.785, CLS=12.020)
  Acc: HV=0.174, HJ=0.232, LV=0.182, LJ=0.107
  Val: loss=13.7672, R@10_HV=0.010

Epoch 11/100
  Batch 10/1349: loss=15.6762 (NCE=13.334, CLS=11.709)
  Batch 20/1349: loss=16.1588 (NCE=13.756, CLS=12.015)
  Batch 30/1349: loss=16.8356 (NCE=14.366, CLS=12.347)
  Batch 40/1349: loss=16.1551 (NCE=13.855, CLS=11.498)
  Batch 50/1349: loss=15.8935 (NCE=13.498, CLS=11.975)
  Batch 60/1349: loss=15.6719 (NCE=13.396, CLS=11.378)
  Batch 70/1349: loss=16.8023 (NCE=14.330, CLS=12.361)
  Batch 80/1349: loss=15.9031 (NCE=13.551, CLS=11.763)
  Batch 90/1349: loss=16.2326 (NCE=13.723, CLS=12.548)
  Batch 100/1349: loss=15.9374 (NCE=13.440, CLS=12.489)
  Batch 110/1349: loss=16.1524 (NCE=13.670, CLS=12.413)
  Batch 120/1349: loss=16.3148 (NCE=14.029, CLS=11.431)
  Batch 130/1349: loss=16.3066 (NCE=13.826, CLS=12.405)
  Batch 140/1349: loss=15.7376 (NCE=13.387, CLS=11.752)
  Batch 150/1349: loss=15.9225 (NCE=13.648, CLS=11.371)
  Batch 160/1349: loss=16.3187 (NCE=13.934, CLS=11.922)
  Batch 170/1349: loss=15.8672 (NCE=13.608, CLS=11.297)
  Batch 180/1349: loss=15.6017 (NCE=13.288, CLS=11.567)
  Batch 190/1349: loss=15.9746 (NCE=13.514, CLS=12.301)
  Batch 200/1349: loss=15.5947 (NCE=13.220, CLS=11.876)
  Batch 210/1349: loss=16.7939 (NCE=14.381, CLS=12.066)
  Batch 220/1349: loss=15.5724 (NCE=13.215, CLS=11.787)
  Batch 230/1349: loss=15.9309 (NCE=13.733, CLS=10.990)
  Batch 240/1349: loss=15.9724 (NCE=13.461, CLS=12.558)
  Batch 250/1349: loss=16.8031 (NCE=14.312, CLS=12.455)
  Batch 260/1349: loss=16.1526 (NCE=13.438, CLS=13.573)
  Batch 270/1349: loss=15.9781 (NCE=13.695, CLS=11.414)
  Batch 280/1349: loss=15.9444 (NCE=13.458, CLS=12.432)
  Batch 290/1349: loss=16.2872 (NCE=13.904, CLS=11.914)
  Batch 300/1349: loss=16.3533 (NCE=14.095, CLS=11.294)
  Batch 310/1349: loss=15.7440 (NCE=13.390, CLS=11.768)
  Batch 320/1349: loss=16.2598 (NCE=13.802, CLS=12.288)
  Batch 330/1349: loss=15.7607 (NCE=13.347, CLS=12.069)
  Batch 340/1349: loss=15.9118 (NCE=13.653, CLS=11.293)
  Batch 350/1349: loss=16.7615 (NCE=14.301, CLS=12.303)
  Batch 360/1349: loss=16.7753 (NCE=14.300, CLS=12.378)
  Batch 370/1349: loss=16.6351 (NCE=14.079, CLS=12.783)
  Batch 380/1349: loss=16.2627 (NCE=13.770, CLS=12.464)
  Batch 390/1349: loss=15.3220 (NCE=13.020, CLS=11.509)
  Batch 400/1349: loss=16.1520 (NCE=13.877, CLS=11.375)
  Batch 410/1349: loss=16.2723 (NCE=13.958, CLS=11.573)
  Batch 420/1349: loss=16.5578 (NCE=14.217, CLS=11.704)
  Batch 430/1349: loss=15.6379 (NCE=13.300, CLS=11.691)
  Batch 440/1349: loss=16.1964 (NCE=13.852, CLS=11.721)
  Batch 450/1349: loss=16.1151 (NCE=13.669, CLS=12.231)
  Batch 460/1349: loss=15.5975 (NCE=13.394, CLS=11.019)
  Batch 470/1349: loss=16.0504 (NCE=13.550, CLS=12.501)
  Batch 480/1349: loss=16.2681 (NCE=13.736, CLS=12.662)
  Batch 490/1349: loss=16.3842 (NCE=13.882, CLS=12.513)
  Batch 500/1349: loss=17.0703 (NCE=14.589, CLS=12.407)
  Batch 510/1349: loss=16.8952 (NCE=14.418, CLS=12.386)
  Batch 520/1349: loss=16.9889 (NCE=14.458, CLS=12.654)
  Batch 530/1349: loss=15.6991 (NCE=13.474, CLS=11.124)
  Batch 540/1349: loss=15.6180 (NCE=13.440, CLS=10.890)
  Batch 550/1349: loss=16.3395 (NCE=13.937, CLS=12.014)
  Batch 560/1349: loss=16.2606 (NCE=13.873, CLS=11.939)
  Batch 570/1349: loss=15.6461 (NCE=13.263, CLS=11.917)
  Batch 580/1349: loss=15.9374 (NCE=13.665, CLS=11.360)
  Batch 590/1349: loss=15.8850 (NCE=13.578, CLS=11.535)
  Batch 600/1349: loss=16.0249 (NCE=13.847, CLS=10.888)
  Batch 610/1349: loss=15.7575 (NCE=13.373, CLS=11.921)
  Batch 620/1349: loss=16.5275 (NCE=14.089, CLS=12.192)
  Batch 630/1349: loss=16.8412 (NCE=14.406, CLS=12.174)
  Batch 640/1349: loss=16.4580 (NCE=14.012, CLS=12.230)
  Batch 650/1349: loss=16.1327 (NCE=13.727, CLS=12.029)
  Batch 660/1349: loss=16.0119 (NCE=13.607, CLS=12.026)
  Batch 670/1349: loss=15.2008 (NCE=12.980, CLS=11.105)
  Batch 680/1349: loss=15.7721 (NCE=13.300, CLS=12.360)
  Batch 690/1349: loss=16.4488 (NCE=13.851, CLS=12.991)
  Batch 700/1349: loss=15.8683 (NCE=13.478, CLS=11.950)
  Batch 710/1349: loss=16.5085 (NCE=14.072, CLS=12.182)
  Batch 720/1349: loss=16.3203 (NCE=13.983, CLS=11.687)
  Batch 730/1349: loss=16.3953 (NCE=14.037, CLS=11.791)
  Batch 740/1349: loss=15.8539 (NCE=13.504, CLS=11.752)
  Batch 750/1349: loss=15.7105 (NCE=13.461, CLS=11.247)
  Batch 760/1349: loss=16.1711 (NCE=13.748, CLS=12.113)
  Batch 770/1349: loss=15.8678 (NCE=13.472, CLS=11.981)
  Batch 780/1349: loss=16.5744 (NCE=13.854, CLS=13.604)
  Batch 790/1349: loss=16.8259 (NCE=14.498, CLS=11.642)
  Batch 800/1349: loss=16.3744 (NCE=14.028, CLS=11.731)
  Batch 810/1349: loss=16.8709 (NCE=14.383, CLS=12.439)
  Batch 820/1349: loss=16.1595 (NCE=13.817, CLS=11.710)
  Batch 830/1349: loss=17.0989 (NCE=14.546, CLS=12.764)
  Batch 840/1349: loss=16.0439 (NCE=13.654, CLS=11.948)
  Batch 850/1349: loss=16.9125 (NCE=14.524, CLS=11.943)
  Batch 860/1349: loss=15.2669 (NCE=12.959, CLS=11.540)
  Batch 870/1349: loss=16.4124 (NCE=14.157, CLS=11.276)
  Batch 880/1349: loss=16.1947 (NCE=13.764, CLS=12.153)
  Batch 890/1349: loss=16.7451 (NCE=14.332, CLS=12.066)
  Batch 900/1349: loss=15.8789 (NCE=13.538, CLS=11.705)
  Batch 910/1349: loss=15.7376 (NCE=13.454, CLS=11.418)
  Batch 920/1349: loss=16.4920 (NCE=13.823, CLS=13.347)
  Batch 930/1349: loss=16.3302 (NCE=13.982, CLS=11.741)
  Batch 940/1349: loss=15.6996 (NCE=13.371, CLS=11.642)
  Batch 950/1349: loss=16.0153 (NCE=13.753, CLS=11.311)
  Batch 960/1349: loss=16.4608 (NCE=13.935, CLS=12.628)
  Batch 970/1349: loss=16.6650 (NCE=14.202, CLS=12.316)
  Batch 980/1349: loss=16.0299 (NCE=13.656, CLS=11.868)
  Batch 990/1349: loss=16.3497 (NCE=13.968, CLS=11.909)
  Batch 1000/1349: loss=15.8576 (NCE=13.591, CLS=11.331)
  Batch 1010/1349: loss=16.0204 (NCE=13.687, CLS=11.668)
  Batch 1020/1349: loss=16.4523 (NCE=14.020, CLS=12.160)
  Batch 1030/1349: loss=15.9688 (NCE=13.580, CLS=11.943)
  Batch 1040/1349: loss=16.8718 (NCE=14.467, CLS=12.026)
  Batch 1050/1349: loss=15.4358 (NCE=12.863, CLS=12.864)
  Batch 1060/1349: loss=16.3421 (NCE=13.958, CLS=11.919)
  Batch 1070/1349: loss=16.4776 (NCE=14.077, CLS=12.004)
  Batch 1080/1349: loss=15.1699 (NCE=12.843, CLS=11.637)
  Batch 1090/1349: loss=15.7051 (NCE=13.361, CLS=11.722)
  Batch 1100/1349: loss=16.0875 (NCE=13.750, CLS=11.688)
  Batch 1110/1349: loss=16.0522 (NCE=13.737, CLS=11.574)
  Batch 1120/1349: loss=17.0707 (NCE=14.564, CLS=12.532)
  Batch 1130/1349: loss=16.9110 (NCE=14.451, CLS=12.300)
  Batch 1140/1349: loss=16.3229 (NCE=13.933, CLS=11.949)
  Batch 1150/1349: loss=16.3139 (NCE=14.053, CLS=11.303)
  Batch 1160/1349: loss=16.0357 (NCE=13.466, CLS=12.851)
  Batch 1170/1349: loss=15.3446 (NCE=13.110, CLS=11.172)
  Batch 1180/1349: loss=15.5615 (NCE=13.262, CLS=11.495)
  Batch 1190/1349: loss=15.7194 (NCE=13.258, CLS=12.308)
  Batch 1200/1349: loss=16.1233 (NCE=13.827, CLS=11.481)
  Batch 1210/1349: loss=17.0750 (NCE=14.625, CLS=12.249)
  Batch 1220/1349: loss=16.5059 (NCE=14.126, CLS=11.900)
  Batch 1230/1349: loss=15.5261 (NCE=13.134, CLS=11.961)
  Batch 1240/1349: loss=16.4574 (NCE=14.031, CLS=12.134)
  Batch 1250/1349: loss=15.9406 (NCE=13.579, CLS=11.808)
  Batch 1260/1349: loss=16.8454 (NCE=14.350, CLS=12.477)
  Batch 1270/1349: loss=16.3829 (NCE=13.958, CLS=12.126)
  Batch 1280/1349: loss=17.0817 (NCE=14.558, CLS=12.619)
  Batch 1290/1349: loss=15.3703 (NCE=13.205, CLS=10.824)
  Batch 1300/1349: loss=15.9096 (NCE=13.487, CLS=12.111)
  Batch 1310/1349: loss=15.5032 (NCE=13.150, CLS=11.766)
  Batch 1320/1349: loss=16.1853 (NCE=13.759, CLS=12.130)
  Batch 1330/1349: loss=16.2579 (NCE=13.833, CLS=12.123)
  Batch 1340/1349: loss=16.0184 (NCE=13.593, CLS=12.126)
  Train: loss=16.1572 (NCE=13.759, CLS=11.990)
  Acc: HV=0.175, HJ=0.232, LV=0.183, LJ=0.109
  Val: loss=13.7515, R@10_HV=0.012
  New best model! (loss=13.7515)

Epoch 12/100
  Batch 10/1349: loss=16.8692 (NCE=14.445, CLS=12.122)
  Batch 20/1349: loss=16.5798 (NCE=14.176, CLS=12.021)
  Batch 30/1349: loss=15.4700 (NCE=13.181, CLS=11.447)
  Batch 40/1349: loss=16.0257 (NCE=13.708, CLS=11.590)
  Batch 50/1349: loss=16.2064 (NCE=13.860, CLS=11.731)
  Batch 60/1349: loss=16.0878 (NCE=13.701, CLS=11.934)
  Batch 70/1349: loss=16.3770 (NCE=13.915, CLS=12.308)
  Batch 80/1349: loss=15.2725 (NCE=13.102, CLS=10.851)
  Batch 90/1349: loss=15.9423 (NCE=13.460, CLS=12.412)
  Batch 100/1349: loss=15.6810 (NCE=13.363, CLS=11.589)
  Batch 110/1349: loss=16.7221 (NCE=14.282, CLS=12.200)
  Batch 120/1349: loss=16.7086 (NCE=14.256, CLS=12.264)
  Batch 130/1349: loss=16.5089 (NCE=14.022, CLS=12.433)
  Batch 140/1349: loss=16.8181 (NCE=14.250, CLS=12.839)
  Batch 150/1349: loss=16.3546 (NCE=14.069, CLS=11.428)
  Batch 160/1349: loss=16.9157 (NCE=14.503, CLS=12.064)
  Batch 170/1349: loss=15.9621 (NCE=13.625, CLS=11.687)
  Batch 180/1349: loss=16.5891 (NCE=14.189, CLS=12.001)
  Batch 190/1349: loss=16.1899 (NCE=13.817, CLS=11.865)
  Batch 200/1349: loss=16.2094 (NCE=13.777, CLS=12.163)
  Batch 210/1349: loss=16.0926 (NCE=13.750, CLS=11.715)
  Batch 220/1349: loss=14.8562 (NCE=12.572, CLS=11.422)
  Batch 230/1349: loss=16.3588 (NCE=13.922, CLS=12.182)
  Batch 240/1349: loss=16.5507 (NCE=14.173, CLS=11.887)
  Batch 250/1349: loss=16.3003 (NCE=13.897, CLS=12.014)
  Batch 260/1349: loss=15.9104 (NCE=13.535, CLS=11.876)
  Batch 270/1349: loss=15.9134 (NCE=13.598, CLS=11.576)
  Batch 280/1349: loss=16.0632 (NCE=13.554, CLS=12.547)
  Batch 290/1349: loss=15.5302 (NCE=13.246, CLS=11.420)
  Batch 300/1349: loss=16.0710 (NCE=13.689, CLS=11.912)
  Batch 310/1349: loss=16.0092 (NCE=13.634, CLS=11.878)
  Batch 320/1349: loss=15.9163 (NCE=13.576, CLS=11.699)
  Batch 330/1349: loss=16.7690 (NCE=14.381, CLS=11.941)
  Batch 340/1349: loss=16.1130 (NCE=13.657, CLS=12.282)
  Batch 350/1349: loss=16.0507 (NCE=13.573, CLS=12.390)
  Batch 360/1349: loss=16.0520 (NCE=13.662, CLS=11.948)
  Batch 370/1349: loss=15.7228 (NCE=13.376, CLS=11.733)
  Batch 380/1349: loss=15.7747 (NCE=13.505, CLS=11.349)
  Batch 390/1349: loss=16.1621 (NCE=13.842, CLS=11.600)
  Batch 400/1349: loss=16.6466 (NCE=14.155, CLS=12.460)
  Batch 410/1349: loss=15.7603 (NCE=13.490, CLS=11.354)
  Batch 420/1349: loss=15.0648 (NCE=12.857, CLS=11.040)
  Batch 430/1349: loss=16.0872 (NCE=13.599, CLS=12.439)
  Batch 440/1349: loss=15.9394 (NCE=13.526, CLS=12.067)
  Batch 450/1349: loss=15.6454 (NCE=13.316, CLS=11.648)
  Batch 460/1349: loss=15.9370 (NCE=13.691, CLS=11.230)
  Batch 470/1349: loss=14.8562 (NCE=12.393, CLS=12.319)
  Batch 480/1349: loss=15.8004 (NCE=13.334, CLS=12.334)
  Batch 490/1349: loss=15.8542 (NCE=13.522, CLS=11.662)
  Batch 500/1349: loss=16.3662 (NCE=13.930, CLS=12.183)
  Batch 510/1349: loss=15.5875 (NCE=13.273, CLS=11.573)
  Batch 520/1349: loss=17.0146 (NCE=14.332, CLS=13.414)
  Batch 530/1349: loss=16.0852 (NCE=13.720, CLS=11.828)
  Batch 540/1349: loss=17.3979 (NCE=14.870, CLS=12.641)
  Batch 550/1349: loss=16.7036 (NCE=14.190, CLS=12.566)
  Batch 560/1349: loss=14.8785 (NCE=12.697, CLS=10.906)
  Batch 570/1349: loss=16.0825 (NCE=13.688, CLS=11.971)
  Batch 580/1349: loss=15.8840 (NCE=13.497, CLS=11.937)
  Batch 590/1349: loss=16.6142 (NCE=14.138, CLS=12.381)
  Batch 600/1349: loss=16.3343 (NCE=14.051, CLS=11.417)
  Batch 610/1349: loss=16.9415 (NCE=14.313, CLS=13.143)
  Batch 620/1349: loss=16.1702 (NCE=13.615, CLS=12.775)
  Batch 630/1349: loss=15.9680 (NCE=13.746, CLS=11.108)
  Batch 640/1349: loss=16.4141 (NCE=13.937, CLS=12.386)
  Batch 650/1349: loss=15.4118 (NCE=13.133, CLS=11.392)
  Batch 660/1349: loss=16.2718 (NCE=13.879, CLS=11.962)
  Batch 670/1349: loss=15.6339 (NCE=13.220, CLS=12.071)
  Batch 680/1349: loss=15.5742 (NCE=13.138, CLS=12.183)
  Batch 690/1349: loss=16.5027 (NCE=14.127, CLS=11.879)
  Batch 700/1349: loss=15.6777 (NCE=13.408, CLS=11.350)
  Batch 710/1349: loss=15.9609 (NCE=13.549, CLS=12.058)
  Batch 720/1349: loss=16.0478 (NCE=13.579, CLS=12.343)
  Batch 730/1349: loss=16.6576 (NCE=14.292, CLS=11.830)
  Batch 740/1349: loss=15.8450 (NCE=13.460, CLS=11.924)
  Batch 750/1349: loss=16.4479 (NCE=13.988, CLS=12.300)
  Batch 760/1349: loss=16.4759 (NCE=14.055, CLS=12.102)
  Batch 770/1349: loss=16.7615 (NCE=14.329, CLS=12.164)
  Batch 780/1349: loss=15.7506 (NCE=13.381, CLS=11.848)
  Batch 790/1349: loss=16.4333 (NCE=13.987, CLS=12.229)
  Batch 800/1349: loss=15.2738 (NCE=13.002, CLS=11.362)
  Batch 810/1349: loss=16.1915 (NCE=13.950, CLS=11.205)
  Batch 820/1349: loss=16.4164 (NCE=14.027, CLS=11.949)
  Batch 830/1349: loss=16.5104 (NCE=14.062, CLS=12.242)
  Batch 840/1349: loss=16.2335 (NCE=13.809, CLS=12.120)
  Batch 850/1349: loss=16.1312 (NCE=13.789, CLS=11.711)
  Batch 860/1349: loss=16.2345 (NCE=13.877, CLS=11.786)
  Batch 870/1349: loss=15.9854 (NCE=13.686, CLS=11.496)
  Batch 880/1349: loss=16.9498 (NCE=14.581, CLS=11.844)
  Batch 890/1349: loss=16.1001 (NCE=13.746, CLS=11.769)
  Batch 900/1349: loss=15.9740 (NCE=13.643, CLS=11.654)
  Batch 910/1349: loss=15.9802 (NCE=13.698, CLS=11.410)
  Batch 920/1349: loss=16.2098 (NCE=13.674, CLS=12.681)
  Batch 930/1349: loss=16.2612 (NCE=13.723, CLS=12.692)
  Batch 940/1349: loss=15.4793 (NCE=13.187, CLS=11.462)
  Batch 950/1349: loss=15.8680 (NCE=13.348, CLS=12.598)
  Batch 960/1349: loss=16.3391 (NCE=13.870, CLS=12.345)
  Batch 970/1349: loss=16.0577 (NCE=13.716, CLS=11.711)
  Batch 980/1349: loss=15.5526 (NCE=13.124, CLS=12.145)
  Batch 990/1349: loss=16.9390 (NCE=14.519, CLS=12.098)
  Batch 1000/1349: loss=15.4540 (NCE=13.023, CLS=12.153)
  Batch 1010/1349: loss=16.4822 (NCE=13.866, CLS=13.082)
  Batch 1020/1349: loss=17.1886 (NCE=14.675, CLS=12.566)
  Batch 1030/1349: loss=15.9970 (NCE=13.689, CLS=11.542)
  Batch 1040/1349: loss=15.6196 (NCE=13.418, CLS=11.006)
  Batch 1050/1349: loss=16.3630 (NCE=13.774, CLS=12.947)
  Batch 1060/1349: loss=15.9038 (NCE=13.478, CLS=12.128)
  Batch 1070/1349: loss=15.8752 (NCE=13.512, CLS=11.816)
  Batch 1080/1349: loss=16.4737 (NCE=14.097, CLS=11.884)
  Batch 1090/1349: loss=16.2185 (NCE=13.816, CLS=12.012)
  Batch 1100/1349: loss=16.1191 (NCE=13.627, CLS=12.461)
  Batch 1110/1349: loss=15.7770 (NCE=13.463, CLS=11.570)
  Batch 1120/1349: loss=16.0631 (NCE=13.531, CLS=12.662)
  Batch 1130/1349: loss=15.9975 (NCE=13.689, CLS=11.543)
  Batch 1140/1349: loss=15.5983 (NCE=13.158, CLS=12.201)
  Batch 1150/1349: loss=16.7566 (NCE=14.253, CLS=12.520)
  Batch 1160/1349: loss=16.0736 (NCE=13.625, CLS=12.241)
  Batch 1170/1349: loss=16.5695 (NCE=13.907, CLS=13.314)
  Batch 1180/1349: loss=15.8512 (NCE=13.559, CLS=11.462)
  Batch 1190/1349: loss=15.9039 (NCE=13.661, CLS=11.215)
  Batch 1200/1349: loss=16.6782 (NCE=14.004, CLS=13.372)
  Batch 1210/1349: loss=15.7768 (NCE=13.243, CLS=12.669)
  Batch 1220/1349: loss=17.1345 (NCE=14.654, CLS=12.404)
  Batch 1230/1349: loss=16.5589 (NCE=13.936, CLS=13.113)
  Batch 1240/1349: loss=16.9287 (NCE=14.457, CLS=12.360)
  Batch 1250/1349: loss=16.5252 (NCE=14.125, CLS=12.002)
  Batch 1260/1349: loss=16.0576 (NCE=13.722, CLS=11.677)
  Batch 1270/1349: loss=16.3480 (NCE=13.953, CLS=11.973)
  Batch 1280/1349: loss=16.5779 (NCE=14.213, CLS=11.825)
  Batch 1290/1349: loss=15.0140 (NCE=12.791, CLS=11.115)
  Batch 1300/1349: loss=16.9110 (NCE=14.347, CLS=12.819)
  Batch 1310/1349: loss=16.0414 (NCE=13.542, CLS=12.499)
  Batch 1320/1349: loss=15.7686 (NCE=13.396, CLS=11.865)
  Batch 1330/1349: loss=16.5898 (NCE=14.243, CLS=11.737)
  Batch 1340/1349: loss=15.8763 (NCE=13.501, CLS=11.876)
  Train: loss=16.1258 (NCE=13.733, CLS=11.965)
  Acc: HV=0.174, HJ=0.232, LV=0.186, LJ=0.112
  Val: loss=13.7726, R@10_HV=0.010

Epoch 13/100
  Batch 10/1349: loss=16.2310 (NCE=13.796, CLS=12.173)
  Batch 20/1349: loss=16.1812 (NCE=13.756, CLS=12.124)
  Batch 30/1349: loss=15.9741 (NCE=13.505, CLS=12.343)
  Batch 40/1349: loss=16.0902 (NCE=13.786, CLS=11.522)
  Batch 50/1349: loss=16.0342 (NCE=13.605, CLS=12.144)
  Batch 60/1349: loss=17.0555 (NCE=14.681, CLS=11.873)
  Batch 70/1349: loss=15.9257 (NCE=13.613, CLS=11.562)
  Batch 80/1349: loss=16.8470 (NCE=14.318, CLS=12.644)
  Batch 90/1349: loss=17.0397 (NCE=14.587, CLS=12.261)
  Batch 100/1349: loss=16.3011 (NCE=14.022, CLS=11.396)
  Batch 110/1349: loss=15.8997 (NCE=13.514, CLS=11.928)
  Batch 120/1349: loss=16.1157 (NCE=13.643, CLS=12.362)
  Batch 130/1349: loss=16.5848 (NCE=14.093, CLS=12.457)
  Batch 140/1349: loss=16.6050 (NCE=14.103, CLS=12.510)
  Batch 150/1349: loss=15.8368 (NCE=13.503, CLS=11.668)
  Batch 160/1349: loss=15.8829 (NCE=13.618, CLS=11.326)
  Batch 170/1349: loss=16.2880 (NCE=13.955, CLS=11.667)
  Batch 180/1349: loss=15.1919 (NCE=12.947, CLS=11.225)
  Batch 190/1349: loss=16.1935 (NCE=13.843, CLS=11.753)
  Batch 200/1349: loss=16.7191 (NCE=14.258, CLS=12.303)
  Batch 210/1349: loss=16.1841 (NCE=13.885, CLS=11.495)
  Batch 220/1349: loss=16.2263 (NCE=13.676, CLS=12.752)
  Batch 230/1349: loss=16.6598 (NCE=14.204, CLS=12.278)
  Batch 240/1349: loss=15.6962 (NCE=13.323, CLS=11.867)
  Batch 250/1349: loss=16.1686 (NCE=13.789, CLS=11.900)
  Batch 260/1349: loss=15.6343 (NCE=13.198, CLS=12.181)
  Batch 270/1349: loss=16.7689 (NCE=14.305, CLS=12.322)
  Batch 280/1349: loss=15.6237 (NCE=13.354, CLS=11.348)
  Batch 290/1349: loss=15.4389 (NCE=13.084, CLS=11.775)
  Batch 300/1349: loss=15.7008 (NCE=13.370, CLS=11.654)
  Batch 310/1349: loss=16.2639 (NCE=13.787, CLS=12.386)
  Batch 320/1349: loss=15.9983 (NCE=13.616, CLS=11.911)
  Batch 330/1349: loss=16.5979 (NCE=14.129, CLS=12.347)
  Batch 340/1349: loss=16.1631 (NCE=13.810, CLS=11.767)
  Batch 350/1349: loss=14.9822 (NCE=12.714, CLS=11.342)
  Batch 360/1349: loss=15.6619 (NCE=13.294, CLS=11.838)
  Batch 370/1349: loss=15.9415 (NCE=13.506, CLS=12.176)
  Batch 380/1349: loss=15.7222 (NCE=13.512, CLS=11.050)
  Batch 390/1349: loss=16.1221 (NCE=13.738, CLS=11.919)
  Batch 400/1349: loss=15.8042 (NCE=13.477, CLS=11.636)
  Batch 410/1349: loss=16.1447 (NCE=13.774, CLS=11.852)
  Batch 420/1349: loss=16.0178 (NCE=13.675, CLS=11.713)
  Batch 430/1349: loss=15.9642 (NCE=13.674, CLS=11.450)
  Batch 440/1349: loss=16.1651 (NCE=13.792, CLS=11.865)
  Batch 450/1349: loss=16.2229 (NCE=13.762, CLS=12.303)
  Batch 460/1349: loss=17.1081 (NCE=14.587, CLS=12.604)
  Batch 470/1349: loss=16.5941 (NCE=14.225, CLS=11.846)
  Batch 480/1349: loss=15.8924 (NCE=13.523, CLS=11.846)
  Batch 490/1349: loss=15.7557 (NCE=13.506, CLS=11.250)
  Batch 500/1349: loss=16.3713 (NCE=14.002, CLS=11.844)
  Batch 510/1349: loss=15.9386 (NCE=13.668, CLS=11.355)
  Batch 520/1349: loss=16.8539 (NCE=14.299, CLS=12.774)
  Batch 530/1349: loss=14.9809 (NCE=12.734, CLS=11.236)
  Batch 540/1349: loss=16.3191 (NCE=13.903, CLS=12.080)
  Batch 550/1349: loss=16.6444 (NCE=14.245, CLS=11.998)
  Batch 560/1349: loss=15.8664 (NCE=13.542, CLS=11.623)
  Batch 570/1349: loss=15.9232 (NCE=13.543, CLS=11.901)
  Batch 580/1349: loss=15.7772 (NCE=13.553, CLS=11.122)
  Batch 590/1349: loss=15.7067 (NCE=13.327, CLS=11.900)
  Batch 600/1349: loss=16.4043 (NCE=13.906, CLS=12.493)
  Batch 610/1349: loss=16.1089 (NCE=13.671, CLS=12.190)
  Batch 620/1349: loss=15.9514 (NCE=13.674, CLS=11.387)
  Batch 630/1349: loss=16.4401 (NCE=13.883, CLS=12.788)
  Batch 640/1349: loss=16.3114 (NCE=13.836, CLS=12.378)
  Batch 650/1349: loss=16.2617 (NCE=13.699, CLS=12.812)
  Batch 660/1349: loss=16.6745 (NCE=13.947, CLS=13.636)
  Batch 670/1349: loss=16.5757 (NCE=14.191, CLS=11.921)
  Batch 680/1349: loss=15.9728 (NCE=13.679, CLS=11.468)
  Batch 690/1349: loss=16.0679 (NCE=13.691, CLS=11.882)
  Batch 700/1349: loss=16.2448 (NCE=13.884, CLS=11.806)
  Batch 710/1349: loss=16.4090 (NCE=13.891, CLS=12.589)
  Batch 720/1349: loss=17.2414 (NCE=14.724, CLS=12.588)
  Batch 730/1349: loss=16.4506 (NCE=14.036, CLS=12.074)
  Batch 740/1349: loss=16.0746 (NCE=13.694, CLS=11.903)
  Batch 750/1349: loss=16.4885 (NCE=14.025, CLS=12.315)
  Batch 760/1349: loss=16.0370 (NCE=13.717, CLS=11.602)
  Batch 770/1349: loss=15.2061 (NCE=12.921, CLS=11.424)
  Batch 780/1349: loss=16.2692 (NCE=13.861, CLS=12.039)
  Batch 790/1349: loss=16.3860 (NCE=13.979, CLS=12.037)
  Batch 800/1349: loss=16.5993 (NCE=14.139, CLS=12.303)
  Batch 810/1349: loss=15.6584 (NCE=13.368, CLS=11.454)
  Batch 820/1349: loss=16.2801 (NCE=13.808, CLS=12.363)
  Batch 830/1349: loss=15.9012 (NCE=13.593, CLS=11.541)
  Batch 840/1349: loss=16.0082 (NCE=13.729, CLS=11.397)
  Batch 850/1349: loss=15.6822 (NCE=13.267, CLS=12.077)
  Batch 860/1349: loss=15.7865 (NCE=13.356, CLS=12.151)
  Batch 870/1349: loss=16.0917 (NCE=13.624, CLS=12.338)
  Batch 880/1349: loss=16.0387 (NCE=13.768, CLS=11.352)
  Batch 890/1349: loss=14.6438 (NCE=12.159, CLS=12.423)
  Batch 900/1349: loss=16.8995 (NCE=14.422, CLS=12.387)
  Batch 910/1349: loss=16.1338 (NCE=13.851, CLS=11.412)
  Batch 920/1349: loss=16.6024 (NCE=14.233, CLS=11.849)
  Batch 930/1349: loss=16.6438 (NCE=14.155, CLS=12.444)
  Batch 940/1349: loss=15.6056 (NCE=13.305, CLS=11.504)
  Batch 950/1349: loss=16.6938 (NCE=14.307, CLS=11.934)
  Batch 960/1349: loss=16.9342 (NCE=14.512, CLS=12.110)
  Batch 970/1349: loss=14.7817 (NCE=12.507, CLS=11.374)
  Batch 980/1349: loss=16.5207 (NCE=14.053, CLS=12.336)
  Batch 990/1349: loss=15.1317 (NCE=12.861, CLS=11.355)
  Batch 1000/1349: loss=16.0155 (NCE=13.538, CLS=12.387)
  Batch 1010/1349: loss=16.0501 (NCE=13.633, CLS=12.088)
  Batch 1020/1349: loss=16.9729 (NCE=14.547, CLS=12.130)
  Batch 1030/1349: loss=16.0530 (NCE=13.805, CLS=11.240)
  Batch 1040/1349: loss=16.2908 (NCE=13.935, CLS=11.779)
  Batch 1050/1349: loss=16.8556 (NCE=14.407, CLS=12.245)
  Batch 1060/1349: loss=16.2578 (NCE=13.908, CLS=11.749)
  Batch 1070/1349: loss=16.0428 (NCE=13.641, CLS=12.011)
  Batch 1080/1349: loss=16.4408 (NCE=14.071, CLS=11.851)
  Batch 1090/1349: loss=15.7040 (NCE=13.160, CLS=12.719)
  Batch 1100/1349: loss=16.4861 (NCE=14.058, CLS=12.141)
  Batch 1110/1349: loss=16.6102 (NCE=14.062, CLS=12.742)
  Batch 1120/1349: loss=16.2193 (NCE=13.902, CLS=11.586)
  Batch 1130/1349: loss=17.5277 (NCE=15.004, CLS=12.619)
  Batch 1140/1349: loss=16.5999 (NCE=14.159, CLS=12.205)
  Batch 1150/1349: loss=16.4665 (NCE=14.245, CLS=11.106)
  Batch 1160/1349: loss=16.2525 (NCE=13.824, CLS=12.140)
  Batch 1170/1349: loss=16.7728 (NCE=14.225, CLS=12.740)
  Batch 1180/1349: loss=15.9046 (NCE=13.617, CLS=11.440)
  Batch 1190/1349: loss=15.9096 (NCE=13.565, CLS=11.723)
  Batch 1200/1349: loss=16.9375 (NCE=14.492, CLS=12.229)
  Batch 1210/1349: loss=16.5726 (NCE=14.032, CLS=12.702)
  Batch 1220/1349: loss=15.8424 (NCE=13.540, CLS=11.513)
  Batch 1230/1349: loss=15.5840 (NCE=12.916, CLS=13.342)
  Batch 1240/1349: loss=15.6954 (NCE=13.353, CLS=11.713)
  Batch 1250/1349: loss=16.3813 (NCE=13.930, CLS=12.259)
  Batch 1260/1349: loss=16.5750 (NCE=14.261, CLS=11.572)
  Batch 1270/1349: loss=15.9002 (NCE=13.633, CLS=11.335)
  Batch 1280/1349: loss=16.4818 (NCE=14.070, CLS=12.060)
  Batch 1290/1349: loss=15.6805 (NCE=13.215, CLS=12.327)
  Batch 1300/1349: loss=16.3864 (NCE=13.806, CLS=12.902)
  Batch 1310/1349: loss=16.3582 (NCE=14.030, CLS=11.643)
  Batch 1320/1349: loss=16.5266 (NCE=13.975, CLS=12.756)
  Batch 1330/1349: loss=16.0645 (NCE=13.659, CLS=12.028)
  Batch 1340/1349: loss=16.8281 (NCE=14.435, CLS=11.966)
  Train: loss=16.1016 (NCE=13.714, CLS=11.938)
  Acc: HV=0.176, HJ=0.234, LV=0.186, LJ=0.114
  Val: loss=13.7538, R@10_HV=0.011

Epoch 14/100
  Batch 10/1349: loss=15.8045 (NCE=13.480, CLS=11.622)
  Batch 20/1349: loss=15.6000 (NCE=13.177, CLS=12.116)
  Batch 30/1349: loss=16.4320 (NCE=13.929, CLS=12.517)
  Batch 40/1349: loss=16.0843 (NCE=13.708, CLS=11.881)
  Batch 50/1349: loss=16.5201 (NCE=14.112, CLS=12.043)
  Batch 60/1349: loss=15.9789 (NCE=13.645, CLS=11.671)
  Batch 70/1349: loss=16.0162 (NCE=13.697, CLS=11.595)
  Batch 80/1349: loss=15.7062 (NCE=13.406, CLS=11.502)
  Batch 90/1349: loss=16.6408 (NCE=14.289, CLS=11.760)
  Batch 100/1349: loss=16.6724 (NCE=14.163, CLS=12.546)
  Batch 110/1349: loss=14.7886 (NCE=12.426, CLS=11.811)
  Batch 120/1349: loss=16.6456 (NCE=14.140, CLS=12.529)
  Batch 130/1349: loss=16.0597 (NCE=13.829, CLS=11.152)
  Batch 140/1349: loss=16.8195 (NCE=14.380, CLS=12.199)
  Batch 150/1349: loss=16.1621 (NCE=13.810, CLS=11.760)
  Batch 160/1349: loss=16.4914 (NCE=13.953, CLS=12.692)
  Batch 170/1349: loss=16.5512 (NCE=14.153, CLS=11.990)
  Batch 180/1349: loss=16.2649 (NCE=13.959, CLS=11.530)
  Batch 190/1349: loss=16.7674 (NCE=14.226, CLS=12.708)
  Batch 200/1349: loss=14.4082 (NCE=12.255, CLS=10.765)
  Batch 210/1349: loss=16.2046 (NCE=13.771, CLS=12.167)
  Batch 220/1349: loss=16.4546 (NCE=14.093, CLS=11.809)
  Batch 230/1349: loss=16.0642 (NCE=13.626, CLS=12.192)
  Batch 240/1349: loss=16.1300 (NCE=13.694, CLS=12.181)
  Batch 250/1349: loss=16.6837 (NCE=14.210, CLS=12.368)
  Batch 260/1349: loss=15.6644 (NCE=13.311, CLS=11.767)
  Batch 270/1349: loss=15.4949 (NCE=13.261, CLS=11.170)
  Batch 280/1349: loss=17.3808 (NCE=14.834, CLS=12.733)
  Batch 290/1349: loss=16.1207 (NCE=13.876, CLS=11.225)
  Batch 300/1349: loss=16.4371 (NCE=13.999, CLS=12.188)
  Batch 310/1349: loss=15.8003 (NCE=13.460, CLS=11.703)
  Batch 320/1349: loss=15.4480 (NCE=13.149, CLS=11.493)
  Batch 330/1349: loss=15.9818 (NCE=13.554, CLS=12.138)
  Batch 340/1349: loss=15.7991 (NCE=13.455, CLS=11.721)
  Batch 350/1349: loss=16.8177 (NCE=14.336, CLS=12.410)
  Batch 360/1349: loss=16.2551 (NCE=13.895, CLS=11.800)
  Batch 370/1349: loss=15.9658 (NCE=13.628, CLS=11.690)
  Batch 380/1349: loss=16.3138 (NCE=13.940, CLS=11.869)
  Batch 390/1349: loss=16.2404 (NCE=13.868, CLS=11.862)
  Batch 400/1349: loss=16.0328 (NCE=13.623, CLS=12.047)
  Batch 410/1349: loss=15.6373 (NCE=13.125, CLS=12.563)
  Batch 420/1349: loss=16.2208 (NCE=13.860, CLS=11.805)
  Batch 430/1349: loss=15.1595 (NCE=12.906, CLS=11.266)
  Batch 440/1349: loss=16.2872 (NCE=13.871, CLS=12.080)
  Batch 450/1349: loss=16.3265 (NCE=14.024, CLS=11.512)
  Batch 460/1349: loss=16.2046 (NCE=13.808, CLS=11.981)
  Batch 470/1349: loss=16.1203 (NCE=13.735, CLS=11.925)
  Batch 480/1349: loss=16.2003 (NCE=13.769, CLS=12.155)
  Batch 490/1349: loss=16.6152 (NCE=14.285, CLS=11.653)
  Batch 500/1349: loss=14.6892 (NCE=12.485, CLS=11.021)
  Batch 510/1349: loss=16.2331 (NCE=13.912, CLS=11.608)
  Batch 520/1349: loss=15.4466 (NCE=13.257, CLS=10.950)
  Batch 530/1349: loss=15.7852 (NCE=13.514, CLS=11.358)
  Batch 540/1349: loss=15.9840 (NCE=13.558, CLS=12.129)
  Batch 550/1349: loss=16.4077 (NCE=13.947, CLS=12.303)
  Batch 560/1349: loss=16.5125 (NCE=14.066, CLS=12.234)
  Batch 570/1349: loss=15.5906 (NCE=13.288, CLS=11.515)
  Batch 580/1349: loss=16.4525 (NCE=14.027, CLS=12.129)
  Batch 590/1349: loss=16.2786 (NCE=13.826, CLS=12.262)
  Batch 600/1349: loss=15.5060 (NCE=13.413, CLS=10.464)
  Batch 610/1349: loss=16.2239 (NCE=13.912, CLS=11.559)
  Batch 620/1349: loss=16.0552 (NCE=13.672, CLS=11.916)
  Batch 630/1349: loss=16.1940 (NCE=13.717, CLS=12.384)
  Batch 640/1349: loss=17.2968 (NCE=14.837, CLS=12.297)
  Batch 650/1349: loss=15.6812 (NCE=13.311, CLS=11.849)
  Batch 660/1349: loss=16.2855 (NCE=13.837, CLS=12.244)
  Batch 670/1349: loss=15.3512 (NCE=13.041, CLS=11.551)
  Batch 680/1349: loss=15.6599 (NCE=13.332, CLS=11.642)
  Batch 690/1349: loss=17.0767 (NCE=14.628, CLS=12.243)
  Batch 700/1349: loss=14.9063 (NCE=12.719, CLS=10.935)
  Batch 710/1349: loss=15.8248 (NCE=13.481, CLS=11.717)
  Batch 720/1349: loss=15.4148 (NCE=13.074, CLS=11.702)
  Batch 730/1349: loss=15.8743 (NCE=13.507, CLS=11.834)
  Batch 740/1349: loss=16.2540 (NCE=13.738, CLS=12.582)
  Batch 750/1349: loss=15.8774 (NCE=13.593, CLS=11.422)
  Batch 760/1349: loss=16.9788 (NCE=14.518, CLS=12.306)
  Batch 770/1349: loss=15.4105 (NCE=13.174, CLS=11.181)
  Batch 780/1349: loss=16.2924 (NCE=13.873, CLS=12.096)
  Batch 790/1349: loss=15.6983 (NCE=13.489, CLS=11.045)
  Batch 800/1349: loss=15.5055 (NCE=13.268, CLS=11.186)
  Batch 810/1349: loss=15.6031 (NCE=13.144, CLS=12.298)
  Batch 820/1349: loss=16.2637 (NCE=13.782, CLS=12.407)
  Batch 830/1349: loss=16.7964 (NCE=14.371, CLS=12.125)
  Batch 840/1349: loss=15.7958 (NCE=13.340, CLS=12.280)
  Batch 850/1349: loss=16.2724 (NCE=13.923, CLS=11.748)
  Batch 860/1349: loss=15.2269 (NCE=13.003, CLS=11.121)
  Batch 870/1349: loss=16.1727 (NCE=13.858, CLS=11.574)
  Batch 880/1349: loss=15.7478 (NCE=13.349, CLS=11.996)
  Batch 890/1349: loss=15.3358 (NCE=12.974, CLS=11.809)
  Batch 900/1349: loss=16.0155 (NCE=13.614, CLS=12.010)
  Batch 910/1349: loss=16.1733 (NCE=13.846, CLS=11.639)
  Batch 920/1349: loss=15.9926 (NCE=13.510, CLS=12.412)
  Batch 930/1349: loss=15.8983 (NCE=13.679, CLS=11.099)
  Batch 940/1349: loss=15.6059 (NCE=13.293, CLS=11.565)
  Batch 950/1349: loss=16.2117 (NCE=13.813, CLS=11.993)
  Batch 960/1349: loss=16.3253 (NCE=13.973, CLS=11.764)
  Batch 970/1349: loss=16.1554 (NCE=13.793, CLS=11.814)
  Batch 980/1349: loss=16.7453 (NCE=14.402, CLS=11.718)
  Batch 990/1349: loss=15.0164 (NCE=12.683, CLS=11.666)
  Batch 1000/1349: loss=16.3532 (NCE=13.949, CLS=12.019)
  Batch 1010/1349: loss=16.9110 (NCE=14.451, CLS=12.299)
  Batch 1020/1349: loss=16.8165 (NCE=14.293, CLS=12.619)
  Batch 1030/1349: loss=15.7959 (NCE=13.461, CLS=11.674)
  Batch 1040/1349: loss=16.3082 (NCE=13.915, CLS=11.965)
  Batch 1050/1349: loss=16.0270 (NCE=13.650, CLS=11.884)
  Batch 1060/1349: loss=16.3504 (NCE=13.850, CLS=12.504)
  Batch 1070/1349: loss=16.3638 (NCE=13.905, CLS=12.295)
  Batch 1080/1349: loss=16.3422 (NCE=13.923, CLS=12.095)
  Batch 1090/1349: loss=16.2976 (NCE=13.915, CLS=11.914)
  Batch 1100/1349: loss=16.1477 (NCE=13.798, CLS=11.748)
  Batch 1110/1349: loss=16.3205 (NCE=13.748, CLS=12.860)
  Batch 1120/1349: loss=15.9177 (NCE=13.554, CLS=11.817)
  Batch 1130/1349: loss=15.3575 (NCE=13.037, CLS=11.603)
  Batch 1140/1349: loss=15.3401 (NCE=13.096, CLS=11.221)
  Batch 1150/1349: loss=15.6037 (NCE=13.258, CLS=11.728)
  Batch 1160/1349: loss=15.8916 (NCE=13.549, CLS=11.711)
  Batch 1170/1349: loss=16.3992 (NCE=13.870, CLS=12.645)
  Batch 1180/1349: loss=16.3723 (NCE=13.962, CLS=12.050)
  Batch 1190/1349: loss=15.9241 (NCE=13.599, CLS=11.625)
  Batch 1200/1349: loss=15.7440 (NCE=13.228, CLS=12.580)
  Batch 1210/1349: loss=16.3040 (NCE=13.855, CLS=12.247)
  Batch 1220/1349: loss=16.6104 (NCE=14.145, CLS=12.327)
  Batch 1230/1349: loss=16.5093 (NCE=14.123, CLS=11.931)
  Batch 1240/1349: loss=15.8356 (NCE=13.387, CLS=12.243)
  Batch 1250/1349: loss=15.6193 (NCE=13.228, CLS=11.955)
  Batch 1260/1349: loss=15.5949 (NCE=13.306, CLS=11.443)
  Batch 1270/1349: loss=15.7189 (NCE=13.247, CLS=12.361)
  Batch 1280/1349: loss=16.9152 (NCE=14.537, CLS=11.892)
  Batch 1290/1349: loss=16.4789 (NCE=14.008, CLS=12.354)
  Batch 1300/1349: loss=15.9519 (NCE=13.592, CLS=11.801)
  Batch 1310/1349: loss=16.4577 (NCE=13.907, CLS=12.751)
  Batch 1320/1349: loss=16.0705 (NCE=13.612, CLS=12.295)
  Batch 1330/1349: loss=15.8391 (NCE=13.572, CLS=11.334)
  Batch 1340/1349: loss=15.9481 (NCE=13.526, CLS=12.112)
  Train: loss=16.0759 (NCE=13.693, CLS=11.915)
  Acc: HV=0.177, HJ=0.234, LV=0.188, LJ=0.114
  Val: loss=13.7678, R@10_HV=0.011

Epoch 15/100
  Batch 10/1349: loss=15.8381 (NCE=13.591, CLS=11.236)
  Batch 20/1349: loss=17.1966 (NCE=14.612, CLS=12.922)
  Batch 30/1349: loss=17.2218 (NCE=14.754, CLS=12.337)
  Batch 40/1349: loss=16.5735 (NCE=14.207, CLS=11.833)
  Batch 50/1349: loss=15.7120 (NCE=13.407, CLS=11.526)
  Batch 60/1349: loss=16.4859 (NCE=14.164, CLS=11.610)
  Batch 70/1349: loss=16.4367 (NCE=14.091, CLS=11.731)
  Batch 80/1349: loss=14.6518 (NCE=12.367, CLS=11.426)
  Batch 90/1349: loss=15.3877 (NCE=13.211, CLS=10.882)
  Batch 100/1349: loss=16.3329 (NCE=13.927, CLS=12.027)
  Batch 110/1349: loss=16.5502 (NCE=13.948, CLS=13.013)
  Batch 120/1349: loss=16.3265 (NCE=13.922, CLS=12.022)
  Batch 130/1349: loss=16.4820 (NCE=14.071, CLS=12.053)
  Batch 140/1349: loss=15.7949 (NCE=13.383, CLS=12.058)
  Batch 150/1349: loss=16.7180 (NCE=14.280, CLS=12.191)
  Batch 160/1349: loss=16.4761 (NCE=14.115, CLS=11.807)
  Batch 170/1349: loss=16.0952 (NCE=13.658, CLS=12.184)
  Batch 180/1349: loss=16.5234 (NCE=13.971, CLS=12.761)
  Batch 190/1349: loss=16.5695 (NCE=14.137, CLS=12.161)
  Batch 200/1349: loss=16.3961 (NCE=13.973, CLS=12.118)
  Batch 210/1349: loss=15.9309 (NCE=13.585, CLS=11.729)
  Batch 220/1349: loss=15.8489 (NCE=13.368, CLS=12.405)
  Batch 230/1349: loss=16.5620 (NCE=14.098, CLS=12.319)
  Batch 240/1349: loss=16.4009 (NCE=14.015, CLS=11.929)
  Batch 250/1349: loss=16.5095 (NCE=14.072, CLS=12.189)
  Batch 260/1349: loss=16.1646 (NCE=13.805, CLS=11.798)
  Batch 270/1349: loss=16.0395 (NCE=13.585, CLS=12.275)
  Batch 280/1349: loss=15.9315 (NCE=13.638, CLS=11.467)
  Batch 290/1349: loss=16.4022 (NCE=13.898, CLS=12.519)
  Batch 300/1349: loss=15.9901 (NCE=13.655, CLS=11.677)
  Batch 310/1349: loss=15.9970 (NCE=13.640, CLS=11.783)
  Batch 320/1349: loss=16.5180 (NCE=14.038, CLS=12.399)
  Batch 330/1349: loss=16.2860 (NCE=13.838, CLS=12.241)
  Batch 340/1349: loss=15.9677 (NCE=13.484, CLS=12.419)
  Batch 350/1349: loss=16.6503 (NCE=14.127, CLS=12.617)
  Batch 360/1349: loss=15.8702 (NCE=13.536, CLS=11.672)
  Batch 370/1349: loss=16.1912 (NCE=13.768, CLS=12.114)
  Batch 380/1349: loss=16.5373 (NCE=13.905, CLS=13.161)
  Batch 390/1349: loss=15.2140 (NCE=12.999, CLS=11.075)
  Batch 400/1349: loss=15.8128 (NCE=13.538, CLS=11.372)
  Batch 410/1349: loss=16.0850 (NCE=13.717, CLS=11.841)
  Batch 420/1349: loss=15.8639 (NCE=13.283, CLS=12.902)
  Batch 430/1349: loss=15.7107 (NCE=13.489, CLS=11.108)
  Batch 440/1349: loss=14.8800 (NCE=12.587, CLS=11.464)
  Batch 450/1349: loss=15.7501 (NCE=13.298, CLS=12.259)
  Batch 460/1349: loss=16.2919 (NCE=13.853, CLS=12.196)
  Batch 470/1349: loss=15.9565 (NCE=13.616, CLS=11.705)
  Batch 480/1349: loss=15.4390 (NCE=13.216, CLS=11.113)
  Batch 490/1349: loss=15.8684 (NCE=13.584, CLS=11.422)
  Batch 500/1349: loss=14.8449 (NCE=12.718, CLS=10.636)
  Batch 510/1349: loss=14.8742 (NCE=12.709, CLS=10.826)
  Batch 520/1349: loss=16.0720 (NCE=13.767, CLS=11.524)
  Batch 530/1349: loss=15.5216 (NCE=13.330, CLS=10.958)
  Batch 540/1349: loss=16.0687 (NCE=13.609, CLS=12.297)
  Batch 550/1349: loss=16.1651 (NCE=13.721, CLS=12.221)
  Batch 560/1349: loss=16.5867 (NCE=14.137, CLS=12.250)
  Batch 570/1349: loss=17.4930 (NCE=14.860, CLS=13.166)
  Batch 580/1349: loss=16.4774 (NCE=14.102, CLS=11.875)
  Batch 590/1349: loss=16.9062 (NCE=14.516, CLS=11.951)
  Batch 600/1349: loss=16.6930 (NCE=14.215, CLS=12.389)
  Batch 610/1349: loss=16.3024 (NCE=13.853, CLS=12.245)
  Batch 620/1349: loss=15.5388 (NCE=13.184, CLS=11.772)
  Batch 630/1349: loss=16.3989 (NCE=13.905, CLS=12.470)
  Batch 640/1349: loss=16.2447 (NCE=13.910, CLS=11.673)
  Batch 650/1349: loss=16.3852 (NCE=14.027, CLS=11.792)
  Batch 660/1349: loss=15.4812 (NCE=13.229, CLS=11.263)
  Batch 670/1349: loss=15.2697 (NCE=12.901, CLS=11.843)
  Batch 680/1349: loss=15.5731 (NCE=13.244, CLS=11.645)
  Batch 690/1349: loss=16.1695 (NCE=13.862, CLS=11.538)
  Batch 700/1349: loss=15.7195 (NCE=13.424, CLS=11.478)
  Batch 710/1349: loss=16.3862 (NCE=13.984, CLS=12.012)
  Batch 720/1349: loss=16.4377 (NCE=13.950, CLS=12.438)
  Batch 730/1349: loss=15.7855 (NCE=13.548, CLS=11.187)
  Batch 740/1349: loss=16.5884 (NCE=14.223, CLS=11.829)
  Batch 750/1349: loss=16.1684 (NCE=13.789, CLS=11.898)
  Batch 760/1349: loss=16.2208 (NCE=13.858, CLS=11.813)
  Batch 770/1349: loss=15.4974 (NCE=13.254, CLS=11.218)
  Batch 780/1349: loss=15.0760 (NCE=12.870, CLS=11.029)
  Batch 790/1349: loss=15.9441 (NCE=13.601, CLS=11.715)
  Batch 800/1349: loss=15.7980 (NCE=13.549, CLS=11.247)
  Batch 810/1349: loss=15.8555 (NCE=13.431, CLS=12.121)
  Batch 820/1349: loss=16.0774 (NCE=13.789, CLS=11.444)
  Batch 830/1349: loss=15.9573 (NCE=13.537, CLS=12.102)
  Batch 840/1349: loss=16.9223 (NCE=14.385, CLS=12.685)
  Batch 850/1349: loss=16.9587 (NCE=14.303, CLS=13.278)
  Batch 860/1349: loss=16.5331 (NCE=14.021, CLS=12.562)
  Batch 870/1349: loss=16.5901 (NCE=14.111, CLS=12.394)
  Batch 880/1349: loss=15.1370 (NCE=12.979, CLS=10.790)
  Batch 890/1349: loss=16.2152 (NCE=13.781, CLS=12.172)
  Batch 900/1349: loss=16.9802 (NCE=14.488, CLS=12.460)
  Batch 910/1349: loss=15.2795 (NCE=12.978, CLS=11.508)
  Batch 920/1349: loss=16.7583 (NCE=14.366, CLS=11.963)
  Batch 930/1349: loss=16.2983 (NCE=13.868, CLS=12.154)
  Batch 940/1349: loss=15.2372 (NCE=12.933, CLS=11.521)
  Batch 950/1349: loss=15.7117 (NCE=13.392, CLS=11.597)
  Batch 960/1349: loss=15.1283 (NCE=12.918, CLS=11.050)
  Batch 970/1349: loss=16.5201 (NCE=13.901, CLS=13.093)
  Batch 980/1349: loss=15.9255 (NCE=13.543, CLS=11.910)
  Batch 990/1349: loss=16.1681 (NCE=13.849, CLS=11.598)
  Batch 1000/1349: loss=16.1720 (NCE=13.724, CLS=12.242)
  Batch 1010/1349: loss=16.6870 (NCE=14.220, CLS=12.333)
  Batch 1020/1349: loss=16.0752 (NCE=13.668, CLS=12.034)
  Batch 1030/1349: loss=15.4011 (NCE=13.170, CLS=11.156)
  Batch 1040/1349: loss=16.5591 (NCE=14.129, CLS=12.150)
  Batch 1050/1349: loss=16.7613 (NCE=14.287, CLS=12.370)
  Batch 1060/1349: loss=16.6490 (NCE=14.034, CLS=13.075)
  Batch 1070/1349: loss=16.1581 (NCE=13.785, CLS=11.868)
  Batch 1080/1349: loss=16.3160 (NCE=13.819, CLS=12.486)
  Batch 1090/1349: loss=16.3864 (NCE=13.928, CLS=12.294)
  Batch 1100/1349: loss=16.0045 (NCE=13.680, CLS=11.620)
  Batch 1110/1349: loss=16.5889 (NCE=14.129, CLS=12.299)
  Batch 1120/1349: loss=15.8133 (NCE=13.454, CLS=11.797)
  Batch 1130/1349: loss=16.0823 (NCE=13.700, CLS=11.912)
  Batch 1140/1349: loss=16.8842 (NCE=14.533, CLS=11.758)
  Batch 1150/1349: loss=16.0406 (NCE=13.575, CLS=12.329)
  Batch 1160/1349: loss=15.3271 (NCE=12.931, CLS=11.979)
  Batch 1170/1349: loss=16.1553 (NCE=13.761, CLS=11.973)
  Batch 1180/1349: loss=16.2569 (NCE=13.810, CLS=12.233)
  Batch 1190/1349: loss=16.3018 (NCE=13.789, CLS=12.564)
  Batch 1200/1349: loss=15.5697 (NCE=13.387, CLS=10.914)
  Batch 1210/1349: loss=15.5969 (NCE=13.300, CLS=11.484)
  Batch 1220/1349: loss=16.1723 (NCE=13.841, CLS=11.658)
  Batch 1230/1349: loss=16.3438 (NCE=14.015, CLS=11.646)
  Batch 1240/1349: loss=16.0793 (NCE=13.787, CLS=11.461)
  Batch 1250/1349: loss=16.0429 (NCE=13.626, CLS=12.084)
  Batch 1260/1349: loss=16.0234 (NCE=13.703, CLS=11.604)
  Batch 1270/1349: loss=16.8045 (NCE=14.406, CLS=11.993)
  Batch 1280/1349: loss=15.5892 (NCE=13.344, CLS=11.226)
  Batch 1290/1349: loss=15.3438 (NCE=13.098, CLS=11.228)
  Batch 1300/1349: loss=16.9948 (NCE=14.534, CLS=12.306)
  Batch 1310/1349: loss=16.3949 (NCE=13.974, CLS=12.104)
  Batch 1320/1349: loss=16.9821 (NCE=14.468, CLS=12.571)
  Batch 1330/1349: loss=15.4141 (NCE=13.154, CLS=11.300)
  Batch 1340/1349: loss=16.3504 (NCE=13.917, CLS=12.166)
  Train: loss=16.0545 (NCE=13.676, CLS=11.895)
  Acc: HV=0.178, HJ=0.234, LV=0.190, LJ=0.117
  Val: loss=13.7685, R@10_HV=0.012

Epoch 16/100
  Batch 10/1349: loss=16.5177 (NCE=14.148, CLS=11.847)
  Batch 20/1349: loss=15.7779 (NCE=13.313, CLS=12.325)
  Batch 30/1349: loss=15.6252 (NCE=13.205, CLS=12.101)
  Batch 40/1349: loss=15.9940 (NCE=13.701, CLS=11.465)
  Batch 50/1349: loss=14.8031 (NCE=12.560, CLS=11.217)
  Batch 60/1349: loss=15.6921 (NCE=13.457, CLS=11.174)
  Batch 70/1349: loss=15.9270 (NCE=13.706, CLS=11.103)
  Batch 80/1349: loss=15.2064 (NCE=13.007, CLS=10.997)
  Batch 90/1349: loss=16.4280 (NCE=14.087, CLS=11.703)
  Batch 100/1349: loss=16.1655 (NCE=13.804, CLS=11.807)
  Batch 110/1349: loss=15.5643 (NCE=13.163, CLS=12.009)
  Batch 120/1349: loss=16.1553 (NCE=13.591, CLS=12.824)
  Batch 130/1349: loss=16.1399 (NCE=13.773, CLS=11.837)
  Batch 140/1349: loss=15.0944 (NCE=12.714, CLS=11.900)
  Batch 150/1349: loss=15.9145 (NCE=13.431, CLS=12.419)
  Batch 160/1349: loss=16.8581 (NCE=14.412, CLS=12.231)
  Batch 170/1349: loss=16.1274 (NCE=13.770, CLS=11.786)
  Batch 180/1349: loss=15.2634 (NCE=12.811, CLS=12.262)
  Batch 190/1349: loss=15.9833 (NCE=13.663, CLS=11.601)
  Batch 200/1349: loss=16.5775 (NCE=14.144, CLS=12.169)
  Batch 210/1349: loss=15.8711 (NCE=13.397, CLS=12.369)
  Batch 220/1349: loss=15.2215 (NCE=12.951, CLS=11.355)
  Batch 230/1349: loss=15.7878 (NCE=13.441, CLS=11.737)
  Batch 240/1349: loss=15.7252 (NCE=13.437, CLS=11.439)
  Batch 250/1349: loss=15.8424 (NCE=13.518, CLS=11.622)
  Batch 260/1349: loss=15.4543 (NCE=13.225, CLS=11.146)
  Batch 270/1349: loss=16.6695 (NCE=14.167, CLS=12.511)
  Batch 280/1349: loss=16.6088 (NCE=14.188, CLS=12.102)
  Batch 290/1349: loss=16.1891 (NCE=13.724, CLS=12.324)
  Batch 300/1349: loss=15.8872 (NCE=13.576, CLS=11.555)
  Batch 310/1349: loss=16.6564 (NCE=14.256, CLS=12.003)
  Batch 320/1349: loss=16.0822 (NCE=13.696, CLS=11.931)
  Batch 330/1349: loss=16.4914 (NCE=14.081, CLS=12.050)
  Batch 340/1349: loss=16.4884 (NCE=14.104, CLS=11.922)
  Batch 350/1349: loss=16.0372 (NCE=13.730, CLS=11.534)
  Batch 360/1349: loss=15.8168 (NCE=13.492, CLS=11.623)
  Batch 370/1349: loss=15.5971 (NCE=13.273, CLS=11.622)
  Batch 380/1349: loss=15.6279 (NCE=13.214, CLS=12.067)
  Batch 390/1349: loss=16.4823 (NCE=14.115, CLS=11.836)
  Batch 400/1349: loss=15.3280 (NCE=13.052, CLS=11.381)
  Batch 410/1349: loss=16.7026 (NCE=14.312, CLS=11.955)
  Batch 420/1349: loss=17.0279 (NCE=14.422, CLS=13.028)
  Batch 430/1349: loss=16.2196 (NCE=13.874, CLS=11.729)
  Batch 440/1349: loss=15.8870 (NCE=13.630, CLS=11.283)
  Batch 450/1349: loss=16.5297 (NCE=14.168, CLS=11.806)
  Batch 460/1349: loss=15.2769 (NCE=13.019, CLS=11.287)
  Batch 470/1349: loss=16.3255 (NCE=13.941, CLS=11.921)
  Batch 480/1349: loss=16.2047 (NCE=13.839, CLS=11.830)
  Batch 490/1349: loss=16.5394 (NCE=14.047, CLS=12.461)
  Batch 500/1349: loss=16.3634 (NCE=13.982, CLS=11.907)
  Batch 510/1349: loss=17.0036 (NCE=14.624, CLS=11.899)
  Batch 520/1349: loss=15.6976 (NCE=13.438, CLS=11.296)
  Batch 530/1349: loss=16.4887 (NCE=14.108, CLS=11.905)
  Batch 540/1349: loss=15.8513 (NCE=13.523, CLS=11.641)
  Batch 550/1349: loss=16.4074 (NCE=13.984, CLS=12.115)
  Batch 560/1349: loss=14.9819 (NCE=12.699, CLS=11.414)
  Batch 570/1349: loss=15.4395 (NCE=13.045, CLS=11.974)
  Batch 580/1349: loss=16.4723 (NCE=14.069, CLS=12.017)
  Batch 590/1349: loss=15.8640 (NCE=13.468, CLS=11.981)
  Batch 600/1349: loss=15.9917 (NCE=13.632, CLS=11.797)
  Batch 610/1349: loss=15.6275 (NCE=13.390, CLS=11.187)
  Batch 620/1349: loss=14.9653 (NCE=12.774, CLS=10.959)
  Batch 630/1349: loss=16.1140 (NCE=13.705, CLS=12.047)
  Batch 640/1349: loss=16.8754 (NCE=14.501, CLS=11.872)
  Batch 650/1349: loss=16.0295 (NCE=13.575, CLS=12.270)
  Batch 660/1349: loss=16.2672 (NCE=13.840, CLS=12.138)
  Batch 670/1349: loss=15.0576 (NCE=12.882, CLS=10.876)
  Batch 680/1349: loss=16.8889 (NCE=14.437, CLS=12.260)
  Batch 690/1349: loss=16.4885 (NCE=14.069, CLS=12.098)
  Batch 700/1349: loss=14.7031 (NCE=12.476, CLS=11.136)
  Batch 710/1349: loss=15.5681 (NCE=13.348, CLS=11.103)
  Batch 720/1349: loss=15.9896 (NCE=13.595, CLS=11.971)
  Batch 730/1349: loss=16.5464 (NCE=14.179, CLS=11.837)
  Batch 740/1349: loss=16.5510 (NCE=14.139, CLS=12.058)
  Batch 750/1349: loss=16.4305 (NCE=14.054, CLS=11.881)
  Batch 760/1349: loss=16.1446 (NCE=13.848, CLS=11.483)
  Batch 770/1349: loss=14.6499 (NCE=12.558, CLS=10.460)
  Batch 780/1349: loss=16.0499 (NCE=13.796, CLS=11.269)
  Batch 790/1349: loss=15.2339 (NCE=12.920, CLS=11.572)
  Batch 800/1349: loss=15.2777 (NCE=12.979, CLS=11.495)
  Batch 810/1349: loss=15.4317 (NCE=12.914, CLS=12.588)
  Batch 820/1349: loss=16.4461 (NCE=14.125, CLS=11.604)
  Batch 830/1349: loss=16.1657 (NCE=13.838, CLS=11.639)
  Batch 840/1349: loss=16.5201 (NCE=14.159, CLS=11.807)
  Batch 850/1349: loss=15.5358 (NCE=13.128, CLS=12.038)
  Batch 860/1349: loss=16.6472 (NCE=14.215, CLS=12.160)
  Batch 870/1349: loss=15.8016 (NCE=13.347, CLS=12.275)
  Batch 880/1349: loss=15.8676 (NCE=13.388, CLS=12.398)
  Batch 890/1349: loss=15.8928 (NCE=13.359, CLS=12.671)
  Batch 900/1349: loss=15.9596 (NCE=13.675, CLS=11.422)
  Batch 910/1349: loss=15.8168 (NCE=13.566, CLS=11.255)
  Batch 920/1349: loss=15.8842 (NCE=13.470, CLS=12.072)
  Batch 930/1349: loss=16.2836 (NCE=13.808, CLS=12.376)
  Batch 940/1349: loss=14.1721 (NCE=11.948, CLS=11.123)
  Batch 950/1349: loss=16.9220 (NCE=14.503, CLS=12.094)
  Batch 960/1349: loss=15.4681 (NCE=13.242, CLS=11.133)
  Batch 970/1349: loss=16.7608 (NCE=14.194, CLS=12.834)
  Batch 980/1349: loss=16.2824 (NCE=13.972, CLS=11.552)
  Batch 990/1349: loss=15.9148 (NCE=13.582, CLS=11.664)
  Batch 1000/1349: loss=15.1801 (NCE=13.082, CLS=10.493)
  Batch 1010/1349: loss=16.5640 (NCE=14.071, CLS=12.463)
  Batch 1020/1349: loss=15.5518 (NCE=13.267, CLS=11.426)
  Batch 1030/1349: loss=16.2196 (NCE=13.580, CLS=13.199)
  Batch 1040/1349: loss=16.0991 (NCE=13.899, CLS=11.000)
  Batch 1050/1349: loss=15.9777 (NCE=13.609, CLS=11.843)
  Batch 1060/1349: loss=15.8929 (NCE=13.533, CLS=11.801)
  Batch 1070/1349: loss=15.3950 (NCE=13.014, CLS=11.905)
  Batch 1080/1349: loss=15.0958 (NCE=12.932, CLS=10.819)
  Batch 1090/1349: loss=15.3576 (NCE=12.980, CLS=11.886)
  Batch 1100/1349: loss=16.2789 (NCE=13.784, CLS=12.473)
  Batch 1110/1349: loss=16.2334 (NCE=13.790, CLS=12.217)
  Batch 1120/1349: loss=16.1600 (NCE=13.651, CLS=12.544)
  Batch 1130/1349: loss=15.7378 (NCE=13.208, CLS=12.648)
  Batch 1140/1349: loss=15.6657 (NCE=13.216, CLS=12.251)
  Batch 1150/1349: loss=16.5854 (NCE=14.195, CLS=11.953)
  Batch 1160/1349: loss=16.5326 (NCE=14.159, CLS=11.866)
  Batch 1170/1349: loss=16.6975 (NCE=14.283, CLS=12.072)
  Batch 1180/1349: loss=15.5275 (NCE=13.191, CLS=11.684)
  Batch 1190/1349: loss=16.3775 (NCE=14.005, CLS=11.865)
  Batch 1200/1349: loss=17.0156 (NCE=14.626, CLS=11.949)
  Batch 1210/1349: loss=16.3513 (NCE=13.948, CLS=12.017)
  Batch 1220/1349: loss=15.8261 (NCE=13.330, CLS=12.480)
  Batch 1230/1349: loss=16.0995 (NCE=13.690, CLS=12.048)
  Batch 1240/1349: loss=16.1456 (NCE=13.813, CLS=11.664)
  Batch 1250/1349: loss=16.6967 (NCE=14.283, CLS=12.068)
  Batch 1260/1349: loss=16.0211 (NCE=13.654, CLS=11.836)
  Batch 1270/1349: loss=15.2833 (NCE=13.033, CLS=11.253)
  Batch 1280/1349: loss=15.8855 (NCE=13.679, CLS=11.035)
  Batch 1290/1349: loss=16.2651 (NCE=13.796, CLS=12.344)
  Batch 1300/1349: loss=14.6167 (NCE=12.304, CLS=11.562)
  Batch 1310/1349: loss=17.1435 (NCE=14.508, CLS=13.178)
  Batch 1320/1349: loss=15.9780 (NCE=13.554, CLS=12.120)
  Batch 1330/1349: loss=15.9096 (NCE=13.503, CLS=12.032)
  Batch 1340/1349: loss=15.3256 (NCE=13.180, CLS=10.727)
  Train: loss=16.0329 (NCE=13.658, CLS=11.873)
  Acc: HV=0.179, HJ=0.234, LV=0.190, LJ=0.119
  Val: loss=13.7848, R@10_HV=0.010

Epoch 17/100
  Batch 10/1349: loss=15.9493 (NCE=13.684, CLS=11.327)
  Batch 20/1349: loss=15.4834 (NCE=13.119, CLS=11.821)
  Batch 30/1349: loss=16.1349 (NCE=13.813, CLS=11.607)
  Batch 40/1349: loss=16.2718 (NCE=13.994, CLS=11.388)
  Batch 50/1349: loss=16.2392 (NCE=13.867, CLS=11.863)
  Batch 60/1349: loss=16.5644 (NCE=14.059, CLS=12.526)
  Batch 70/1349: loss=15.9962 (NCE=13.709, CLS=11.434)
  Batch 80/1349: loss=16.2423 (NCE=13.824, CLS=12.092)
  Batch 90/1349: loss=16.0730 (NCE=13.678, CLS=11.974)
  Batch 100/1349: loss=15.3011 (NCE=12.962, CLS=11.695)
  Batch 110/1349: loss=15.2734 (NCE=12.934, CLS=11.699)
  Batch 120/1349: loss=16.0582 (NCE=13.816, CLS=11.212)
  Batch 130/1349: loss=14.8587 (NCE=12.593, CLS=11.331)
  Batch 140/1349: loss=15.8981 (NCE=13.598, CLS=11.502)
  Batch 150/1349: loss=15.8914 (NCE=13.369, CLS=12.614)
  Batch 160/1349: loss=15.7692 (NCE=13.373, CLS=11.981)
  Batch 170/1349: loss=15.4275 (NCE=13.163, CLS=11.322)
  Batch 180/1349: loss=16.3008 (NCE=13.954, CLS=11.732)
  Batch 190/1349: loss=16.2330 (NCE=13.848, CLS=11.924)
  Batch 200/1349: loss=16.2834 (NCE=13.790, CLS=12.466)
  Batch 210/1349: loss=15.8874 (NCE=13.495, CLS=11.962)
  Batch 220/1349: loss=16.5116 (NCE=13.956, CLS=12.779)
  Batch 230/1349: loss=14.9866 (NCE=12.814, CLS=10.861)
  Batch 240/1349: loss=16.3846 (NCE=14.012, CLS=11.861)
  Batch 250/1349: loss=16.3657 (NCE=13.884, CLS=12.410)
  Batch 260/1349: loss=16.2967 (NCE=13.911, CLS=11.930)
  Batch 270/1349: loss=15.9965 (NCE=13.677, CLS=11.597)
  Batch 280/1349: loss=16.7743 (NCE=14.338, CLS=12.180)
  Batch 290/1349: loss=14.8506 (NCE=12.672, CLS=10.894)
  Batch 300/1349: loss=17.3489 (NCE=14.868, CLS=12.407)
  Batch 310/1349: loss=16.1890 (NCE=13.767, CLS=12.112)
  Batch 320/1349: loss=16.4740 (NCE=14.063, CLS=12.056)
  Batch 330/1349: loss=15.7513 (NCE=13.206, CLS=12.728)
  Batch 340/1349: loss=15.5052 (NCE=13.139, CLS=11.831)
  Batch 350/1349: loss=15.2235 (NCE=12.876, CLS=11.740)
  Batch 360/1349: loss=15.5999 (NCE=13.306, CLS=11.470)
  Batch 370/1349: loss=16.2094 (NCE=13.915, CLS=11.471)
  Batch 380/1349: loss=15.9544 (NCE=13.630, CLS=11.624)
  Batch 390/1349: loss=16.2984 (NCE=13.883, CLS=12.077)
  Batch 400/1349: loss=15.6297 (NCE=13.294, CLS=11.680)
  Batch 410/1349: loss=15.4068 (NCE=13.259, CLS=10.742)
  Batch 420/1349: loss=16.5676 (NCE=14.066, CLS=12.508)
  Batch 430/1349: loss=15.9148 (NCE=13.515, CLS=11.999)
  Batch 440/1349: loss=16.5080 (NCE=14.173, CLS=11.677)
  Batch 450/1349: loss=16.0701 (NCE=13.525, CLS=12.723)
  Batch 460/1349: loss=16.1389 (NCE=13.798, CLS=11.705)
  Batch 470/1349: loss=16.6208 (NCE=14.249, CLS=11.859)
  Batch 480/1349: loss=15.8253 (NCE=13.503, CLS=11.614)
  Batch 490/1349: loss=16.7452 (NCE=14.148, CLS=12.985)
  Batch 500/1349: loss=16.4394 (NCE=14.074, CLS=11.825)
  Batch 510/1349: loss=15.8743 (NCE=13.598, CLS=11.379)
  Batch 520/1349: loss=16.0488 (NCE=13.662, CLS=11.936)
  Batch 530/1349: loss=16.3742 (NCE=13.949, CLS=12.128)
  Batch 540/1349: loss=15.7808 (NCE=13.494, CLS=11.432)
  Batch 550/1349: loss=16.0063 (NCE=13.668, CLS=11.691)
  Batch 560/1349: loss=16.2888 (NCE=13.772, CLS=12.584)
  Batch 570/1349: loss=16.7318 (NCE=14.236, CLS=12.477)
  Batch 580/1349: loss=15.7293 (NCE=13.295, CLS=12.173)
  Batch 590/1349: loss=16.0574 (NCE=13.652, CLS=12.029)
  Batch 600/1349: loss=15.8502 (NCE=13.489, CLS=11.808)
  Batch 610/1349: loss=16.5007 (NCE=14.077, CLS=12.119)
  Batch 620/1349: loss=16.6836 (NCE=14.219, CLS=12.322)
  Batch 630/1349: loss=16.7048 (NCE=14.142, CLS=12.813)
  Batch 640/1349: loss=16.1434 (NCE=13.855, CLS=11.443)
  Batch 650/1349: loss=15.8868 (NCE=13.590, CLS=11.486)
  Batch 660/1349: loss=14.1209 (NCE=11.959, CLS=10.812)
  Batch 670/1349: loss=16.5329 (NCE=13.986, CLS=12.735)
  Batch 680/1349: loss=16.3736 (NCE=14.053, CLS=11.601)
  Batch 690/1349: loss=16.2592 (NCE=13.731, CLS=12.643)
  Batch 700/1349: loss=15.7769 (NCE=13.611, CLS=10.831)
  Batch 710/1349: loss=16.6886 (NCE=14.284, CLS=12.021)
  Batch 720/1349: loss=16.4502 (NCE=14.116, CLS=11.670)
  Batch 730/1349: loss=16.2049 (NCE=13.762, CLS=12.215)
  Batch 740/1349: loss=16.7637 (NCE=14.445, CLS=11.592)
  Batch 750/1349: loss=16.3856 (NCE=13.942, CLS=12.218)
  Batch 760/1349: loss=15.7336 (NCE=13.442, CLS=11.458)
  Batch 770/1349: loss=16.3579 (NCE=13.871, CLS=12.435)
  Batch 780/1349: loss=16.0088 (NCE=13.600, CLS=12.046)
  Batch 790/1349: loss=15.5615 (NCE=13.281, CLS=11.403)
  Batch 800/1349: loss=16.8852 (NCE=14.470, CLS=12.074)
  Batch 810/1349: loss=14.6853 (NCE=12.523, CLS=10.811)
  Batch 820/1349: loss=16.2756 (NCE=13.784, CLS=12.460)
  Batch 830/1349: loss=15.2553 (NCE=13.070, CLS=10.924)
  Batch 840/1349: loss=17.0393 (NCE=14.556, CLS=12.418)
  Batch 850/1349: loss=15.5838 (NCE=13.312, CLS=11.361)
  Batch 860/1349: loss=15.5314 (NCE=13.189, CLS=11.713)
  Batch 870/1349: loss=16.0932 (NCE=13.678, CLS=12.075)
  Batch 880/1349: loss=15.7233 (NCE=13.397, CLS=11.633)
  Batch 890/1349: loss=16.9430 (NCE=14.531, CLS=12.058)
  Batch 900/1349: loss=16.4446 (NCE=13.997, CLS=12.240)
  Batch 910/1349: loss=16.2187 (NCE=13.901, CLS=11.589)
  Batch 920/1349: loss=15.9503 (NCE=13.644, CLS=11.530)
  Batch 930/1349: loss=15.8835 (NCE=13.448, CLS=12.179)
  Batch 940/1349: loss=15.5353 (NCE=13.159, CLS=11.879)
  Batch 950/1349: loss=15.6905 (NCE=13.259, CLS=12.158)
  Batch 960/1349: loss=15.6300 (NCE=13.153, CLS=12.385)
  Batch 970/1349: loss=16.3284 (NCE=13.897, CLS=12.159)
  Batch 980/1349: loss=16.3759 (NCE=14.134, CLS=11.211)
  Batch 990/1349: loss=16.1891 (NCE=13.863, CLS=11.631)
  Batch 1000/1349: loss=15.2791 (NCE=12.838, CLS=12.207)
  Batch 1010/1349: loss=15.2417 (NCE=12.959, CLS=11.414)
  Batch 1020/1349: loss=16.4783 (NCE=13.931, CLS=12.738)
  Batch 1030/1349: loss=15.0729 (NCE=12.701, CLS=11.858)
  Batch 1040/1349: loss=16.0647 (NCE=13.758, CLS=11.533)
  Batch 1050/1349: loss=16.3414 (NCE=13.874, CLS=12.335)
  Batch 1060/1349: loss=16.9162 (NCE=14.387, CLS=12.646)
  Batch 1070/1349: loss=16.5875 (NCE=14.165, CLS=12.114)
  Batch 1080/1349: loss=16.2997 (NCE=13.716, CLS=12.916)
  Batch 1090/1349: loss=16.9560 (NCE=14.460, CLS=12.480)
  Batch 1100/1349: loss=15.9382 (NCE=13.632, CLS=11.529)
  Batch 1110/1349: loss=16.0552 (NCE=13.750, CLS=11.524)
  Batch 1120/1349: loss=16.9014 (NCE=14.383, CLS=12.591)
  Batch 1130/1349: loss=15.7686 (NCE=13.497, CLS=11.358)
  Batch 1140/1349: loss=16.0094 (NCE=13.778, CLS=11.155)
  Batch 1150/1349: loss=15.8551 (NCE=13.444, CLS=12.057)
  Batch 1160/1349: loss=16.0847 (NCE=13.745, CLS=11.701)
  Batch 1170/1349: loss=15.9155 (NCE=13.536, CLS=11.900)
  Batch 1180/1349: loss=16.3757 (NCE=13.980, CLS=11.979)
  Batch 1190/1349: loss=15.5900 (NCE=13.107, CLS=12.413)
  Batch 1200/1349: loss=16.3298 (NCE=13.751, CLS=12.894)
  Batch 1210/1349: loss=15.7924 (NCE=13.476, CLS=11.582)
  Batch 1220/1349: loss=16.3216 (NCE=13.954, CLS=11.839)
  Batch 1230/1349: loss=16.5394 (NCE=14.218, CLS=11.606)
  Batch 1240/1349: loss=15.8440 (NCE=13.549, CLS=11.476)
  Batch 1250/1349: loss=16.2303 (NCE=13.835, CLS=11.979)
  Batch 1260/1349: loss=15.5417 (NCE=13.333, CLS=11.041)
  Batch 1270/1349: loss=16.4168 (NCE=14.112, CLS=11.524)
  Batch 1280/1349: loss=16.2116 (NCE=13.840, CLS=11.857)
  Batch 1290/1349: loss=16.3552 (NCE=13.915, CLS=12.200)
  Batch 1300/1349: loss=15.7467 (NCE=13.626, CLS=10.604)
  Batch 1310/1349: loss=16.4626 (NCE=13.999, CLS=12.318)
  Batch 1320/1349: loss=15.9979 (NCE=13.627, CLS=11.853)
  Batch 1330/1349: loss=16.6611 (NCE=14.292, CLS=11.848)
  Batch 1340/1349: loss=15.8918 (NCE=13.573, CLS=11.596)
  Train: loss=16.0133 (NCE=13.642, CLS=11.856)
  Acc: HV=0.178, HJ=0.235, LV=0.192, LJ=0.119
  Val: loss=13.7977, R@10_HV=0.011

Epoch 18/100
  Batch 10/1349: loss=16.1963 (NCE=13.883, CLS=11.565)
  Batch 20/1349: loss=15.5578 (NCE=13.201, CLS=11.783)
  Batch 30/1349: loss=16.6430 (NCE=14.201, CLS=12.210)
  Batch 40/1349: loss=16.4126 (NCE=13.928, CLS=12.425)
  Batch 50/1349: loss=15.9876 (NCE=13.617, CLS=11.851)
  Batch 60/1349: loss=16.7293 (NCE=14.421, CLS=11.539)
  Batch 70/1349: loss=15.9169 (NCE=13.520, CLS=11.985)
  Batch 80/1349: loss=16.7807 (NCE=14.385, CLS=11.978)
  Batch 90/1349: loss=16.4585 (NCE=13.986, CLS=12.360)
  Batch 100/1349: loss=15.8885 (NCE=13.387, CLS=12.508)
  Batch 110/1349: loss=15.5154 (NCE=13.141, CLS=11.873)
  Batch 120/1349: loss=16.1952 (NCE=13.742, CLS=12.264)
  Batch 130/1349: loss=16.6359 (NCE=14.286, CLS=11.749)
  Batch 140/1349: loss=15.9342 (NCE=13.697, CLS=11.187)
  Batch 150/1349: loss=16.4054 (NCE=14.001, CLS=12.021)
  Batch 160/1349: loss=16.9844 (NCE=14.457, CLS=12.635)
  Batch 170/1349: loss=16.6759 (NCE=14.184, CLS=12.459)
  Batch 180/1349: loss=16.2887 (NCE=13.816, CLS=12.363)
  Batch 190/1349: loss=16.8242 (NCE=14.361, CLS=12.315)
  Batch 200/1349: loss=15.7397 (NCE=13.440, CLS=11.499)
  Batch 210/1349: loss=14.8953 (NCE=12.624, CLS=11.358)
  Batch 220/1349: loss=16.5876 (NCE=14.146, CLS=12.206)
  Batch 230/1349: loss=15.7777 (NCE=13.291, CLS=12.433)
  Batch 240/1349: loss=15.7750 (NCE=13.421, CLS=11.771)
  Batch 250/1349: loss=16.4494 (NCE=14.030, CLS=12.097)
  Batch 260/1349: loss=15.7692 (NCE=13.547, CLS=11.112)
  Batch 270/1349: loss=15.5403 (NCE=13.264, CLS=11.380)
  Batch 280/1349: loss=15.9396 (NCE=13.571, CLS=11.842)
  Batch 290/1349: loss=16.1216 (NCE=13.656, CLS=12.329)
  Batch 300/1349: loss=15.9733 (NCE=13.480, CLS=12.468)
  Batch 310/1349: loss=16.0259 (NCE=13.711, CLS=11.574)
  Batch 320/1349: loss=15.8069 (NCE=13.494, CLS=11.562)
  Batch 330/1349: loss=15.9359 (NCE=13.573, CLS=11.814)
  Batch 340/1349: loss=16.0710 (NCE=13.643, CLS=12.141)
  Batch 350/1349: loss=16.1109 (NCE=13.778, CLS=11.663)
  Batch 360/1349: loss=17.0961 (NCE=14.656, CLS=12.200)
  Batch 370/1349: loss=15.5614 (NCE=13.329, CLS=11.163)
  Batch 380/1349: loss=15.4193 (NCE=13.266, CLS=10.767)
  Batch 390/1349: loss=16.0442 (NCE=13.649, CLS=11.975)
  Batch 400/1349: loss=16.2193 (NCE=13.849, CLS=11.852)
  Batch 410/1349: loss=15.8256 (NCE=13.341, CLS=12.424)
  Batch 420/1349: loss=16.3383 (NCE=14.007, CLS=11.656)
  Batch 430/1349: loss=16.1582 (NCE=13.759, CLS=11.996)
  Batch 440/1349: loss=16.5310 (NCE=13.862, CLS=13.347)
  Batch 450/1349: loss=17.1568 (NCE=14.758, CLS=11.995)
  Batch 460/1349: loss=15.3842 (NCE=13.221, CLS=10.814)
  Batch 470/1349: loss=16.5449 (NCE=14.135, CLS=12.052)
  Batch 480/1349: loss=15.2830 (NCE=12.965, CLS=11.588)
  Batch 490/1349: loss=16.3906 (NCE=13.964, CLS=12.135)
  Batch 500/1349: loss=16.5071 (NCE=13.952, CLS=12.773)
  Batch 510/1349: loss=15.2665 (NCE=13.048, CLS=11.093)
  Batch 520/1349: loss=16.3334 (NCE=13.822, CLS=12.556)
  Batch 530/1349: loss=16.5400 (NCE=13.978, CLS=12.808)
  Batch 540/1349: loss=16.1594 (NCE=13.847, CLS=11.564)
  Batch 550/1349: loss=15.2677 (NCE=12.996, CLS=11.357)
  Batch 560/1349: loss=16.0279 (NCE=13.701, CLS=11.633)
  Batch 570/1349: loss=15.8484 (NCE=13.517, CLS=11.659)
  Batch 580/1349: loss=16.2321 (NCE=13.789, CLS=12.214)
  Batch 590/1349: loss=15.8604 (NCE=13.622, CLS=11.195)
  Batch 600/1349: loss=16.2522 (NCE=13.820, CLS=12.161)
  Batch 610/1349: loss=16.3829 (NCE=13.921, CLS=12.308)
  Batch 620/1349: loss=16.1081 (NCE=13.685, CLS=12.114)
  Batch 630/1349: loss=16.5880 (NCE=14.182, CLS=12.031)
  Batch 640/1349: loss=15.3125 (NCE=13.034, CLS=11.390)
  Batch 650/1349: loss=16.1358 (NCE=13.779, CLS=11.782)
  Batch 660/1349: loss=16.2294 (NCE=13.800, CLS=12.146)
  Batch 670/1349: loss=15.5771 (NCE=13.242, CLS=11.675)
  Batch 680/1349: loss=15.7743 (NCE=13.331, CLS=12.218)
  Batch 690/1349: loss=16.5694 (NCE=14.119, CLS=12.254)
  Batch 700/1349: loss=17.1850 (NCE=14.594, CLS=12.954)
  Batch 710/1349: loss=15.5621 (NCE=13.250, CLS=11.558)
  Batch 720/1349: loss=15.9331 (NCE=13.572, CLS=11.807)
  Batch 730/1349: loss=16.6865 (NCE=14.178, CLS=12.544)
  Batch 740/1349: loss=15.1788 (NCE=12.991, CLS=10.941)
  Batch 750/1349: loss=17.0666 (NCE=14.597, CLS=12.348)
  Batch 760/1349: loss=16.1143 (NCE=13.756, CLS=11.789)
  Batch 770/1349: loss=16.2978 (NCE=13.959, CLS=11.693)
  Batch 780/1349: loss=15.8030 (NCE=13.348, CLS=12.273)
  Batch 790/1349: loss=16.3445 (NCE=14.075, CLS=11.347)
  Batch 800/1349: loss=16.5861 (NCE=14.106, CLS=12.401)
  Batch 810/1349: loss=15.8961 (NCE=13.529, CLS=11.836)
  Batch 820/1349: loss=15.8755 (NCE=13.454, CLS=12.106)
  Batch 830/1349: loss=16.9982 (NCE=14.551, CLS=12.238)
  Batch 840/1349: loss=16.2024 (NCE=13.886, CLS=11.581)
  Batch 850/1349: loss=15.3006 (NCE=13.136, CLS=10.821)
  Batch 860/1349: loss=15.9588 (NCE=13.568, CLS=11.954)
  Batch 870/1349: loss=15.7903 (NCE=13.425, CLS=11.827)
  Batch 880/1349: loss=15.2526 (NCE=12.984, CLS=11.344)
  Batch 890/1349: loss=16.0945 (NCE=13.667, CLS=12.139)
  Batch 900/1349: loss=16.3029 (NCE=13.930, CLS=11.862)
  Batch 910/1349: loss=16.6383 (NCE=14.243, CLS=11.978)
  Batch 920/1349: loss=15.4551 (NCE=13.273, CLS=10.910)
  Batch 930/1349: loss=16.3929 (NCE=13.935, CLS=12.288)
  Batch 940/1349: loss=16.2018 (NCE=13.729, CLS=12.366)
  Batch 950/1349: loss=15.7455 (NCE=13.394, CLS=11.758)
  Batch 960/1349: loss=16.8316 (NCE=14.387, CLS=12.221)
  Batch 970/1349: loss=15.3927 (NCE=13.066, CLS=11.631)
  Batch 980/1349: loss=16.5045 (NCE=13.828, CLS=13.385)
  Batch 990/1349: loss=16.8654 (NCE=14.390, CLS=12.378)
  Batch 1000/1349: loss=16.1186 (NCE=13.774, CLS=11.722)
  Batch 1010/1349: loss=16.3416 (NCE=13.964, CLS=11.890)
  Batch 1020/1349: loss=15.5893 (NCE=13.335, CLS=11.273)
  Batch 1030/1349: loss=16.2710 (NCE=13.737, CLS=12.672)
  Batch 1040/1349: loss=16.7906 (NCE=14.394, CLS=11.982)
  Batch 1050/1349: loss=17.3693 (NCE=14.852, CLS=12.588)
  Batch 1060/1349: loss=15.9744 (NCE=13.529, CLS=12.225)
  Batch 1070/1349: loss=16.5797 (NCE=14.148, CLS=12.160)
  Batch 1080/1349: loss=15.3252 (NCE=13.135, CLS=10.949)
  Batch 1090/1349: loss=15.5882 (NCE=13.165, CLS=12.116)
  Batch 1100/1349: loss=16.7286 (NCE=14.334, CLS=11.972)
  Batch 1110/1349: loss=16.2901 (NCE=13.915, CLS=11.877)
  Batch 1120/1349: loss=15.7385 (NCE=13.308, CLS=12.150)
  Batch 1130/1349: loss=16.1299 (NCE=13.679, CLS=12.254)
  Batch 1140/1349: loss=15.6494 (NCE=13.274, CLS=11.876)
  Batch 1150/1349: loss=15.4425 (NCE=13.046, CLS=11.981)
  Batch 1160/1349: loss=15.8899 (NCE=13.584, CLS=11.528)
  Batch 1170/1349: loss=16.7028 (NCE=14.367, CLS=11.678)
  Batch 1180/1349: loss=16.1014 (NCE=13.665, CLS=12.182)
  Batch 1190/1349: loss=16.2977 (NCE=13.835, CLS=12.313)
  Batch 1200/1349: loss=15.6209 (NCE=13.335, CLS=11.428)
  Batch 1210/1349: loss=16.0843 (NCE=13.661, CLS=12.116)
  Batch 1220/1349: loss=16.7320 (NCE=14.306, CLS=12.129)
  Batch 1230/1349: loss=16.3452 (NCE=13.905, CLS=12.200)
  Batch 1240/1349: loss=15.9425 (NCE=13.487, CLS=12.279)
  Batch 1250/1349: loss=16.3433 (NCE=13.961, CLS=11.912)
  Batch 1260/1349: loss=15.3675 (NCE=13.104, CLS=11.318)
  Batch 1270/1349: loss=16.1966 (NCE=13.804, CLS=11.964)
  Batch 1280/1349: loss=15.4841 (NCE=13.395, CLS=10.446)
  Batch 1290/1349: loss=15.9554 (NCE=13.509, CLS=12.231)
  Batch 1300/1349: loss=16.1753 (NCE=13.589, CLS=12.930)
  Batch 1310/1349: loss=15.8987 (NCE=13.562, CLS=11.684)
  Batch 1320/1349: loss=16.2139 (NCE=13.794, CLS=12.101)
  Batch 1330/1349: loss=15.5731 (NCE=13.225, CLS=11.738)
  Batch 1340/1349: loss=15.5171 (NCE=13.305, CLS=11.059)
  Train: loss=15.9977 (NCE=13.630, CLS=11.840)
  Acc: HV=0.179, HJ=0.237, LV=0.192, LJ=0.121
  Val: loss=13.7767, R@10_HV=0.010

Epoch 19/100
  Batch 10/1349: loss=15.7473 (NCE=13.533, CLS=11.073)
  Batch 20/1349: loss=15.6435 (NCE=13.200, CLS=12.216)
  Batch 30/1349: loss=15.8946 (NCE=13.659, CLS=11.178)
  Batch 40/1349: loss=15.8762 (NCE=13.531, CLS=11.724)
  Batch 50/1349: loss=16.4600 (NCE=14.088, CLS=11.860)
  Batch 60/1349: loss=16.9192 (NCE=14.490, CLS=12.147)
  Batch 70/1349: loss=16.8371 (NCE=14.383, CLS=12.269)
  Batch 80/1349: loss=16.3238 (NCE=13.931, CLS=11.966)
  Batch 90/1349: loss=15.8094 (NCE=13.542, CLS=11.335)
  Batch 100/1349: loss=16.1211 (NCE=13.644, CLS=12.388)
  Batch 110/1349: loss=15.9892 (NCE=13.617, CLS=11.863)
  Batch 120/1349: loss=16.8526 (NCE=14.456, CLS=11.981)
  Batch 130/1349: loss=15.4461 (NCE=13.187, CLS=11.297)
  Batch 140/1349: loss=15.8959 (NCE=13.469, CLS=12.135)
  Batch 150/1349: loss=16.1153 (NCE=13.600, CLS=12.576)
  Batch 160/1349: loss=16.4299 (NCE=14.069, CLS=11.807)
  Batch 170/1349: loss=16.9623 (NCE=14.464, CLS=12.490)
  Batch 180/1349: loss=16.1248 (NCE=13.737, CLS=11.939)
  Batch 190/1349: loss=17.1545 (NCE=14.682, CLS=12.365)
  Batch 200/1349: loss=14.7888 (NCE=12.672, CLS=10.583)
  Batch 210/1349: loss=16.5383 (NCE=14.135, CLS=12.019)
  Batch 220/1349: loss=14.6472 (NCE=12.453, CLS=10.969)
  Batch 230/1349: loss=16.1496 (NCE=13.717, CLS=12.163)
  Batch 240/1349: loss=16.3942 (NCE=13.975, CLS=12.097)
  Batch 250/1349: loss=15.6133 (NCE=13.343, CLS=11.352)
  Batch 260/1349: loss=15.5991 (NCE=13.257, CLS=11.712)
  Batch 270/1349: loss=15.7506 (NCE=13.524, CLS=11.133)
  Batch 280/1349: loss=15.5220 (NCE=13.130, CLS=11.960)
  Batch 290/1349: loss=16.1689 (NCE=13.840, CLS=11.644)
  Batch 300/1349: loss=16.4534 (NCE=14.107, CLS=11.731)
  Batch 310/1349: loss=16.3084 (NCE=13.919, CLS=11.947)
  Batch 320/1349: loss=15.1642 (NCE=12.990, CLS=10.869)
  Batch 330/1349: loss=16.1383 (NCE=13.731, CLS=12.039)
  Batch 340/1349: loss=15.9424 (NCE=13.604, CLS=11.694)
  Batch 350/1349: loss=15.4655 (NCE=13.147, CLS=11.590)
  Batch 360/1349: loss=16.3228 (NCE=13.907, CLS=12.077)
  Batch 370/1349: loss=16.9893 (NCE=14.315, CLS=13.371)
  Batch 380/1349: loss=15.7439 (NCE=13.255, CLS=12.443)
  Batch 390/1349: loss=16.6367 (NCE=14.272, CLS=11.821)
  Batch 400/1349: loss=16.5713 (NCE=14.121, CLS=12.251)
  Batch 410/1349: loss=15.7438 (NCE=13.387, CLS=11.783)
  Batch 420/1349: loss=15.4506 (NCE=13.143, CLS=11.539)
  Batch 430/1349: loss=15.8391 (NCE=13.469, CLS=11.853)
  Batch 440/1349: loss=16.1545 (NCE=13.729, CLS=12.127)
  Batch 450/1349: loss=15.1022 (NCE=12.983, CLS=10.594)
  Batch 460/1349: loss=16.2182 (NCE=13.806, CLS=12.059)
  Batch 470/1349: loss=15.8014 (NCE=13.425, CLS=11.880)
  Batch 480/1349: loss=16.5330 (NCE=14.009, CLS=12.622)
  Batch 490/1349: loss=14.7455 (NCE=12.502, CLS=11.217)
  Batch 500/1349: loss=17.0869 (NCE=14.596, CLS=12.456)
  Batch 510/1349: loss=15.2744 (NCE=13.050, CLS=11.124)
  Batch 520/1349: loss=15.4543 (NCE=13.148, CLS=11.531)
  Batch 530/1349: loss=16.2960 (NCE=13.934, CLS=11.810)
  Batch 540/1349: loss=16.2514 (NCE=13.880, CLS=11.859)
  Batch 550/1349: loss=16.0224 (NCE=13.600, CLS=12.111)
  Batch 560/1349: loss=15.6958 (NCE=13.462, CLS=11.172)
  Batch 570/1349: loss=15.6773 (NCE=13.425, CLS=11.263)
  Batch 580/1349: loss=16.3230 (NCE=13.940, CLS=11.913)
  Batch 590/1349: loss=16.7916 (NCE=14.293, CLS=12.494)
  Batch 600/1349: loss=14.5364 (NCE=12.340, CLS=10.983)
  Batch 610/1349: loss=15.9605 (NCE=13.464, CLS=12.482)
  Batch 620/1349: loss=16.5690 (NCE=14.124, CLS=12.224)
  Batch 630/1349: loss=15.9401 (NCE=13.543, CLS=11.987)
  Batch 640/1349: loss=15.5433 (NCE=13.349, CLS=10.970)
  Batch 650/1349: loss=16.3250 (NCE=13.904, CLS=12.106)
  Batch 660/1349: loss=16.2399 (NCE=13.776, CLS=12.319)
  Batch 670/1349: loss=15.1447 (NCE=12.828, CLS=11.586)
  Batch 680/1349: loss=16.3607 (NCE=13.843, CLS=12.590)
  Batch 690/1349: loss=15.8553 (NCE=13.556, CLS=11.498)
  Batch 700/1349: loss=15.6185 (NCE=13.342, CLS=11.384)
  Batch 710/1349: loss=15.6269 (NCE=13.398, CLS=11.145)
  Batch 720/1349: loss=16.2770 (NCE=13.960, CLS=11.585)
  Batch 730/1349: loss=15.7111 (NCE=13.526, CLS=10.926)
  Batch 740/1349: loss=15.9437 (NCE=13.558, CLS=11.927)
  Batch 750/1349: loss=16.4126 (NCE=14.045, CLS=11.840)
  Batch 760/1349: loss=15.9819 (NCE=13.538, CLS=12.220)
  Batch 770/1349: loss=15.2935 (NCE=12.965, CLS=11.643)
  Batch 780/1349: loss=15.4276 (NCE=13.035, CLS=11.964)
  Batch 790/1349: loss=16.5569 (NCE=14.138, CLS=12.093)
  Batch 800/1349: loss=15.9250 (NCE=13.611, CLS=11.568)
  Batch 810/1349: loss=16.4820 (NCE=14.115, CLS=11.836)
  Batch 820/1349: loss=16.6703 (NCE=14.354, CLS=11.582)
  Batch 830/1349: loss=15.8099 (NCE=13.484, CLS=11.631)
  Batch 840/1349: loss=16.3523 (NCE=13.969, CLS=11.918)
  Batch 850/1349: loss=15.9816 (NCE=13.699, CLS=11.415)
  Batch 860/1349: loss=15.9717 (NCE=13.639, CLS=11.661)
  Batch 870/1349: loss=16.4946 (NCE=13.989, CLS=12.530)
  Batch 880/1349: loss=16.0430 (NCE=13.683, CLS=11.800)
  Batch 890/1349: loss=16.1884 (NCE=13.764, CLS=12.123)
  Batch 900/1349: loss=15.9861 (NCE=13.651, CLS=11.673)
  Batch 910/1349: loss=16.3548 (NCE=13.916, CLS=12.191)
  Batch 920/1349: loss=15.8405 (NCE=13.478, CLS=11.812)
  Batch 930/1349: loss=14.9697 (NCE=12.760, CLS=11.047)
  Batch 940/1349: loss=16.1438 (NCE=13.656, CLS=12.437)
  Batch 950/1349: loss=15.6795 (NCE=13.337, CLS=11.714)
  Batch 960/1349: loss=15.3511 (NCE=13.087, CLS=11.322)
  Batch 970/1349: loss=16.7354 (NCE=14.171, CLS=12.824)
  Batch 980/1349: loss=15.3351 (NCE=13.029, CLS=11.531)
  Batch 990/1349: loss=16.0902 (NCE=13.810, CLS=11.403)
  Batch 1000/1349: loss=16.2636 (NCE=13.857, CLS=12.032)
  Batch 1010/1349: loss=15.4944 (NCE=13.183, CLS=11.557)
  Batch 1020/1349: loss=16.6517 (NCE=14.306, CLS=11.729)
  Batch 1030/1349: loss=15.5334 (NCE=13.198, CLS=11.678)
  Batch 1040/1349: loss=16.0693 (NCE=13.836, CLS=11.168)
  Batch 1050/1349: loss=16.3225 (NCE=14.022, CLS=11.501)
  Batch 1060/1349: loss=16.2432 (NCE=13.820, CLS=12.114)
  Batch 1070/1349: loss=16.0430 (NCE=13.726, CLS=11.583)
  Batch 1080/1349: loss=15.5650 (NCE=13.041, CLS=12.622)
  Batch 1090/1349: loss=15.9653 (NCE=13.634, CLS=11.658)
  Batch 1100/1349: loss=15.4607 (NCE=13.114, CLS=11.734)
  Batch 1110/1349: loss=15.7583 (NCE=13.485, CLS=11.365)
  Batch 1120/1349: loss=15.8983 (NCE=13.550, CLS=11.743)
  Batch 1130/1349: loss=16.0362 (NCE=13.589, CLS=12.238)
  Batch 1140/1349: loss=15.5291 (NCE=13.358, CLS=10.853)
  Batch 1150/1349: loss=15.7323 (NCE=13.226, CLS=12.532)
  Batch 1160/1349: loss=16.2949 (NCE=14.016, CLS=11.394)
  Batch 1170/1349: loss=16.4028 (NCE=13.972, CLS=12.155)
  Batch 1180/1349: loss=16.1759 (NCE=13.648, CLS=12.639)
  Batch 1190/1349: loss=16.3213 (NCE=13.936, CLS=11.928)
  Batch 1200/1349: loss=16.7375 (NCE=14.245, CLS=12.464)
  Batch 1210/1349: loss=17.0796 (NCE=14.625, CLS=12.275)
  Batch 1220/1349: loss=15.2868 (NCE=13.147, CLS=10.698)
  Batch 1230/1349: loss=16.0162 (NCE=13.643, CLS=11.867)
  Batch 1240/1349: loss=16.1386 (NCE=13.794, CLS=11.724)
  Batch 1250/1349: loss=16.1893 (NCE=13.800, CLS=11.946)
  Batch 1260/1349: loss=16.0062 (NCE=13.598, CLS=12.042)
  Batch 1270/1349: loss=15.9028 (NCE=13.393, CLS=12.550)
  Batch 1280/1349: loss=15.9754 (NCE=13.508, CLS=12.337)
  Batch 1290/1349: loss=15.6249 (NCE=13.280, CLS=11.724)
  Batch 1300/1349: loss=16.8232 (NCE=14.409, CLS=12.073)
  Batch 1310/1349: loss=15.2367 (NCE=12.944, CLS=11.463)
  Batch 1320/1349: loss=16.4737 (NCE=13.984, CLS=12.448)
  Batch 1330/1349: loss=16.4467 (NCE=14.009, CLS=12.186)
  Batch 1340/1349: loss=16.7497 (NCE=14.383, CLS=11.834)
  Train: loss=15.9805 (NCE=13.616, CLS=11.823)
  Acc: HV=0.179, HJ=0.238, LV=0.192, LJ=0.123
  Val: loss=13.7999, R@10_HV=0.010

Epoch 20/100
  Batch 10/1349: loss=15.6163 (NCE=13.327, CLS=11.444)
  Batch 20/1349: loss=15.6940 (NCE=13.294, CLS=12.000)
  Batch 30/1349: loss=15.6438 (NCE=13.345, CLS=11.496)
  Batch 40/1349: loss=15.5930 (NCE=13.121, CLS=12.360)
  Batch 50/1349: loss=15.3920 (NCE=13.112, CLS=11.399)
  Batch 60/1349: loss=16.4050 (NCE=14.139, CLS=11.329)
  Batch 70/1349: loss=16.6461 (NCE=14.217, CLS=12.147)
  Batch 80/1349: loss=14.2939 (NCE=12.240, CLS=10.271)
  Batch 90/1349: loss=16.5966 (NCE=13.882, CLS=13.571)
  Batch 100/1349: loss=16.2165 (NCE=13.965, CLS=11.260)
  Batch 110/1349: loss=16.7336 (NCE=14.309, CLS=12.125)
  Batch 120/1349: loss=15.9152 (NCE=13.570, CLS=11.725)
  Batch 130/1349: loss=16.2794 (NCE=13.857, CLS=12.113)
  Batch 140/1349: loss=16.4311 (NCE=14.072, CLS=11.794)
  Batch 150/1349: loss=14.8460 (NCE=12.726, CLS=10.598)
  Batch 160/1349: loss=15.8397 (NCE=13.609, CLS=11.152)
  Batch 170/1349: loss=15.7613 (NCE=13.385, CLS=11.883)
  Batch 180/1349: loss=15.3070 (NCE=13.033, CLS=11.372)
  Batch 190/1349: loss=16.1229 (NCE=13.860, CLS=11.313)
  Batch 200/1349: loss=15.8642 (NCE=13.586, CLS=11.390)
  Batch 210/1349: loss=16.5891 (NCE=14.154, CLS=12.177)
  Batch 220/1349: loss=15.5306 (NCE=13.191, CLS=11.699)
  Batch 230/1349: loss=16.0643 (NCE=13.562, CLS=12.511)
  Batch 240/1349: loss=15.8555 (NCE=13.547, CLS=11.545)
  Batch 250/1349: loss=15.8233 (NCE=13.361, CLS=12.311)
  Batch 260/1349: loss=16.1220 (NCE=13.752, CLS=11.851)
  Batch 270/1349: loss=15.6562 (NCE=13.283, CLS=11.865)
  Batch 280/1349: loss=15.1403 (NCE=12.899, CLS=11.206)
  Batch 290/1349: loss=16.5936 (NCE=14.173, CLS=12.101)
  Batch 300/1349: loss=15.8887 (NCE=13.501, CLS=11.937)
  Batch 310/1349: loss=16.8952 (NCE=14.538, CLS=11.784)
  Batch 320/1349: loss=16.9661 (NCE=14.351, CLS=13.076)
  Batch 330/1349: loss=15.8852 (NCE=13.548, CLS=11.688)
  Batch 340/1349: loss=16.2684 (NCE=13.751, CLS=12.589)
  Batch 350/1349: loss=16.1302 (NCE=13.804, CLS=11.630)
  Batch 360/1349: loss=15.6704 (NCE=13.398, CLS=11.363)
  Batch 370/1349: loss=15.9149 (NCE=13.517, CLS=11.991)
  Batch 380/1349: loss=15.2571 (NCE=13.029, CLS=11.140)
  Batch 390/1349: loss=16.0389 (NCE=13.619, CLS=12.100)
  Batch 400/1349: loss=16.8282 (NCE=14.286, CLS=12.709)
  Batch 410/1349: loss=16.4862 (NCE=14.123, CLS=11.817)
  Batch 420/1349: loss=16.6653 (NCE=14.198, CLS=12.335)
  Batch 430/1349: loss=15.3487 (NCE=13.220, CLS=10.645)
  Batch 440/1349: loss=15.0862 (NCE=12.811, CLS=11.374)
  Batch 450/1349: loss=16.6379 (NCE=14.229, CLS=12.042)
  Batch 460/1349: loss=15.7657 (NCE=13.371, CLS=11.975)
  Batch 470/1349: loss=16.6672 (NCE=14.331, CLS=11.679)
  Batch 480/1349: loss=15.1751 (NCE=13.030, CLS=10.726)
  Batch 490/1349: loss=16.2227 (NCE=13.869, CLS=11.767)
  Batch 500/1349: loss=16.2246 (NCE=13.791, CLS=12.168)
  Batch 510/1349: loss=16.5270 (NCE=14.095, CLS=12.160)
  Batch 520/1349: loss=15.5373 (NCE=13.178, CLS=11.795)
  Batch 530/1349: loss=15.1773 (NCE=12.889, CLS=11.442)
  Batch 540/1349: loss=15.9628 (NCE=13.546, CLS=12.085)
  Batch 550/1349: loss=16.2526 (NCE=13.812, CLS=12.204)
  Batch 560/1349: loss=16.1020 (NCE=13.727, CLS=11.873)
  Batch 570/1349: loss=14.7680 (NCE=12.537, CLS=11.154)
  Batch 580/1349: loss=15.9369 (NCE=13.689, CLS=11.241)
  Batch 590/1349: loss=16.6923 (NCE=14.148, CLS=12.724)
  Batch 600/1349: loss=15.9682 (NCE=13.771, CLS=10.988)
  Batch 610/1349: loss=15.3916 (NCE=12.959, CLS=12.162)
  Batch 620/1349: loss=16.6880 (NCE=14.274, CLS=12.072)
  Batch 630/1349: loss=16.3934 (NCE=13.872, CLS=12.609)
  Batch 640/1349: loss=16.0465 (NCE=13.613, CLS=12.169)
  Batch 650/1349: loss=15.9145 (NCE=13.456, CLS=12.294)
  Batch 660/1349: loss=16.2683 (NCE=13.974, CLS=11.470)
  Batch 670/1349: loss=16.7493 (NCE=14.263, CLS=12.430)
  Batch 680/1349: loss=16.5408 (NCE=14.153, CLS=11.937)
  Batch 690/1349: loss=16.0106 (NCE=13.661, CLS=11.749)
  Batch 700/1349: loss=16.0664 (NCE=13.802, CLS=11.320)
  Batch 710/1349: loss=15.0758 (NCE=12.781, CLS=11.473)
  Batch 720/1349: loss=16.4393 (NCE=13.947, CLS=12.459)
  Batch 730/1349: loss=16.0318 (NCE=13.681, CLS=11.752)
  Batch 740/1349: loss=16.2875 (NCE=13.910, CLS=11.886)
  Batch 750/1349: loss=16.2956 (NCE=13.933, CLS=11.810)
  Batch 760/1349: loss=15.5910 (NCE=13.209, CLS=11.909)
  Batch 770/1349: loss=16.4148 (NCE=14.023, CLS=11.957)
  Batch 780/1349: loss=15.3433 (NCE=13.049, CLS=11.473)
  Batch 790/1349: loss=15.9354 (NCE=13.560, CLS=11.879)
  Batch 800/1349: loss=17.3516 (NCE=14.914, CLS=12.187)
  Batch 810/1349: loss=15.9906 (NCE=13.625, CLS=11.830)
  Batch 820/1349: loss=16.0376 (NCE=13.551, CLS=12.433)
  Batch 830/1349: loss=16.4608 (NCE=14.026, CLS=12.174)
  Batch 840/1349: loss=15.5291 (NCE=13.054, CLS=12.375)
  Batch 850/1349: loss=16.5468 (NCE=14.114, CLS=12.166)
  Batch 860/1349: loss=16.0328 (NCE=13.587, CLS=12.229)
  Batch 870/1349: loss=16.4017 (NCE=14.015, CLS=11.934)
  Batch 880/1349: loss=16.0688 (NCE=13.798, CLS=11.352)
  Batch 890/1349: loss=16.1422 (NCE=13.777, CLS=11.824)
  Batch 900/1349: loss=15.7877 (NCE=13.521, CLS=11.335)
  Batch 910/1349: loss=16.2410 (NCE=13.867, CLS=11.870)
  Batch 920/1349: loss=16.6573 (NCE=14.247, CLS=12.054)
  Batch 930/1349: loss=16.1060 (NCE=13.688, CLS=12.089)
  Batch 940/1349: loss=15.9126 (NCE=13.630, CLS=11.411)
  Batch 950/1349: loss=16.0830 (NCE=13.620, CLS=12.316)
  Batch 960/1349: loss=16.2769 (NCE=13.780, CLS=12.483)
  Batch 970/1349: loss=15.8081 (NCE=13.378, CLS=12.149)
  Batch 980/1349: loss=15.9040 (NCE=13.536, CLS=11.842)
  Batch 990/1349: loss=16.2546 (NCE=13.900, CLS=11.774)
  Batch 1000/1349: loss=16.0430 (NCE=13.783, CLS=11.302)
  Batch 1010/1349: loss=16.7784 (NCE=14.305, CLS=12.367)
  Batch 1020/1349: loss=16.5815 (NCE=14.259, CLS=11.612)
  Batch 1030/1349: loss=15.5417 (NCE=13.428, CLS=10.569)
  Batch 1040/1349: loss=16.0075 (NCE=13.417, CLS=12.952)
  Batch 1050/1349: loss=15.8155 (NCE=13.364, CLS=12.259)
  Batch 1060/1349: loss=15.7322 (NCE=13.357, CLS=11.878)
  Batch 1070/1349: loss=16.8257 (NCE=14.318, CLS=12.537)
  Batch 1080/1349: loss=16.0751 (NCE=13.643, CLS=12.159)
  Batch 1090/1349: loss=15.7213 (NCE=13.364, CLS=11.788)
  Batch 1100/1349: loss=15.0405 (NCE=12.710, CLS=11.654)
  Batch 1110/1349: loss=16.1702 (NCE=13.836, CLS=11.672)
  Batch 1120/1349: loss=16.1560 (NCE=13.771, CLS=11.925)
  Batch 1130/1349: loss=16.0901 (NCE=13.695, CLS=11.975)
  Batch 1140/1349: loss=16.9884 (NCE=14.575, CLS=12.068)
  Batch 1150/1349: loss=16.5854 (NCE=14.093, CLS=12.464)
  Batch 1160/1349: loss=15.5794 (NCE=13.275, CLS=11.521)
  Batch 1170/1349: loss=15.6785 (NCE=13.360, CLS=11.592)
  Batch 1180/1349: loss=16.3416 (NCE=13.633, CLS=13.544)
  Batch 1190/1349: loss=16.2518 (NCE=13.908, CLS=11.718)
  Batch 1200/1349: loss=16.1172 (NCE=13.710, CLS=12.035)
  Batch 1210/1349: loss=15.7868 (NCE=13.467, CLS=11.597)
  Batch 1220/1349: loss=15.8119 (NCE=13.519, CLS=11.466)
  Batch 1230/1349: loss=16.2737 (NCE=13.773, CLS=12.506)
  Batch 1240/1349: loss=14.8900 (NCE=12.640, CLS=11.250)
  Batch 1250/1349: loss=15.8046 (NCE=13.417, CLS=11.939)
  Batch 1260/1349: loss=15.8358 (NCE=13.548, CLS=11.438)
  Batch 1270/1349: loss=16.8548 (NCE=14.267, CLS=12.938)
  Batch 1280/1349: loss=15.1931 (NCE=12.926, CLS=11.333)
  Batch 1290/1349: loss=15.7420 (NCE=13.425, CLS=11.586)
  Batch 1300/1349: loss=15.1758 (NCE=12.885, CLS=11.452)
  Batch 1310/1349: loss=16.3765 (NCE=13.899, CLS=12.389)
  Batch 1320/1349: loss=16.3906 (NCE=13.904, CLS=12.431)
  Batch 1330/1349: loss=16.1021 (NCE=13.801, CLS=11.503)
  Batch 1340/1349: loss=15.3907 (NCE=13.193, CLS=10.988)
  Train: loss=15.9677 (NCE=13.605, CLS=11.814)
  Acc: HV=0.180, HJ=0.236, LV=0.191, LJ=0.123
  Val: loss=13.8084, R@10_HV=0.010

Epoch 21/100
  Batch 10/1349: loss=15.7873 (NCE=13.453, CLS=11.672)
  Batch 20/1349: loss=16.3143 (NCE=13.973, CLS=11.704)
  Batch 30/1349: loss=16.2603 (NCE=13.770, CLS=12.453)
  Batch 40/1349: loss=16.6974 (NCE=14.302, CLS=11.977)
  Batch 50/1349: loss=15.6336 (NCE=13.394, CLS=11.198)
  Batch 60/1349: loss=16.4968 (NCE=14.054, CLS=12.215)
  Batch 70/1349: loss=17.3280 (NCE=14.845, CLS=12.415)
  Batch 80/1349: loss=16.3398 (NCE=13.937, CLS=12.012)
  Batch 90/1349: loss=16.3688 (NCE=13.971, CLS=11.987)
  Batch 100/1349: loss=15.2468 (NCE=12.902, CLS=11.722)
  Batch 110/1349: loss=15.8995 (NCE=13.541, CLS=11.790)
  Batch 120/1349: loss=16.2568 (NCE=13.852, CLS=12.026)
  Batch 130/1349: loss=15.5621 (NCE=13.241, CLS=11.604)
  Batch 140/1349: loss=16.0994 (NCE=13.585, CLS=12.574)
  Batch 150/1349: loss=16.2843 (NCE=13.955, CLS=11.648)
  Batch 160/1349: loss=16.1938 (NCE=13.656, CLS=12.690)
  Batch 170/1349: loss=16.0551 (NCE=13.583, CLS=12.362)
  Batch 180/1349: loss=16.0865 (NCE=13.693, CLS=11.967)
  Batch 190/1349: loss=15.8859 (NCE=13.542, CLS=11.721)
  Batch 200/1349: loss=16.1636 (NCE=13.883, CLS=11.404)
  Batch 210/1349: loss=15.6885 (NCE=13.237, CLS=12.259)
  Batch 220/1349: loss=16.0855 (NCE=13.710, CLS=11.877)
  Batch 230/1349: loss=15.7662 (NCE=13.465, CLS=11.506)
  Batch 240/1349: loss=16.4300 (NCE=14.045, CLS=11.927)
  Batch 250/1349: loss=16.7650 (NCE=14.452, CLS=11.564)
  Batch 260/1349: loss=15.9399 (NCE=13.643, CLS=11.482)
  Batch 270/1349: loss=16.3583 (NCE=13.866, CLS=12.460)
  Batch 280/1349: loss=15.7221 (NCE=13.325, CLS=11.984)
  Batch 290/1349: loss=15.7768 (NCE=13.459, CLS=11.588)
  Batch 300/1349: loss=16.1769 (NCE=13.878, CLS=11.495)
  Batch 310/1349: loss=15.9385 (NCE=13.568, CLS=11.853)
  Batch 320/1349: loss=15.0949 (NCE=12.823, CLS=11.358)
  Batch 330/1349: loss=16.3549 (NCE=13.894, CLS=12.307)
  Batch 340/1349: loss=15.9404 (NCE=13.611, CLS=11.646)
  Batch 350/1349: loss=15.7984 (NCE=13.247, CLS=12.757)
  Batch 360/1349: loss=15.4903 (NCE=13.140, CLS=11.749)
  Batch 370/1349: loss=16.6141 (NCE=14.162, CLS=12.263)
  Batch 380/1349: loss=15.8164 (NCE=13.463, CLS=11.768)
  Batch 390/1349: loss=15.1613 (NCE=12.733, CLS=12.143)
  Batch 400/1349: loss=16.4893 (NCE=14.015, CLS=12.370)
  Batch 410/1349: loss=16.0822 (NCE=13.745, CLS=11.687)
  Batch 420/1349: loss=15.2605 (NCE=13.104, CLS=10.782)
  Batch 430/1349: loss=16.6172 (NCE=14.271, CLS=11.730)
  Batch 440/1349: loss=15.8339 (NCE=13.486, CLS=11.738)
  Batch 450/1349: loss=15.5773 (NCE=13.346, CLS=11.155)
  Batch 460/1349: loss=16.9331 (NCE=14.443, CLS=12.450)
  Batch 470/1349: loss=16.2384 (NCE=13.857, CLS=11.905)
  Batch 480/1349: loss=16.5190 (NCE=14.079, CLS=12.200)
  Batch 490/1349: loss=16.1053 (NCE=13.750, CLS=11.774)
  Batch 500/1349: loss=15.9939 (NCE=13.681, CLS=11.563)
  Batch 510/1349: loss=16.5817 (NCE=14.212, CLS=11.849)
  Batch 520/1349: loss=16.2393 (NCE=13.740, CLS=12.494)
  Batch 530/1349: loss=16.1204 (NCE=13.717, CLS=12.015)
  Batch 540/1349: loss=16.5183 (NCE=14.124, CLS=11.969)
  Batch 550/1349: loss=16.2916 (NCE=14.042, CLS=11.248)
  Batch 560/1349: loss=16.8267 (NCE=14.477, CLS=11.750)
  Batch 570/1349: loss=14.5291 (NCE=12.490, CLS=10.198)
  Batch 580/1349: loss=15.9437 (NCE=13.629, CLS=11.571)
  Batch 590/1349: loss=16.2721 (NCE=13.772, CLS=12.501)
  Batch 600/1349: loss=15.6079 (NCE=13.346, CLS=11.310)
  Batch 610/1349: loss=16.4097 (NCE=14.003, CLS=12.034)
  Batch 620/1349: loss=15.7934 (NCE=13.508, CLS=11.427)
  Batch 630/1349: loss=16.0800 (NCE=13.690, CLS=11.952)
  Batch 640/1349: loss=15.7144 (NCE=13.371, CLS=11.716)
  Batch 650/1349: loss=16.5863 (NCE=14.081, CLS=12.526)
  Batch 660/1349: loss=16.6537 (NCE=14.040, CLS=13.069)
  Batch 670/1349: loss=15.8846 (NCE=13.606, CLS=11.394)
  Batch 680/1349: loss=16.7264 (NCE=14.325, CLS=12.006)
  Batch 690/1349: loss=16.1375 (NCE=13.797, CLS=11.702)
  Batch 700/1349: loss=16.2869 (NCE=13.896, CLS=11.955)
  Batch 710/1349: loss=15.3703 (NCE=13.189, CLS=10.907)
  Batch 720/1349: loss=15.9459 (NCE=13.388, CLS=12.787)
  Batch 730/1349: loss=16.2604 (NCE=13.825, CLS=12.175)
  Batch 740/1349: loss=16.6501 (NCE=14.130, CLS=12.601)
  Batch 750/1349: loss=15.8786 (NCE=13.444, CLS=12.172)
  Batch 760/1349: loss=15.2941 (NCE=13.017, CLS=11.385)
  Batch 770/1349: loss=15.9451 (NCE=13.610, CLS=11.676)
  Batch 780/1349: loss=16.1404 (NCE=13.661, CLS=12.395)
  Batch 790/1349: loss=15.1466 (NCE=12.861, CLS=11.427)
  Batch 800/1349: loss=15.9690 (NCE=13.717, CLS=11.258)
  Batch 810/1349: loss=16.3569 (NCE=14.029, CLS=11.639)
  Batch 820/1349: loss=16.6607 (NCE=14.201, CLS=12.297)
  Batch 830/1349: loss=16.1391 (NCE=13.844, CLS=11.477)
  Batch 840/1349: loss=16.4414 (NCE=14.068, CLS=11.867)
  Batch 850/1349: loss=16.7045 (NCE=14.297, CLS=12.037)
  Batch 860/1349: loss=16.4639 (NCE=14.007, CLS=12.282)
  Batch 870/1349: loss=16.0206 (NCE=13.632, CLS=11.944)
  Batch 880/1349: loss=16.5577 (NCE=13.992, CLS=12.829)
  Batch 890/1349: loss=16.0018 (NCE=13.669, CLS=11.663)
  Batch 900/1349: loss=16.0581 (NCE=13.797, CLS=11.304)
  Batch 910/1349: loss=15.5358 (NCE=13.218, CLS=11.587)
  Batch 920/1349: loss=15.8982 (NCE=13.421, CLS=12.387)
  Batch 930/1349: loss=16.3833 (NCE=14.061, CLS=11.613)
  Batch 940/1349: loss=15.8015 (NCE=13.461, CLS=11.700)
  Batch 950/1349: loss=16.0515 (NCE=13.715, CLS=11.685)
  Batch 960/1349: loss=16.5008 (NCE=14.102, CLS=11.995)
  Batch 970/1349: loss=15.7603 (NCE=13.363, CLS=11.986)
  Batch 980/1349: loss=16.8947 (NCE=14.506, CLS=11.942)
  Batch 990/1349: loss=16.4467 (NCE=14.064, CLS=11.913)
  Batch 1000/1349: loss=14.9426 (NCE=12.907, CLS=10.180)
  Batch 1010/1349: loss=16.6086 (NCE=14.147, CLS=12.308)
  Batch 1020/1349: loss=15.8362 (NCE=13.607, CLS=11.147)
  Batch 1030/1349: loss=15.5205 (NCE=13.117, CLS=12.019)
  Batch 1040/1349: loss=16.6719 (NCE=14.135, CLS=12.683)
  Batch 1050/1349: loss=15.4881 (NCE=13.268, CLS=11.098)
  Batch 1060/1349: loss=15.8955 (NCE=13.477, CLS=12.093)
  Batch 1070/1349: loss=15.8363 (NCE=13.542, CLS=11.470)
  Batch 1080/1349: loss=15.8790 (NCE=13.499, CLS=11.902)
  Batch 1090/1349: loss=15.7042 (NCE=13.565, CLS=10.697)
  Batch 1100/1349: loss=15.9845 (NCE=13.656, CLS=11.640)
  Batch 1110/1349: loss=16.2048 (NCE=13.618, CLS=12.936)
  Batch 1120/1349: loss=16.5436 (NCE=14.091, CLS=12.265)
  Batch 1130/1349: loss=16.3501 (NCE=13.992, CLS=11.792)
  Batch 1140/1349: loss=14.8698 (NCE=12.570, CLS=11.500)
  Batch 1150/1349: loss=15.5091 (NCE=13.266, CLS=11.217)
  Batch 1160/1349: loss=16.1333 (NCE=13.748, CLS=11.927)
  Batch 1170/1349: loss=16.0302 (NCE=13.700, CLS=11.653)
  Batch 1180/1349: loss=16.1007 (NCE=13.741, CLS=11.800)
  Batch 1190/1349: loss=16.9059 (NCE=14.448, CLS=12.290)
  Batch 1200/1349: loss=16.3910 (NCE=13.976, CLS=12.074)
  Batch 1210/1349: loss=16.0684 (NCE=13.747, CLS=11.607)
  Batch 1220/1349: loss=16.3338 (NCE=13.837, CLS=12.485)
  Batch 1230/1349: loss=15.1375 (NCE=13.031, CLS=10.532)
  Batch 1240/1349: loss=15.8348 (NCE=13.546, CLS=11.445)
  Batch 1250/1349: loss=16.0772 (NCE=13.780, CLS=11.484)
  Batch 1260/1349: loss=17.0656 (NCE=14.674, CLS=11.956)
  Batch 1270/1349: loss=15.9677 (NCE=13.570, CLS=11.986)
  Batch 1280/1349: loss=16.0002 (NCE=13.652, CLS=11.742)
  Batch 1290/1349: loss=16.0517 (NCE=13.663, CLS=11.943)
  Batch 1300/1349: loss=15.9026 (NCE=13.700, CLS=11.012)
  Batch 1310/1349: loss=16.4789 (NCE=14.059, CLS=12.097)
  Batch 1320/1349: loss=15.5641 (NCE=13.185, CLS=11.897)
  Batch 1330/1349: loss=16.2177 (NCE=13.793, CLS=12.122)
  Batch 1340/1349: loss=16.6187 (NCE=13.895, CLS=13.617)
  Train: loss=15.9510 (NCE=13.592, CLS=11.796)
  Acc: HV=0.182, HJ=0.237, LV=0.192, LJ=0.124
  Val: loss=13.8084, R@10_HV=0.010

Epoch 22/100
  Batch 10/1349: loss=16.4889 (NCE=14.105, CLS=11.919)
  Batch 20/1349: loss=15.0018 (NCE=12.740, CLS=11.307)
  Batch 30/1349: loss=15.9147 (NCE=13.668, CLS=11.231)
  Batch 40/1349: loss=15.3308 (NCE=13.057, CLS=11.370)
  Batch 50/1349: loss=15.9631 (NCE=13.635, CLS=11.640)
  Batch 60/1349: loss=16.0736 (NCE=13.794, CLS=11.398)
  Batch 70/1349: loss=15.0596 (NCE=12.834, CLS=11.128)
  Batch 80/1349: loss=15.7105 (NCE=13.280, CLS=12.154)
  Batch 90/1349: loss=15.4797 (NCE=13.220, CLS=11.299)
  Batch 100/1349: loss=15.0890 (NCE=12.822, CLS=11.336)
  Batch 110/1349: loss=16.3708 (NCE=14.017, CLS=11.769)
  Batch 120/1349: loss=16.0859 (NCE=13.716, CLS=11.851)
  Batch 130/1349: loss=16.0480 (NCE=13.668, CLS=11.899)
  Batch 140/1349: loss=15.6294 (NCE=13.194, CLS=12.175)
  Batch 150/1349: loss=16.1904 (NCE=13.748, CLS=12.214)
  Batch 160/1349: loss=16.7188 (NCE=14.328, CLS=11.954)
  Batch 170/1349: loss=15.7471 (NCE=13.423, CLS=11.623)
  Batch 180/1349: loss=15.7954 (NCE=13.377, CLS=12.089)
  Batch 190/1349: loss=15.7747 (NCE=13.509, CLS=11.329)
  Batch 200/1349: loss=15.7583 (NCE=13.413, CLS=11.727)
  Batch 210/1349: loss=15.9309 (NCE=13.659, CLS=11.361)
  Batch 220/1349: loss=15.4700 (NCE=13.168, CLS=11.509)
  Batch 230/1349: loss=15.8813 (NCE=13.544, CLS=11.689)
  Batch 240/1349: loss=15.6221 (NCE=13.350, CLS=11.362)
  Batch 250/1349: loss=16.4039 (NCE=14.045, CLS=11.794)
  Batch 260/1349: loss=16.3263 (NCE=13.975, CLS=11.757)
  Batch 270/1349: loss=15.5827 (NCE=13.144, CLS=12.195)
  Batch 280/1349: loss=16.6770 (NCE=14.266, CLS=12.054)
  Batch 290/1349: loss=14.6199 (NCE=12.522, CLS=10.490)
  Batch 300/1349: loss=16.2593 (NCE=13.860, CLS=11.998)
  Batch 310/1349: loss=16.4608 (NCE=13.991, CLS=12.351)
  Batch 320/1349: loss=16.0457 (NCE=13.806, CLS=11.198)
  Batch 330/1349: loss=15.1882 (NCE=13.039, CLS=10.744)
  Batch 340/1349: loss=16.3232 (NCE=14.011, CLS=11.562)
  Batch 350/1349: loss=16.0761 (NCE=13.733, CLS=11.717)
  Batch 360/1349: loss=16.2260 (NCE=13.784, CLS=12.210)
  Batch 370/1349: loss=16.2563 (NCE=13.912, CLS=11.724)
  Batch 380/1349: loss=15.9072 (NCE=13.640, CLS=11.337)
  Batch 390/1349: loss=16.6094 (NCE=14.261, CLS=11.742)
  Batch 400/1349: loss=16.0269 (NCE=13.640, CLS=11.933)
  Batch 410/1349: loss=16.0577 (NCE=13.695, CLS=11.811)
  Batch 420/1349: loss=16.4079 (NCE=14.043, CLS=11.824)
  Batch 430/1349: loss=16.4978 (NCE=13.885, CLS=13.062)
  Batch 440/1349: loss=16.8285 (NCE=14.454, CLS=11.874)
  Batch 450/1349: loss=15.7640 (NCE=13.419, CLS=11.725)
  Batch 460/1349: loss=15.9064 (NCE=13.663, CLS=11.218)
  Batch 470/1349: loss=16.2845 (NCE=14.094, CLS=10.954)
  Batch 480/1349: loss=15.1736 (NCE=12.739, CLS=12.175)
  Batch 490/1349: loss=15.5586 (NCE=13.277, CLS=11.410)
  Batch 500/1349: loss=15.9158 (NCE=13.472, CLS=12.219)
  Batch 510/1349: loss=16.1665 (NCE=13.754, CLS=12.062)
  Batch 520/1349: loss=15.3322 (NCE=13.035, CLS=11.484)
  Batch 530/1349: loss=16.4320 (NCE=13.942, CLS=12.453)
  Batch 540/1349: loss=15.9818 (NCE=13.586, CLS=11.979)
  Batch 550/1349: loss=16.8799 (NCE=14.306, CLS=12.870)
  Batch 560/1349: loss=15.9468 (NCE=13.616, CLS=11.655)
  Batch 570/1349: loss=15.5867 (NCE=13.112, CLS=12.373)
  Batch 580/1349: loss=15.3469 (NCE=13.101, CLS=11.228)
  Batch 590/1349: loss=15.9973 (NCE=13.581, CLS=12.079)
  Batch 600/1349: loss=16.1035 (NCE=13.691, CLS=12.062)
  Batch 610/1349: loss=16.7679 (NCE=14.387, CLS=11.907)
  Batch 620/1349: loss=16.5789 (NCE=14.123, CLS=12.281)
  Batch 630/1349: loss=16.8005 (NCE=14.344, CLS=12.282)
  Batch 640/1349: loss=16.1967 (NCE=13.874, CLS=11.612)
  Batch 650/1349: loss=15.8308 (NCE=13.380, CLS=12.253)
  Batch 660/1349: loss=15.6354 (NCE=13.377, CLS=11.294)
  Batch 670/1349: loss=15.6002 (NCE=13.187, CLS=12.065)
  Batch 680/1349: loss=15.5789 (NCE=13.243, CLS=11.680)
  Batch 690/1349: loss=16.0902 (NCE=13.682, CLS=12.040)
  Batch 700/1349: loss=15.6871 (NCE=13.464, CLS=11.117)
  Batch 710/1349: loss=16.3719 (NCE=14.020, CLS=11.757)
  Batch 720/1349: loss=16.4000 (NCE=14.056, CLS=11.720)
  Batch 730/1349: loss=15.4131 (NCE=12.881, CLS=12.660)
  Batch 740/1349: loss=16.1365 (NCE=13.870, CLS=11.332)
  Batch 750/1349: loss=16.5106 (NCE=14.111, CLS=11.996)
  Batch 760/1349: loss=16.0365 (NCE=13.583, CLS=12.269)
  Batch 770/1349: loss=15.7250 (NCE=13.528, CLS=10.983)
  Batch 780/1349: loss=16.1953 (NCE=13.695, CLS=12.500)
  Batch 790/1349: loss=16.1545 (NCE=13.799, CLS=11.778)
  Batch 800/1349: loss=16.1272 (NCE=13.776, CLS=11.755)
  Batch 810/1349: loss=16.3349 (NCE=14.069, CLS=11.329)
  Batch 820/1349: loss=16.0974 (NCE=13.798, CLS=11.498)
  Batch 830/1349: loss=15.6426 (NCE=13.434, CLS=11.041)
  Batch 840/1349: loss=15.9936 (NCE=13.694, CLS=11.496)
  Batch 850/1349: loss=16.0606 (NCE=13.722, CLS=11.694)
  Batch 860/1349: loss=16.3794 (NCE=14.022, CLS=11.786)
  Batch 870/1349: loss=16.2811 (NCE=13.932, CLS=11.747)
  Batch 880/1349: loss=15.7201 (NCE=13.271, CLS=12.246)
  Batch 890/1349: loss=16.1178 (NCE=13.749, CLS=11.843)
  Batch 900/1349: loss=16.3624 (NCE=13.924, CLS=12.190)
  Batch 910/1349: loss=15.4462 (NCE=13.048, CLS=11.993)
  Batch 920/1349: loss=14.8706 (NCE=12.721, CLS=10.749)
  Batch 930/1349: loss=16.9283 (NCE=14.455, CLS=12.368)
  Batch 940/1349: loss=16.3261 (NCE=13.954, CLS=11.861)
  Batch 950/1349: loss=16.3880 (NCE=13.948, CLS=12.200)
  Batch 960/1349: loss=16.0929 (NCE=13.624, CLS=12.344)
  Batch 970/1349: loss=16.1936 (NCE=13.841, CLS=11.761)
  Batch 980/1349: loss=15.5058 (NCE=13.395, CLS=10.556)
  Batch 990/1349: loss=15.0080 (NCE=12.673, CLS=11.674)
  Batch 1000/1349: loss=15.9521 (NCE=13.575, CLS=11.883)
  Batch 1010/1349: loss=16.2344 (NCE=13.851, CLS=11.918)
  Batch 1020/1349: loss=16.9695 (NCE=14.415, CLS=12.770)
  Batch 1030/1349: loss=15.4259 (NCE=13.094, CLS=11.662)
  Batch 1040/1349: loss=15.2118 (NCE=12.882, CLS=11.649)
  Batch 1050/1349: loss=15.6114 (NCE=13.251, CLS=11.800)
  Batch 1060/1349: loss=16.2367 (NCE=13.947, CLS=11.448)
  Batch 1070/1349: loss=16.4379 (NCE=14.025, CLS=12.064)
  Batch 1080/1349: loss=15.8558 (NCE=13.651, CLS=11.024)
  Batch 1090/1349: loss=16.3170 (NCE=13.945, CLS=11.858)
  Batch 1100/1349: loss=16.5654 (NCE=14.083, CLS=12.411)
  Batch 1110/1349: loss=16.4751 (NCE=14.137, CLS=11.689)
  Batch 1120/1349: loss=17.1048 (NCE=14.663, CLS=12.207)
  Batch 1130/1349: loss=16.5029 (NCE=14.115, CLS=11.939)
  Batch 1140/1349: loss=15.5962 (NCE=13.213, CLS=11.915)
  Batch 1150/1349: loss=14.5284 (NCE=12.383, CLS=10.726)
  Batch 1160/1349: loss=16.5926 (NCE=14.159, CLS=12.170)
  Batch 1170/1349: loss=16.4135 (NCE=14.006, CLS=12.039)
  Batch 1180/1349: loss=16.3862 (NCE=13.922, CLS=12.322)
  Batch 1190/1349: loss=14.8983 (NCE=12.684, CLS=11.071)
  Batch 1200/1349: loss=15.6790 (NCE=13.449, CLS=11.149)
  Batch 1210/1349: loss=15.3559 (NCE=13.173, CLS=10.915)
  Batch 1220/1349: loss=16.2687 (NCE=13.899, CLS=11.850)
  Batch 1230/1349: loss=15.1347 (NCE=12.930, CLS=11.023)
  Batch 1240/1349: loss=15.8060 (NCE=13.361, CLS=12.224)
  Batch 1250/1349: loss=15.8385 (NCE=13.601, CLS=11.189)
  Batch 1260/1349: loss=15.1319 (NCE=12.755, CLS=11.886)
  Batch 1270/1349: loss=15.6966 (NCE=13.428, CLS=11.344)
  Batch 1280/1349: loss=15.8332 (NCE=13.525, CLS=11.542)
  Batch 1290/1349: loss=15.9421 (NCE=13.617, CLS=11.627)
  Batch 1300/1349: loss=15.2517 (NCE=13.007, CLS=11.222)
  Batch 1310/1349: loss=15.4778 (NCE=13.047, CLS=12.154)
  Batch 1320/1349: loss=16.5658 (NCE=14.024, CLS=12.707)
  Batch 1330/1349: loss=15.7209 (NCE=13.411, CLS=11.552)
  Batch 1340/1349: loss=16.3264 (NCE=13.882, CLS=12.222)
  Train: loss=15.9358 (NCE=13.579, CLS=11.784)
  Acc: HV=0.181, HJ=0.238, LV=0.194, LJ=0.123
  Val: loss=13.8149, R@10_HV=0.011

Epoch 23/100
  Batch 10/1349: loss=16.7155 (NCE=14.289, CLS=12.133)
  Batch 20/1349: loss=15.4007 (NCE=13.242, CLS=10.795)
  Batch 30/1349: loss=15.6653 (NCE=13.429, CLS=11.183)
  Batch 40/1349: loss=16.5725 (NCE=14.144, CLS=12.143)
  Batch 50/1349: loss=16.1785 (NCE=13.798, CLS=11.900)
  Batch 60/1349: loss=15.6093 (NCE=13.343, CLS=11.334)
  Batch 70/1349: loss=15.9664 (NCE=13.610, CLS=11.781)
  Batch 80/1349: loss=16.4247 (NCE=14.038, CLS=11.936)
  Batch 90/1349: loss=16.6095 (NCE=14.030, CLS=12.899)
  Batch 100/1349: loss=15.8431 (NCE=13.466, CLS=11.886)
  Batch 110/1349: loss=16.3501 (NCE=13.835, CLS=12.575)
  Batch 120/1349: loss=16.3184 (NCE=13.930, CLS=11.940)
  Batch 130/1349: loss=16.1809 (NCE=13.819, CLS=11.807)
  Batch 140/1349: loss=15.7065 (NCE=13.464, CLS=11.215)
  Batch 150/1349: loss=16.1895 (NCE=13.779, CLS=12.051)
  Batch 160/1349: loss=15.5498 (NCE=13.260, CLS=11.449)
  Batch 170/1349: loss=16.6312 (NCE=14.123, CLS=12.541)
  Batch 180/1349: loss=16.2874 (NCE=13.962, CLS=11.626)
  Batch 190/1349: loss=15.3610 (NCE=12.861, CLS=12.499)
  Batch 200/1349: loss=15.8336 (NCE=13.426, CLS=12.036)
  Batch 210/1349: loss=16.1254 (NCE=13.851, CLS=11.374)
  Batch 220/1349: loss=14.6876 (NCE=12.390, CLS=11.490)
  Batch 230/1349: loss=16.5367 (NCE=14.201, CLS=11.681)
  Batch 240/1349: loss=16.2305 (NCE=13.842, CLS=11.942)
  Batch 250/1349: loss=15.8693 (NCE=13.549, CLS=11.600)
  Batch 260/1349: loss=15.5873 (NCE=13.439, CLS=10.742)
  Batch 270/1349: loss=16.3492 (NCE=13.931, CLS=12.092)
  Batch 280/1349: loss=15.9972 (NCE=13.706, CLS=11.456)
  Batch 290/1349: loss=16.5403 (NCE=13.918, CLS=13.114)
  Batch 300/1349: loss=15.5788 (NCE=13.202, CLS=11.886)
  Batch 310/1349: loss=16.4970 (NCE=14.002, CLS=12.477)
  Batch 320/1349: loss=15.8527 (NCE=13.599, CLS=11.268)
  Batch 330/1349: loss=15.6921 (NCE=13.374, CLS=11.590)
  Batch 340/1349: loss=16.1446 (NCE=13.794, CLS=11.753)
  Batch 350/1349: loss=16.3771 (NCE=13.977, CLS=12.000)
  Batch 360/1349: loss=15.7519 (NCE=13.389, CLS=11.812)
  Batch 370/1349: loss=15.7581 (NCE=13.393, CLS=11.827)
  Batch 380/1349: loss=15.1375 (NCE=12.922, CLS=11.076)
  Batch 390/1349: loss=15.6687 (NCE=13.290, CLS=11.893)
  Batch 400/1349: loss=16.6567 (NCE=14.304, CLS=11.764)
  Batch 410/1349: loss=15.9268 (NCE=13.643, CLS=11.419)
  Batch 420/1349: loss=16.6416 (NCE=14.164, CLS=12.386)
  Batch 430/1349: loss=15.8206 (NCE=13.438, CLS=11.912)
  Batch 440/1349: loss=16.1153 (NCE=13.728, CLS=11.937)
  Batch 450/1349: loss=15.9372 (NCE=13.641, CLS=11.479)
  Batch 460/1349: loss=16.0963 (NCE=13.780, CLS=11.579)
  Batch 470/1349: loss=16.4094 (NCE=13.920, CLS=12.446)
  Batch 480/1349: loss=15.6086 (NCE=13.259, CLS=11.747)
  Batch 490/1349: loss=16.6978 (NCE=14.133, CLS=12.823)
  Batch 500/1349: loss=14.5714 (NCE=12.309, CLS=11.314)
  Batch 510/1349: loss=15.8935 (NCE=13.635, CLS=11.293)
  Batch 520/1349: loss=16.2330 (NCE=13.781, CLS=12.262)
  Batch 530/1349: loss=14.7694 (NCE=12.557, CLS=11.060)
  Batch 540/1349: loss=15.7098 (NCE=13.347, CLS=11.813)
  Batch 550/1349: loss=16.3213 (NCE=13.909, CLS=12.060)
  Batch 560/1349: loss=16.4341 (NCE=14.063, CLS=11.854)
  Batch 570/1349: loss=16.4477 (NCE=14.070, CLS=11.888)
  Batch 580/1349: loss=15.6013 (NCE=13.365, CLS=11.183)
  Batch 590/1349: loss=16.2627 (NCE=13.931, CLS=11.658)
  Batch 600/1349: loss=16.1947 (NCE=13.667, CLS=12.637)
  Batch 610/1349: loss=14.9819 (NCE=12.898, CLS=10.420)
  Batch 620/1349: loss=15.1190 (NCE=12.850, CLS=11.346)
  Batch 630/1349: loss=15.1910 (NCE=13.074, CLS=10.586)
  Batch 640/1349: loss=15.2800 (NCE=13.107, CLS=10.866)
  Batch 650/1349: loss=16.0988 (NCE=13.757, CLS=11.709)
  Batch 660/1349: loss=15.9704 (NCE=13.427, CLS=12.717)
  Batch 670/1349: loss=16.6573 (NCE=14.148, CLS=12.549)
  Batch 680/1349: loss=16.1585 (NCE=13.834, CLS=11.622)
  Batch 690/1349: loss=15.4360 (NCE=13.176, CLS=11.301)
  Batch 700/1349: loss=16.4390 (NCE=13.976, CLS=12.316)
  Batch 710/1349: loss=16.1903 (NCE=13.853, CLS=11.686)
  Batch 720/1349: loss=15.3918 (NCE=13.000, CLS=11.957)
  Batch 730/1349: loss=15.8736 (NCE=13.540, CLS=11.669)
  Batch 740/1349: loss=16.1987 (NCE=13.849, CLS=11.748)
  Batch 750/1349: loss=16.3174 (NCE=13.803, CLS=12.573)
  Batch 760/1349: loss=16.1139 (NCE=13.746, CLS=11.841)
  Batch 770/1349: loss=15.0229 (NCE=12.799, CLS=11.118)
  Batch 780/1349: loss=15.8567 (NCE=13.584, CLS=11.366)
  Batch 790/1349: loss=16.6492 (NCE=14.256, CLS=11.968)
  Batch 800/1349: loss=15.7631 (NCE=13.458, CLS=11.524)
  Batch 810/1349: loss=14.9933 (NCE=12.817, CLS=10.884)
  Batch 820/1349: loss=16.8290 (NCE=14.340, CLS=12.444)
  Batch 830/1349: loss=15.5022 (NCE=13.126, CLS=11.881)
  Batch 840/1349: loss=16.3161 (NCE=13.835, CLS=12.405)
  Batch 850/1349: loss=15.0943 (NCE=12.934, CLS=10.803)
  Batch 860/1349: loss=16.2959 (NCE=13.939, CLS=11.785)
  Batch 870/1349: loss=15.2035 (NCE=13.001, CLS=11.011)
  Batch 880/1349: loss=16.3544 (NCE=13.994, CLS=11.804)
  Batch 890/1349: loss=15.2457 (NCE=12.882, CLS=11.820)
  Batch 900/1349: loss=15.3314 (NCE=13.174, CLS=10.789)
  Batch 910/1349: loss=16.5503 (NCE=14.077, CLS=12.366)
  Batch 920/1349: loss=15.9849 (NCE=13.493, CLS=12.459)
  Batch 930/1349: loss=16.0951 (NCE=13.780, CLS=11.573)
  Batch 940/1349: loss=16.0546 (NCE=13.630, CLS=12.124)
  Batch 950/1349: loss=15.7803 (NCE=13.395, CLS=11.925)
  Batch 960/1349: loss=16.3195 (NCE=14.043, CLS=11.384)
  Batch 970/1349: loss=15.8814 (NCE=13.575, CLS=11.533)
  Batch 980/1349: loss=16.0760 (NCE=13.659, CLS=12.084)
  Batch 990/1349: loss=15.8294 (NCE=13.412, CLS=12.086)
  Batch 1000/1349: loss=15.1058 (NCE=12.903, CLS=11.016)
  Batch 1010/1349: loss=16.3049 (NCE=13.946, CLS=11.795)
  Batch 1020/1349: loss=15.5536 (NCE=13.328, CLS=11.126)
  Batch 1030/1349: loss=15.1762 (NCE=12.967, CLS=11.044)
  Batch 1040/1349: loss=16.9210 (NCE=14.559, CLS=11.810)
  Batch 1050/1349: loss=15.8247 (NCE=13.451, CLS=11.869)
  Batch 1060/1349: loss=16.7796 (NCE=14.401, CLS=11.892)
  Batch 1070/1349: loss=15.9324 (NCE=13.619, CLS=11.566)
  Batch 1080/1349: loss=16.1323 (NCE=13.856, CLS=11.383)
  Batch 1090/1349: loss=15.9104 (NCE=13.495, CLS=12.078)
  Batch 1100/1349: loss=16.0983 (NCE=13.762, CLS=11.679)
  Batch 1110/1349: loss=16.0238 (NCE=13.727, CLS=11.485)
  Batch 1120/1349: loss=16.6474 (NCE=14.232, CLS=12.079)
  Batch 1130/1349: loss=15.6239 (NCE=13.275, CLS=11.746)
  Batch 1140/1349: loss=16.3799 (NCE=13.953, CLS=12.136)
  Batch 1150/1349: loss=16.7603 (NCE=14.284, CLS=12.379)
  Batch 1160/1349: loss=15.3675 (NCE=13.065, CLS=11.513)
  Batch 1170/1349: loss=14.9180 (NCE=12.711, CLS=11.034)
  Batch 1180/1349: loss=16.1559 (NCE=13.900, CLS=11.281)
  Batch 1190/1349: loss=15.9866 (NCE=13.641, CLS=11.730)
  Batch 1200/1349: loss=15.0492 (NCE=12.758, CLS=11.455)
  Batch 1210/1349: loss=16.1358 (NCE=13.888, CLS=11.239)
  Batch 1220/1349: loss=15.7253 (NCE=13.330, CLS=11.979)
  Batch 1230/1349: loss=16.1054 (NCE=13.603, CLS=12.511)
  Batch 1240/1349: loss=15.7941 (NCE=13.450, CLS=11.721)
  Batch 1250/1349: loss=15.7306 (NCE=13.333, CLS=11.990)
  Batch 1260/1349: loss=15.4743 (NCE=13.262, CLS=11.064)
  Batch 1270/1349: loss=16.5276 (NCE=14.170, CLS=11.789)
  Batch 1280/1349: loss=16.3205 (NCE=13.705, CLS=13.079)
  Batch 1290/1349: loss=16.2066 (NCE=13.756, CLS=12.251)
  Batch 1300/1349: loss=16.0328 (NCE=13.696, CLS=11.686)
  Batch 1310/1349: loss=15.8291 (NCE=13.519, CLS=11.551)
  Batch 1320/1349: loss=15.4538 (NCE=13.193, CLS=11.302)
  Batch 1330/1349: loss=16.7837 (NCE=14.340, CLS=12.220)
  Batch 1340/1349: loss=16.4144 (NCE=14.024, CLS=11.950)
  Train: loss=15.9305 (NCE=13.576, CLS=11.774)
  Acc: HV=0.182, HJ=0.238, LV=0.194, LJ=0.124
  Val: loss=13.8094, R@10_HV=0.011

Epoch 24/100
  Batch 10/1349: loss=15.9022 (NCE=13.494, CLS=12.039)
  Batch 20/1349: loss=15.1475 (NCE=12.880, CLS=11.338)
  Batch 30/1349: loss=16.2405 (NCE=13.962, CLS=11.392)
  Batch 40/1349: loss=14.7981 (NCE=12.563, CLS=11.177)
  Batch 50/1349: loss=16.0667 (NCE=13.568, CLS=12.491)
  Batch 60/1349: loss=15.8891 (NCE=13.548, CLS=11.708)
  Batch 70/1349: loss=15.5973 (NCE=13.332, CLS=11.329)
  Batch 80/1349: loss=14.9097 (NCE=12.701, CLS=11.043)
  Batch 90/1349: loss=16.7673 (NCE=14.412, CLS=11.778)
  Batch 100/1349: loss=16.7184 (NCE=14.304, CLS=12.074)
  Batch 110/1349: loss=15.9580 (NCE=13.533, CLS=12.127)
  Batch 120/1349: loss=15.6694 (NCE=13.440, CLS=11.147)
  Batch 130/1349: loss=15.8655 (NCE=13.565, CLS=11.503)
  Batch 140/1349: loss=15.9559 (NCE=13.724, CLS=11.160)
  Batch 150/1349: loss=16.8257 (NCE=14.421, CLS=12.022)
  Batch 160/1349: loss=16.7820 (NCE=14.390, CLS=11.961)
  Batch 170/1349: loss=15.1038 (NCE=12.949, CLS=10.773)
  Batch 180/1349: loss=15.1204 (NCE=12.869, CLS=11.255)
  Batch 190/1349: loss=15.3743 (NCE=13.150, CLS=11.119)
  Batch 200/1349: loss=15.5680 (NCE=13.213, CLS=11.777)
  Batch 210/1349: loss=16.1002 (NCE=13.856, CLS=11.222)
  Batch 220/1349: loss=15.6746 (NCE=13.360, CLS=11.575)
  Batch 230/1349: loss=16.3410 (NCE=13.943, CLS=11.988)
  Batch 240/1349: loss=16.1716 (NCE=13.694, CLS=12.390)
  Batch 250/1349: loss=15.4110 (NCE=12.867, CLS=12.718)
  Batch 260/1349: loss=15.3325 (NCE=13.105, CLS=11.139)
  Batch 270/1349: loss=15.5844 (NCE=13.175, CLS=12.046)
  Batch 280/1349: loss=14.9539 (NCE=12.733, CLS=11.102)
  Batch 290/1349: loss=15.6248 (NCE=13.238, CLS=11.935)
  Batch 300/1349: loss=14.7377 (NCE=12.567, CLS=10.852)
  Batch 310/1349: loss=15.5947 (NCE=13.093, CLS=12.509)
  Batch 320/1349: loss=15.8251 (NCE=13.515, CLS=11.553)
  Batch 330/1349: loss=15.1235 (NCE=12.704, CLS=12.096)
  Batch 340/1349: loss=15.7372 (NCE=13.400, CLS=11.684)
  Batch 350/1349: loss=15.7210 (NCE=13.366, CLS=11.774)
  Batch 360/1349: loss=16.0319 (NCE=13.616, CLS=12.078)
  Batch 370/1349: loss=15.4426 (NCE=13.193, CLS=11.246)
  Batch 380/1349: loss=15.1836 (NCE=12.909, CLS=11.375)
  Batch 390/1349: loss=16.7034 (NCE=14.192, CLS=12.555)
  Batch 400/1349: loss=15.6165 (NCE=13.169, CLS=12.237)
  Batch 410/1349: loss=15.2449 (NCE=13.045, CLS=10.998)
  Batch 420/1349: loss=15.9860 (NCE=13.566, CLS=12.102)
  Batch 430/1349: loss=15.7068 (NCE=13.272, CLS=12.176)
  Batch 440/1349: loss=15.4471 (NCE=13.078, CLS=11.843)
  Batch 450/1349: loss=16.4746 (NCE=13.987, CLS=12.437)
  Batch 460/1349: loss=15.8921 (NCE=13.537, CLS=11.774)
  Batch 470/1349: loss=15.8314 (NCE=13.423, CLS=12.040)
  Batch 480/1349: loss=15.3127 (NCE=12.949, CLS=11.821)
  Batch 490/1349: loss=16.1001 (NCE=13.816, CLS=11.421)
  Batch 500/1349: loss=16.6477 (NCE=14.156, CLS=12.457)
  Batch 510/1349: loss=16.3435 (NCE=13.801, CLS=12.710)
  Batch 520/1349: loss=16.3726 (NCE=14.006, CLS=11.833)
  Batch 530/1349: loss=16.0572 (NCE=13.690, CLS=11.836)
  Batch 540/1349: loss=16.3165 (NCE=13.906, CLS=12.054)
  Batch 550/1349: loss=16.0255 (NCE=13.636, CLS=11.947)
  Batch 560/1349: loss=14.8900 (NCE=12.685, CLS=11.023)
  Batch 570/1349: loss=17.1018 (NCE=14.581, CLS=12.605)
  Batch 580/1349: loss=15.8219 (NCE=13.428, CLS=11.969)
  Batch 590/1349: loss=16.1301 (NCE=13.660, CLS=12.351)
  Batch 600/1349: loss=17.1214 (NCE=14.585, CLS=12.680)
  Batch 610/1349: loss=17.0964 (NCE=14.438, CLS=13.290)
  Batch 620/1349: loss=15.2614 (NCE=12.925, CLS=11.682)
  Batch 630/1349: loss=15.3656 (NCE=13.153, CLS=11.061)
  Batch 640/1349: loss=16.1374 (NCE=13.898, CLS=11.195)
  Batch 650/1349: loss=15.8646 (NCE=13.510, CLS=11.773)
  Batch 660/1349: loss=16.3920 (NCE=14.035, CLS=11.784)
  Batch 670/1349: loss=15.8755 (NCE=13.627, CLS=11.241)
  Batch 680/1349: loss=16.6550 (NCE=14.129, CLS=12.632)
  Batch 690/1349: loss=15.7532 (NCE=13.408, CLS=11.725)
  Batch 700/1349: loss=15.7582 (NCE=13.374, CLS=11.921)
  Batch 710/1349: loss=16.2596 (NCE=13.889, CLS=11.853)
  Batch 720/1349: loss=16.0527 (NCE=13.603, CLS=12.251)
  Batch 730/1349: loss=15.5829 (NCE=13.327, CLS=11.280)
  Batch 740/1349: loss=15.6906 (NCE=13.327, CLS=11.818)
  Batch 750/1349: loss=15.3536 (NCE=12.987, CLS=11.834)
  Batch 760/1349: loss=15.8930 (NCE=13.614, CLS=11.395)
  Batch 770/1349: loss=15.3161 (NCE=13.063, CLS=11.263)
  Batch 780/1349: loss=16.8540 (NCE=14.368, CLS=12.429)
  Batch 790/1349: loss=15.6959 (NCE=13.378, CLS=11.591)
  Batch 800/1349: loss=16.2308 (NCE=13.966, CLS=11.324)
  Batch 810/1349: loss=15.4905 (NCE=13.144, CLS=11.731)
  Batch 820/1349: loss=16.5003 (NCE=14.141, CLS=11.795)
  Batch 830/1349: loss=16.4801 (NCE=14.099, CLS=11.908)
  Batch 840/1349: loss=16.0707 (NCE=13.792, CLS=11.393)
  Batch 850/1349: loss=15.4251 (NCE=13.102, CLS=11.618)
  Batch 860/1349: loss=14.5980 (NCE=12.344, CLS=11.271)
  Batch 870/1349: loss=16.1849 (NCE=13.904, CLS=11.406)
  Batch 880/1349: loss=15.6528 (NCE=13.423, CLS=11.148)
  Batch 890/1349: loss=15.6378 (NCE=13.315, CLS=11.615)
  Batch 900/1349: loss=15.7808 (NCE=13.394, CLS=11.935)
  Batch 910/1349: loss=15.9269 (NCE=13.470, CLS=12.285)
  Batch 920/1349: loss=15.4940 (NCE=13.201, CLS=11.464)
  Batch 930/1349: loss=15.5420 (NCE=13.215, CLS=11.634)
  Batch 940/1349: loss=15.2005 (NCE=12.921, CLS=11.398)
  Batch 950/1349: loss=15.1614 (NCE=12.842, CLS=11.595)
  Batch 960/1349: loss=15.5661 (NCE=13.348, CLS=11.092)
  Batch 970/1349: loss=15.7450 (NCE=13.487, CLS=11.292)
  Batch 980/1349: loss=16.6548 (NCE=14.173, CLS=12.407)
  Batch 990/1349: loss=15.5301 (NCE=13.183, CLS=11.737)
  Batch 1000/1349: loss=16.0403 (NCE=13.647, CLS=11.966)
  Batch 1010/1349: loss=15.3028 (NCE=13.125, CLS=10.886)
  Batch 1020/1349: loss=15.8336 (NCE=13.577, CLS=11.284)
  Batch 1030/1349: loss=16.0925 (NCE=13.660, CLS=12.162)
  Batch 1040/1349: loss=16.0627 (NCE=13.801, CLS=11.310)
  Batch 1050/1349: loss=16.1777 (NCE=13.833, CLS=11.722)
  Batch 1060/1349: loss=16.4570 (NCE=14.075, CLS=11.911)
  Batch 1070/1349: loss=15.2282 (NCE=12.910, CLS=11.592)
  Batch 1080/1349: loss=16.5611 (NCE=14.030, CLS=12.653)
  Batch 1090/1349: loss=15.9528 (NCE=13.515, CLS=12.187)
  Batch 1100/1349: loss=17.0268 (NCE=14.403, CLS=13.120)
  Batch 1110/1349: loss=16.1222 (NCE=13.672, CLS=12.252)
  Batch 1120/1349: loss=17.2390 (NCE=14.534, CLS=13.527)
  Batch 1130/1349: loss=16.2533 (NCE=13.753, CLS=12.500)
  Batch 1140/1349: loss=16.2824 (NCE=13.800, CLS=12.414)
  Batch 1150/1349: loss=15.4256 (NCE=13.173, CLS=11.262)
  Batch 1160/1349: loss=16.5014 (NCE=14.112, CLS=11.949)
  Batch 1170/1349: loss=15.9515 (NCE=13.620, CLS=11.658)
  Batch 1180/1349: loss=16.2134 (NCE=13.784, CLS=12.145)
  Batch 1190/1349: loss=15.3364 (NCE=12.947, CLS=11.948)
  Batch 1200/1349: loss=14.5096 (NCE=12.253, CLS=11.284)
  Batch 1210/1349: loss=16.2876 (NCE=13.871, CLS=12.081)
  Batch 1220/1349: loss=16.5299 (NCE=14.168, CLS=11.810)
  Batch 1230/1349: loss=16.3047 (NCE=13.954, CLS=11.753)
  Batch 1240/1349: loss=16.5014 (NCE=14.188, CLS=11.565)
  Batch 1250/1349: loss=15.3851 (NCE=13.121, CLS=11.323)
  Batch 1260/1349: loss=16.9601 (NCE=14.449, CLS=12.555)
  Batch 1270/1349: loss=16.0052 (NCE=13.735, CLS=11.353)
  Batch 1280/1349: loss=15.7054 (NCE=13.303, CLS=12.014)
  Batch 1290/1349: loss=14.5898 (NCE=12.424, CLS=10.830)
  Batch 1300/1349: loss=16.3401 (NCE=13.999, CLS=11.703)
  Batch 1310/1349: loss=15.1688 (NCE=12.850, CLS=11.594)
  Batch 1320/1349: loss=15.3689 (NCE=13.152, CLS=11.083)
  Batch 1330/1349: loss=15.6379 (NCE=13.342, CLS=11.478)
  Batch 1340/1349: loss=17.0466 (NCE=14.460, CLS=12.930)
  Train: loss=15.9195 (NCE=13.567, CLS=11.764)
  Acc: HV=0.182, HJ=0.240, LV=0.194, LJ=0.125
  Val: loss=13.8289, R@10_HV=0.010

Epoch 25/100
  Batch 10/1349: loss=13.8437 (NCE=11.701, CLS=10.714)
  Batch 20/1349: loss=15.0019 (NCE=12.764, CLS=11.192)
  Batch 30/1349: loss=15.8266 (NCE=13.479, CLS=11.737)
  Batch 40/1349: loss=16.3552 (NCE=13.955, CLS=12.002)
  Batch 50/1349: loss=15.9708 (NCE=13.527, CLS=12.219)
  Batch 60/1349: loss=14.5464 (NCE=12.409, CLS=10.689)
  Batch 70/1349: loss=15.9136 (NCE=13.548, CLS=11.830)
  Batch 80/1349: loss=15.2119 (NCE=12.930, CLS=11.408)
  Batch 90/1349: loss=15.7168 (NCE=13.509, CLS=11.041)
  Batch 100/1349: loss=16.1009 (NCE=13.800, CLS=11.506)
  Batch 110/1349: loss=16.8086 (NCE=14.360, CLS=12.241)
  Batch 120/1349: loss=15.4400 (NCE=13.167, CLS=11.364)
  Batch 130/1349: loss=15.0257 (NCE=12.757, CLS=11.341)
  Batch 140/1349: loss=15.7696 (NCE=13.386, CLS=11.917)
  Batch 150/1349: loss=15.6669 (NCE=13.453, CLS=11.071)
  Batch 160/1349: loss=15.5669 (NCE=13.150, CLS=12.083)
  Batch 170/1349: loss=16.3117 (NCE=13.931, CLS=11.906)
  Batch 180/1349: loss=15.5128 (NCE=13.279, CLS=11.171)
  Batch 190/1349: loss=16.5398 (NCE=14.220, CLS=11.600)
  Batch 200/1349: loss=16.0176 (NCE=13.614, CLS=12.017)
  Batch 210/1349: loss=15.4677 (NCE=13.187, CLS=11.401)
  Batch 220/1349: loss=15.6481 (NCE=13.436, CLS=11.061)
  Batch 230/1349: loss=14.5907 (NCE=12.449, CLS=10.707)
  Batch 240/1349: loss=16.1560 (NCE=13.808, CLS=11.739)
  Batch 250/1349: loss=16.1777 (NCE=13.809, CLS=11.842)
  Batch 260/1349: loss=14.7240 (NCE=12.582, CLS=10.708)
  Batch 270/1349: loss=16.3287 (NCE=13.973, CLS=11.778)
  Batch 280/1349: loss=15.7368 (NCE=13.465, CLS=11.360)
  Batch 290/1349: loss=16.0125 (NCE=13.608, CLS=12.021)
  Batch 300/1349: loss=15.7937 (NCE=13.567, CLS=11.134)
  Batch 310/1349: loss=16.0751 (NCE=13.671, CLS=12.021)
  Batch 320/1349: loss=16.3334 (NCE=13.733, CLS=13.003)
  Batch 330/1349: loss=14.6759 (NCE=12.400, CLS=11.378)
  Batch 340/1349: loss=15.0002 (NCE=12.745, CLS=11.275)
  Batch 350/1349: loss=15.6602 (NCE=13.397, CLS=11.316)
  Batch 360/1349: loss=16.4029 (NCE=13.886, CLS=12.583)
  Batch 370/1349: loss=15.7221 (NCE=13.398, CLS=11.622)
  Batch 380/1349: loss=16.2931 (NCE=13.952, CLS=11.707)
  Batch 390/1349: loss=16.6450 (NCE=14.264, CLS=11.907)
  Batch 400/1349: loss=16.5023 (NCE=14.190, CLS=11.562)
  Batch 410/1349: loss=16.2680 (NCE=14.002, CLS=11.330)
  Batch 420/1349: loss=15.4064 (NCE=13.184, CLS=11.114)
  Batch 430/1349: loss=15.3363 (NCE=13.205, CLS=10.657)
  Batch 440/1349: loss=16.4524 (NCE=13.995, CLS=12.286)
  Batch 450/1349: loss=16.0698 (NCE=13.700, CLS=11.850)
  Batch 460/1349: loss=16.6953 (NCE=14.248, CLS=12.237)
  Batch 470/1349: loss=16.5819 (NCE=14.059, CLS=12.616)
  Batch 480/1349: loss=16.5982 (NCE=14.203, CLS=11.975)
  Batch 490/1349: loss=16.0425 (NCE=13.829, CLS=11.065)
  Batch 500/1349: loss=15.8863 (NCE=13.461, CLS=12.126)
  Batch 510/1349: loss=16.1580 (NCE=13.913, CLS=11.227)
  Batch 520/1349: loss=14.3815 (NCE=12.254, CLS=10.639)
  Batch 530/1349: loss=15.4444 (NCE=13.218, CLS=11.131)
  Batch 540/1349: loss=15.2081 (NCE=13.051, CLS=10.788)
  Batch 550/1349: loss=16.2620 (NCE=13.733, CLS=12.645)
  Batch 560/1349: loss=15.0486 (NCE=12.897, CLS=10.759)
  Batch 570/1349: loss=15.7098 (NCE=13.416, CLS=11.467)
  Batch 580/1349: loss=15.9011 (NCE=13.511, CLS=11.953)
  Batch 590/1349: loss=15.7051 (NCE=13.485, CLS=11.100)
  Batch 600/1349: loss=16.3904 (NCE=14.000, CLS=11.951)
  Batch 610/1349: loss=16.2845 (NCE=13.864, CLS=12.101)
  Batch 620/1349: loss=15.9037 (NCE=13.544, CLS=11.800)
  Batch 630/1349: loss=16.1065 (NCE=13.624, CLS=12.415)
  Batch 640/1349: loss=16.6574 (NCE=14.211, CLS=12.234)
  Batch 650/1349: loss=13.9126 (NCE=11.749, CLS=10.819)
  Batch 660/1349: loss=16.0921 (NCE=13.690, CLS=12.010)
  Batch 670/1349: loss=16.1706 (NCE=13.861, CLS=11.547)
  Batch 680/1349: loss=16.4439 (NCE=14.045, CLS=11.996)
  Batch 690/1349: loss=15.5109 (NCE=13.213, CLS=11.491)
  Batch 700/1349: loss=15.7360 (NCE=13.480, CLS=11.280)
  Batch 710/1349: loss=16.4792 (NCE=14.092, CLS=11.937)
  Batch 720/1349: loss=15.2799 (NCE=12.860, CLS=12.102)
  Batch 730/1349: loss=17.0024 (NCE=14.495, CLS=12.537)
  Batch 740/1349: loss=16.1654 (NCE=13.679, CLS=12.433)
  Batch 750/1349: loss=16.4778 (NCE=14.108, CLS=11.847)
  Batch 760/1349: loss=15.9780 (NCE=13.638, CLS=11.699)
  Batch 770/1349: loss=16.2822 (NCE=13.832, CLS=12.252)
  Batch 780/1349: loss=16.5454 (NCE=14.035, CLS=12.553)
  Batch 790/1349: loss=16.1452 (NCE=13.794, CLS=11.756)
  Batch 800/1349: loss=15.9935 (NCE=13.752, CLS=11.206)
  Batch 810/1349: loss=16.0264 (NCE=13.687, CLS=11.695)
  Batch 820/1349: loss=15.6973 (NCE=13.467, CLS=11.150)
  Batch 830/1349: loss=15.8097 (NCE=13.411, CLS=11.996)
  Batch 840/1349: loss=15.0092 (NCE=12.825, CLS=10.921)
  Batch 850/1349: loss=14.8785 (NCE=12.680, CLS=10.992)
  Batch 860/1349: loss=15.1992 (NCE=12.927, CLS=11.362)
  Batch 870/1349: loss=15.5095 (NCE=13.256, CLS=11.265)
  Batch 880/1349: loss=16.0917 (NCE=13.753, CLS=11.694)
  Batch 890/1349: loss=15.8445 (NCE=13.563, CLS=11.407)
  Batch 900/1349: loss=16.1012 (NCE=13.681, CLS=12.100)
  Batch 910/1349: loss=15.7183 (NCE=13.388, CLS=11.653)
  Batch 920/1349: loss=15.7639 (NCE=13.457, CLS=11.535)
  Batch 930/1349: loss=15.8916 (NCE=13.537, CLS=11.773)
  Batch 940/1349: loss=15.6797 (NCE=13.300, CLS=11.898)
  Batch 950/1349: loss=16.0047 (NCE=13.707, CLS=11.488)
  Batch 960/1349: loss=15.7149 (NCE=13.161, CLS=12.769)
  Batch 970/1349: loss=15.2856 (NCE=13.016, CLS=11.349)
  Batch 980/1349: loss=16.1671 (NCE=13.805, CLS=11.809)
  Batch 990/1349: loss=15.9025 (NCE=13.543, CLS=11.798)
  Batch 1000/1349: loss=16.5665 (NCE=14.177, CLS=11.949)
  Batch 1010/1349: loss=16.5767 (NCE=14.229, CLS=11.741)
  Batch 1020/1349: loss=16.2663 (NCE=13.892, CLS=11.870)
  Batch 1030/1349: loss=15.8689 (NCE=13.542, CLS=11.635)
  Batch 1040/1349: loss=15.5935 (NCE=13.246, CLS=11.737)
  Batch 1050/1349: loss=16.0327 (NCE=13.694, CLS=11.695)
  Batch 1060/1349: loss=14.6803 (NCE=12.431, CLS=11.246)
  Batch 1070/1349: loss=15.7140 (NCE=13.275, CLS=12.194)
  Batch 1080/1349: loss=16.1850 (NCE=13.935, CLS=11.250)
  Batch 1090/1349: loss=15.5560 (NCE=13.221, CLS=11.678)
  Batch 1100/1349: loss=15.5706 (NCE=13.285, CLS=11.427)
  Batch 1110/1349: loss=14.8736 (NCE=12.715, CLS=10.795)
  Batch 1120/1349: loss=15.6409 (NCE=13.295, CLS=11.731)
  Batch 1130/1349: loss=16.1888 (NCE=13.747, CLS=12.208)
  Batch 1140/1349: loss=15.3814 (NCE=13.244, CLS=10.688)
  Batch 1150/1349: loss=16.2604 (NCE=13.834, CLS=12.132)
  Batch 1160/1349: loss=16.7928 (NCE=14.443, CLS=11.749)
  Batch 1170/1349: loss=16.1102 (NCE=13.757, CLS=11.764)
  Batch 1180/1349: loss=15.6528 (NCE=13.360, CLS=11.463)
  Batch 1190/1349: loss=15.4325 (NCE=13.266, CLS=10.832)
  Batch 1200/1349: loss=15.6479 (NCE=13.213, CLS=12.176)
  Batch 1210/1349: loss=15.9127 (NCE=13.508, CLS=12.023)
  Batch 1220/1349: loss=15.8711 (NCE=13.459, CLS=12.059)
  Batch 1230/1349: loss=15.4004 (NCE=12.961, CLS=12.198)
  Batch 1240/1349: loss=15.1193 (NCE=12.821, CLS=11.492)
  Batch 1250/1349: loss=16.6061 (NCE=14.040, CLS=12.830)
  Batch 1260/1349: loss=15.9168 (NCE=13.495, CLS=12.111)
  Batch 1270/1349: loss=16.0221 (NCE=13.662, CLS=11.801)
  Batch 1280/1349: loss=15.4213 (NCE=13.134, CLS=11.437)
  Batch 1290/1349: loss=15.3739 (NCE=13.101, CLS=11.366)
  Batch 1300/1349: loss=14.0594 (NCE=11.936, CLS=10.616)
  Batch 1310/1349: loss=16.0937 (NCE=13.778, CLS=11.577)
  Batch 1320/1349: loss=16.4789 (NCE=14.169, CLS=11.552)
  Batch 1330/1349: loss=16.0693 (NCE=13.605, CLS=12.319)
  Batch 1340/1349: loss=16.3534 (NCE=13.737, CLS=13.083)
  Train: loss=15.9037 (NCE=13.553, CLS=11.753)
  Acc: HV=0.182, HJ=0.239, LV=0.191, LJ=0.126
  Val: loss=13.8182, R@10_HV=0.010

Epoch 26/100
  Batch 10/1349: loss=16.3820 (NCE=14.010, CLS=11.860)
  Batch 20/1349: loss=15.5115 (NCE=13.164, CLS=11.739)
  Batch 30/1349: loss=15.9405 (NCE=13.593, CLS=11.736)
  Batch 40/1349: loss=15.7436 (NCE=13.436, CLS=11.539)
  Batch 50/1349: loss=15.3780 (NCE=13.120, CLS=11.292)
  Batch 60/1349: loss=16.7350 (NCE=14.230, CLS=12.527)
  Batch 70/1349: loss=16.0986 (NCE=13.771, CLS=11.638)
  Batch 80/1349: loss=15.3646 (NCE=13.154, CLS=11.051)
  Batch 90/1349: loss=15.6240 (NCE=13.314, CLS=11.551)
  Batch 100/1349: loss=15.8284 (NCE=13.434, CLS=11.973)
  Batch 110/1349: loss=15.4740 (NCE=13.255, CLS=11.096)
  Batch 120/1349: loss=16.0607 (NCE=13.720, CLS=11.705)
  Batch 130/1349: loss=15.3421 (NCE=13.178, CLS=10.819)
  Batch 140/1349: loss=16.4802 (NCE=14.073, CLS=12.036)
  Batch 150/1349: loss=15.2872 (NCE=12.913, CLS=11.870)
  Batch 160/1349: loss=15.3282 (NCE=13.056, CLS=11.363)
  Batch 170/1349: loss=16.4194 (NCE=13.898, CLS=12.608)
  Batch 180/1349: loss=16.2875 (NCE=13.966, CLS=11.605)
  Batch 190/1349: loss=16.0673 (NCE=13.648, CLS=12.098)
  Batch 200/1349: loss=16.4187 (NCE=13.975, CLS=12.218)
  Batch 210/1349: loss=16.1810 (NCE=13.745, CLS=12.178)
  Batch 220/1349: loss=15.6655 (NCE=13.430, CLS=11.177)
  Batch 230/1349: loss=17.3336 (NCE=14.774, CLS=12.800)
  Batch 240/1349: loss=15.5650 (NCE=13.350, CLS=11.076)
  Batch 250/1349: loss=14.8464 (NCE=12.657, CLS=10.948)
  Batch 260/1349: loss=16.0338 (NCE=13.634, CLS=11.998)
  Batch 270/1349: loss=15.9786 (NCE=13.622, CLS=11.781)
  Batch 280/1349: loss=15.6980 (NCE=13.452, CLS=11.230)
  Batch 290/1349: loss=15.2906 (NCE=13.045, CLS=11.227)
  Batch 300/1349: loss=16.0217 (NCE=13.773, CLS=11.243)
  Batch 310/1349: loss=15.4052 (NCE=13.186, CLS=11.096)
  Batch 320/1349: loss=15.9006 (NCE=13.637, CLS=11.318)
  Batch 330/1349: loss=15.3974 (NCE=13.079, CLS=11.592)
  Batch 340/1349: loss=16.2332 (NCE=13.782, CLS=12.257)
  Batch 350/1349: loss=15.4479 (NCE=13.132, CLS=11.577)
  Batch 360/1349: loss=16.0127 (NCE=13.805, CLS=11.041)
  Batch 370/1349: loss=16.1046 (NCE=13.654, CLS=12.255)
  Batch 380/1349: loss=15.8545 (NCE=13.499, CLS=11.779)
  Batch 390/1349: loss=15.6916 (NCE=13.446, CLS=11.228)
  Batch 400/1349: loss=16.3207 (NCE=14.007, CLS=11.569)
  Batch 410/1349: loss=17.3760 (NCE=14.868, CLS=12.542)
  Batch 420/1349: loss=16.0048 (NCE=13.719, CLS=11.430)
  Batch 430/1349: loss=15.7311 (NCE=13.415, CLS=11.581)
  Batch 440/1349: loss=16.4961 (NCE=14.145, CLS=11.757)
  Batch 450/1349: loss=15.6157 (NCE=13.353, CLS=11.313)
  Batch 460/1349: loss=15.9905 (NCE=13.445, CLS=12.727)
  Batch 470/1349: loss=16.6363 (NCE=14.340, CLS=11.480)
  Batch 480/1349: loss=15.4495 (NCE=13.314, CLS=10.680)
  Batch 490/1349: loss=16.4238 (NCE=13.986, CLS=12.191)
  Batch 500/1349: loss=15.7411 (NCE=13.307, CLS=12.169)
  Batch 510/1349: loss=15.8722 (NCE=13.618, CLS=11.273)
  Batch 520/1349: loss=16.0358 (NCE=13.702, CLS=11.669)
  Batch 530/1349: loss=16.0096 (NCE=13.421, CLS=12.944)
  Batch 540/1349: loss=17.0862 (NCE=14.536, CLS=12.752)
  Batch 550/1349: loss=16.5686 (NCE=14.083, CLS=12.426)
  Batch 560/1349: loss=15.9078 (NCE=13.560, CLS=11.737)
  Batch 570/1349: loss=15.6421 (NCE=13.414, CLS=11.140)
  Batch 580/1349: loss=15.8231 (NCE=13.561, CLS=11.310)
  Batch 590/1349: loss=14.9771 (NCE=12.810, CLS=10.837)
  Batch 600/1349: loss=15.4687 (NCE=13.135, CLS=11.667)
  Batch 610/1349: loss=15.2819 (NCE=13.150, CLS=10.661)
  Batch 620/1349: loss=15.5672 (NCE=13.084, CLS=12.416)
  Batch 630/1349: loss=15.1874 (NCE=12.851, CLS=11.682)
  Batch 640/1349: loss=15.8075 (NCE=13.468, CLS=11.698)
  Batch 650/1349: loss=16.2883 (NCE=13.913, CLS=11.878)
  Batch 660/1349: loss=15.7041 (NCE=13.308, CLS=11.978)
  Batch 670/1349: loss=15.0354 (NCE=12.826, CLS=11.047)
  Batch 680/1349: loss=16.0495 (NCE=13.728, CLS=11.610)
  Batch 690/1349: loss=14.8055 (NCE=12.526, CLS=11.399)
  Batch 700/1349: loss=16.5335 (NCE=14.085, CLS=12.243)
  Batch 710/1349: loss=16.1201 (NCE=13.773, CLS=11.735)
  Batch 720/1349: loss=16.2559 (NCE=13.906, CLS=11.751)
  Batch 730/1349: loss=16.5061 (NCE=14.061, CLS=12.227)
  Batch 740/1349: loss=15.8878 (NCE=13.538, CLS=11.747)
  Batch 750/1349: loss=16.7392 (NCE=14.336, CLS=12.015)
  Batch 760/1349: loss=16.2197 (NCE=13.717, CLS=12.512)
  Batch 770/1349: loss=16.0579 (NCE=13.656, CLS=12.011)
  Batch 780/1349: loss=16.0956 (NCE=13.670, CLS=12.129)
  Batch 790/1349: loss=15.9388 (NCE=13.558, CLS=11.904)
  Batch 800/1349: loss=14.9643 (NCE=12.834, CLS=10.649)
  Batch 810/1349: loss=15.8191 (NCE=13.530, CLS=11.443)
  Batch 820/1349: loss=15.3102 (NCE=13.032, CLS=11.389)
  Batch 830/1349: loss=16.2934 (NCE=13.957, CLS=11.683)
  Batch 840/1349: loss=16.7136 (NCE=14.303, CLS=12.051)
  Batch 850/1349: loss=16.5664 (NCE=14.153, CLS=12.066)
  Batch 860/1349: loss=16.5689 (NCE=14.169, CLS=12.001)
  Batch 870/1349: loss=15.8790 (NCE=13.608, CLS=11.354)
  Batch 880/1349: loss=16.3321 (NCE=13.849, CLS=12.413)
  Batch 890/1349: loss=16.1613 (NCE=13.841, CLS=11.602)
  Batch 900/1349: loss=16.0356 (NCE=13.576, CLS=12.300)
  Batch 910/1349: loss=15.3602 (NCE=13.099, CLS=11.305)
  Batch 920/1349: loss=16.2363 (NCE=13.754, CLS=12.414)
  Batch 930/1349: loss=15.9573 (NCE=13.651, CLS=11.534)
  Batch 940/1349: loss=16.3215 (NCE=14.035, CLS=11.434)
  Batch 950/1349: loss=15.2068 (NCE=13.078, CLS=10.644)
  Batch 960/1349: loss=16.7582 (NCE=14.337, CLS=12.106)
  Batch 970/1349: loss=15.8243 (NCE=13.427, CLS=11.986)
  Batch 980/1349: loss=16.0091 (NCE=13.581, CLS=12.141)
  Batch 990/1349: loss=15.6464 (NCE=13.325, CLS=11.609)
  Batch 1000/1349: loss=16.5271 (NCE=14.115, CLS=12.063)
  Batch 1010/1349: loss=16.4123 (NCE=13.956, CLS=12.284)
  Batch 1020/1349: loss=15.8875 (NCE=13.519, CLS=11.840)
  Batch 1030/1349: loss=15.5920 (NCE=13.386, CLS=11.030)
  Batch 1040/1349: loss=16.1595 (NCE=13.655, CLS=12.522)
  Batch 1050/1349: loss=15.7078 (NCE=13.388, CLS=11.601)
  Batch 1060/1349: loss=16.2825 (NCE=13.753, CLS=12.646)
  Batch 1070/1349: loss=16.7092 (NCE=14.174, CLS=12.674)
  Batch 1080/1349: loss=16.4613 (NCE=14.088, CLS=11.867)
  Batch 1090/1349: loss=15.8771 (NCE=13.452, CLS=12.126)
  Batch 1100/1349: loss=16.2555 (NCE=13.894, CLS=11.805)
  Batch 1110/1349: loss=16.4378 (NCE=14.089, CLS=11.743)
  Batch 1120/1349: loss=16.3091 (NCE=13.791, CLS=12.592)
  Batch 1130/1349: loss=16.4644 (NCE=14.029, CLS=12.177)
  Batch 1140/1349: loss=16.7882 (NCE=14.383, CLS=12.025)
  Batch 1150/1349: loss=15.8033 (NCE=13.481, CLS=11.613)
  Batch 1160/1349: loss=16.3510 (NCE=13.960, CLS=11.955)
  Batch 1170/1349: loss=16.6242 (NCE=14.142, CLS=12.409)
  Batch 1180/1349: loss=16.2570 (NCE=13.937, CLS=11.599)
  Batch 1190/1349: loss=16.6388 (NCE=14.217, CLS=12.108)
  Batch 1200/1349: loss=15.7479 (NCE=13.248, CLS=12.501)
  Batch 1210/1349: loss=15.9704 (NCE=13.721, CLS=11.246)
  Batch 1220/1349: loss=15.3772 (NCE=13.109, CLS=11.339)
  Batch 1230/1349: loss=15.9284 (NCE=13.582, CLS=11.729)
  Batch 1240/1349: loss=15.5816 (NCE=13.203, CLS=11.891)
  Batch 1250/1349: loss=16.4725 (NCE=13.961, CLS=12.557)
  Batch 1260/1349: loss=16.5051 (NCE=14.162, CLS=11.717)
  Batch 1270/1349: loss=16.0835 (NCE=13.764, CLS=11.596)
  Batch 1280/1349: loss=15.6453 (NCE=13.207, CLS=12.194)
  Batch 1290/1349: loss=14.6015 (NCE=12.391, CLS=11.054)
  Batch 1300/1349: loss=15.4527 (NCE=13.171, CLS=11.410)
  Batch 1310/1349: loss=16.5030 (NCE=14.028, CLS=12.373)
  Batch 1320/1349: loss=16.2169 (NCE=13.726, CLS=12.455)
  Batch 1330/1349: loss=15.9185 (NCE=13.687, CLS=11.156)
  Batch 1340/1349: loss=16.2116 (NCE=13.941, CLS=11.355)
  Train: loss=15.8982 (NCE=13.550, CLS=11.744)
  Acc: HV=0.182, HJ=0.239, LV=0.195, LJ=0.125
  Val: loss=13.8354, R@10_HV=0.010

Epoch 27/100
  Batch 10/1349: loss=16.1874 (NCE=13.686, CLS=12.509)
  Batch 20/1349: loss=15.0473 (NCE=12.877, CLS=10.849)
  Batch 30/1349: loss=14.8488 (NCE=12.709, CLS=10.697)
  Batch 40/1349: loss=15.1723 (NCE=12.898, CLS=11.370)
  Batch 50/1349: loss=16.3600 (NCE=13.905, CLS=12.276)
  Batch 60/1349: loss=16.6209 (NCE=14.201, CLS=12.100)
  Batch 70/1349: loss=15.2817 (NCE=13.002, CLS=11.397)
  Batch 80/1349: loss=14.9728 (NCE=12.793, CLS=10.899)
  Batch 90/1349: loss=15.8187 (NCE=13.407, CLS=12.056)
  Batch 100/1349: loss=14.9119 (NCE=12.631, CLS=11.406)
  Batch 110/1349: loss=15.6876 (NCE=13.506, CLS=10.907)
  Batch 120/1349: loss=15.0172 (NCE=12.882, CLS=10.675)
  Batch 130/1349: loss=15.8784 (NCE=13.527, CLS=11.759)
  Batch 140/1349: loss=16.2134 (NCE=13.932, CLS=11.405)
  Batch 150/1349: loss=16.6577 (NCE=14.251, CLS=12.032)
  Batch 160/1349: loss=16.5238 (NCE=14.141, CLS=11.913)
  Batch 170/1349: loss=15.8281 (NCE=13.463, CLS=11.826)
  Batch 180/1349: loss=15.5775 (NCE=13.199, CLS=11.893)
  Batch 190/1349: loss=15.9106 (NCE=13.389, CLS=12.609)
  Batch 200/1349: loss=16.3536 (NCE=13.967, CLS=11.932)
  Batch 210/1349: loss=16.1910 (NCE=13.787, CLS=12.018)
  Batch 220/1349: loss=16.3921 (NCE=13.838, CLS=12.773)
  Batch 230/1349: loss=16.0598 (NCE=13.730, CLS=11.651)
  Batch 240/1349: loss=14.7793 (NCE=12.551, CLS=11.141)
  Batch 250/1349: loss=15.5774 (NCE=13.309, CLS=11.342)
  Batch 260/1349: loss=15.5122 (NCE=13.177, CLS=11.675)
  Batch 270/1349: loss=16.4926 (NCE=14.126, CLS=11.833)
  Batch 280/1349: loss=16.6234 (NCE=14.164, CLS=12.295)
  Batch 290/1349: loss=14.9769 (NCE=12.828, CLS=10.745)
  Batch 300/1349: loss=15.2513 (NCE=13.057, CLS=10.971)
  Batch 310/1349: loss=15.3582 (NCE=13.157, CLS=11.008)
  Batch 320/1349: loss=16.8711 (NCE=14.332, CLS=12.695)
  Batch 330/1349: loss=16.0960 (NCE=13.766, CLS=11.649)
  Batch 340/1349: loss=16.5178 (NCE=14.172, CLS=11.731)
  Batch 350/1349: loss=16.7798 (NCE=14.321, CLS=12.293)
  Batch 360/1349: loss=16.1707 (NCE=13.923, CLS=11.239)
  Batch 370/1349: loss=17.0445 (NCE=14.592, CLS=12.263)
  Batch 380/1349: loss=14.9140 (NCE=12.632, CLS=11.411)
  Batch 390/1349: loss=15.8893 (NCE=13.501, CLS=11.942)
  Batch 400/1349: loss=14.8992 (NCE=12.690, CLS=11.048)
  Batch 410/1349: loss=15.0002 (NCE=12.778, CLS=11.110)
  Batch 420/1349: loss=16.0841 (NCE=13.746, CLS=11.692)
  Batch 430/1349: loss=16.1224 (NCE=13.693, CLS=12.147)
  Batch 440/1349: loss=16.1361 (NCE=13.821, CLS=11.575)
  Batch 450/1349: loss=16.9747 (NCE=14.468, CLS=12.533)
  Batch 460/1349: loss=14.7102 (NCE=12.255, CLS=12.276)
  Batch 470/1349: loss=16.4302 (NCE=14.098, CLS=11.662)
  Batch 480/1349: loss=16.3877 (NCE=13.980, CLS=12.038)
  Batch 490/1349: loss=16.5732 (NCE=14.045, CLS=12.639)
  Batch 500/1349: loss=16.6905 (NCE=14.302, CLS=11.944)
  Batch 510/1349: loss=15.5539 (NCE=13.366, CLS=10.940)
  Batch 520/1349: loss=15.5976 (NCE=13.256, CLS=11.707)
  Batch 530/1349: loss=15.3942 (NCE=13.116, CLS=11.393)
  Batch 540/1349: loss=16.4392 (NCE=14.078, CLS=11.805)
  Batch 550/1349: loss=16.5463 (NCE=14.164, CLS=11.914)
  Batch 560/1349: loss=16.5894 (NCE=14.171, CLS=12.092)
  Batch 570/1349: loss=16.4103 (NCE=13.997, CLS=12.068)
  Batch 580/1349: loss=16.5036 (NCE=14.054, CLS=12.248)
  Batch 590/1349: loss=15.8397 (NCE=13.558, CLS=11.411)
  Batch 600/1349: loss=16.7998 (NCE=14.291, CLS=12.541)
  Batch 610/1349: loss=16.4687 (NCE=14.179, CLS=11.446)
  Batch 620/1349: loss=15.8388 (NCE=13.544, CLS=11.474)
  Batch 630/1349: loss=15.6375 (NCE=13.480, CLS=10.787)
  Batch 640/1349: loss=16.2544 (NCE=13.877, CLS=11.888)
  Batch 650/1349: loss=15.6537 (NCE=13.446, CLS=11.040)
  Batch 660/1349: loss=17.1864 (NCE=14.717, CLS=12.346)
  Batch 670/1349: loss=15.9807 (NCE=13.658, CLS=11.614)
  Batch 680/1349: loss=15.3559 (NCE=12.947, CLS=12.045)
  Batch 690/1349: loss=15.5995 (NCE=13.328, CLS=11.357)
  Batch 700/1349: loss=15.7740 (NCE=13.466, CLS=11.542)
  Batch 710/1349: loss=15.0373 (NCE=12.728, CLS=11.549)
  Batch 720/1349: loss=16.0512 (NCE=13.668, CLS=11.915)
  Batch 730/1349: loss=15.5539 (NCE=13.283, CLS=11.355)
  Batch 740/1349: loss=16.1839 (NCE=13.821, CLS=11.814)
  Batch 750/1349: loss=15.1709 (NCE=12.946, CLS=11.123)
  Batch 760/1349: loss=14.3684 (NCE=12.218, CLS=10.754)
  Batch 770/1349: loss=15.9932 (NCE=13.687, CLS=11.534)
  Batch 780/1349: loss=15.3934 (NCE=13.020, CLS=11.869)
  Batch 790/1349: loss=16.5486 (NCE=14.220, CLS=11.644)
  Batch 800/1349: loss=16.6171 (NCE=14.211, CLS=12.030)
  Batch 810/1349: loss=15.6412 (NCE=13.357, CLS=11.423)
  Batch 820/1349: loss=16.0295 (NCE=13.712, CLS=11.585)
  Batch 830/1349: loss=14.5600 (NCE=12.456, CLS=10.519)
  Batch 840/1349: loss=15.8328 (NCE=13.593, CLS=11.202)
  Batch 850/1349: loss=15.5380 (NCE=13.257, CLS=11.404)
  Batch 860/1349: loss=15.4597 (NCE=13.267, CLS=10.964)
  Batch 870/1349: loss=15.2125 (NCE=12.910, CLS=11.511)
  Batch 880/1349: loss=16.2109 (NCE=13.848, CLS=11.815)
  Batch 890/1349: loss=15.8054 (NCE=13.548, CLS=11.285)
  Batch 900/1349: loss=15.2508 (NCE=13.001, CLS=11.246)
  Batch 910/1349: loss=15.4440 (NCE=13.142, CLS=11.511)
  Batch 920/1349: loss=15.9781 (NCE=13.578, CLS=12.001)
  Batch 930/1349: loss=16.5228 (NCE=14.150, CLS=11.866)
  Batch 940/1349: loss=15.3825 (NCE=13.275, CLS=10.540)
  Batch 950/1349: loss=15.6175 (NCE=13.172, CLS=12.228)
  Batch 960/1349: loss=16.2060 (NCE=13.805, CLS=12.004)
  Batch 970/1349: loss=16.7394 (NCE=14.274, CLS=12.326)
  Batch 980/1349: loss=16.2630 (NCE=13.950, CLS=11.565)
  Batch 990/1349: loss=15.8455 (NCE=13.562, CLS=11.416)
  Batch 1000/1349: loss=16.0992 (NCE=13.826, CLS=11.366)
  Batch 1010/1349: loss=16.0251 (NCE=13.652, CLS=11.865)
  Batch 1020/1349: loss=16.5847 (NCE=14.221, CLS=11.820)
  Batch 1030/1349: loss=16.3904 (NCE=14.031, CLS=11.795)
  Batch 1040/1349: loss=15.8580 (NCE=13.517, CLS=11.706)
  Batch 1050/1349: loss=15.3291 (NCE=12.988, CLS=11.707)
  Batch 1060/1349: loss=15.9762 (NCE=13.534, CLS=12.210)
  Batch 1070/1349: loss=15.7388 (NCE=13.435, CLS=11.518)
  Batch 1080/1349: loss=15.2458 (NCE=12.884, CLS=11.810)
  Batch 1090/1349: loss=14.5561 (NCE=12.288, CLS=11.339)
  Batch 1100/1349: loss=15.8211 (NCE=13.598, CLS=11.115)
  Batch 1110/1349: loss=16.0982 (NCE=13.795, CLS=11.518)
  Batch 1120/1349: loss=14.7470 (NCE=12.397, CLS=11.748)
  Batch 1130/1349: loss=16.0634 (NCE=13.728, CLS=11.674)
  Batch 1140/1349: loss=16.3880 (NCE=13.888, CLS=12.501)
  Batch 1150/1349: loss=15.8212 (NCE=13.309, CLS=12.561)
  Batch 1160/1349: loss=16.3891 (NCE=13.907, CLS=12.410)
  Batch 1170/1349: loss=16.2343 (NCE=13.781, CLS=12.265)
  Batch 1180/1349: loss=14.9346 (NCE=12.742, CLS=10.965)
  Batch 1190/1349: loss=16.0094 (NCE=13.571, CLS=12.194)
  Batch 1200/1349: loss=16.3714 (NCE=13.891, CLS=12.404)
  Batch 1210/1349: loss=15.2635 (NCE=12.942, CLS=11.605)
  Batch 1220/1349: loss=16.0536 (NCE=13.626, CLS=12.136)
  Batch 1230/1349: loss=16.3843 (NCE=13.939, CLS=12.225)
  Batch 1240/1349: loss=16.0020 (NCE=13.641, CLS=11.808)
  Batch 1250/1349: loss=15.6394 (NCE=13.358, CLS=11.406)
  Batch 1260/1349: loss=15.3473 (NCE=13.164, CLS=10.918)
  Batch 1270/1349: loss=15.6167 (NCE=13.311, CLS=11.528)
  Batch 1280/1349: loss=16.4758 (NCE=14.049, CLS=12.132)
  Batch 1290/1349: loss=15.3785 (NCE=13.064, CLS=11.571)
  Batch 1300/1349: loss=15.5045 (NCE=13.125, CLS=11.898)
  Batch 1310/1349: loss=15.8700 (NCE=13.527, CLS=11.713)
  Batch 1320/1349: loss=15.3550 (NCE=13.029, CLS=11.632)
  Batch 1330/1349: loss=17.0689 (NCE=14.582, CLS=12.436)
  Batch 1340/1349: loss=16.0314 (NCE=13.761, CLS=11.353)
  Train: loss=15.8877 (NCE=13.541, CLS=11.735)
  Acc: HV=0.182, HJ=0.240, LV=0.194, LJ=0.125
  Val: loss=13.8070, R@10_HV=0.011

Epoch 28/100
  Batch 10/1349: loss=16.0209 (NCE=13.584, CLS=12.186)
  Batch 20/1349: loss=16.0642 (NCE=13.682, CLS=11.912)
  Batch 30/1349: loss=15.8548 (NCE=13.623, CLS=11.159)
  Batch 40/1349: loss=16.2260 (NCE=13.822, CLS=12.020)
  Batch 50/1349: loss=15.3500 (NCE=13.084, CLS=11.332)
  Batch 60/1349: loss=16.3063 (NCE=13.906, CLS=12.004)
  Batch 70/1349: loss=14.7296 (NCE=12.430, CLS=11.497)
  Batch 80/1349: loss=16.4458 (NCE=14.016, CLS=12.147)
  Batch 90/1349: loss=15.0801 (NCE=12.886, CLS=10.972)
  Batch 100/1349: loss=15.5119 (NCE=13.168, CLS=11.718)
  Batch 110/1349: loss=16.6612 (NCE=14.073, CLS=12.939)
  Batch 120/1349: loss=15.7259 (NCE=13.458, CLS=11.341)
  Batch 130/1349: loss=15.5606 (NCE=13.315, CLS=11.229)
  Batch 140/1349: loss=16.3973 (NCE=13.935, CLS=12.309)
  Batch 150/1349: loss=16.4104 (NCE=13.950, CLS=12.300)
  Batch 160/1349: loss=16.6351 (NCE=14.202, CLS=12.166)
  Batch 170/1349: loss=16.4518 (NCE=13.864, CLS=12.939)
  Batch 180/1349: loss=16.1141 (NCE=13.676, CLS=12.192)
  Batch 190/1349: loss=15.6863 (NCE=13.308, CLS=11.889)
  Batch 200/1349: loss=16.3576 (NCE=13.971, CLS=11.931)
  Batch 210/1349: loss=15.6645 (NCE=13.334, CLS=11.653)
  Batch 220/1349: loss=15.1301 (NCE=12.869, CLS=11.304)
  Batch 230/1349: loss=16.2190 (NCE=13.864, CLS=11.775)
  Batch 240/1349: loss=15.0092 (NCE=12.782, CLS=11.137)
  Batch 250/1349: loss=15.5981 (NCE=13.341, CLS=11.288)
  Batch 260/1349: loss=16.3481 (NCE=14.003, CLS=11.725)
  Batch 270/1349: loss=15.9935 (NCE=13.683, CLS=11.551)
  Batch 280/1349: loss=15.6313 (NCE=13.304, CLS=11.636)
  Batch 290/1349: loss=15.9290 (NCE=13.656, CLS=11.362)
  Batch 300/1349: loss=15.0168 (NCE=12.841, CLS=10.878)
  Batch 310/1349: loss=15.4139 (NCE=13.128, CLS=11.428)
  Batch 320/1349: loss=15.0523 (NCE=12.827, CLS=11.127)
  Batch 330/1349: loss=14.9204 (NCE=12.593, CLS=11.637)
  Batch 340/1349: loss=15.8322 (NCE=13.431, CLS=12.008)
  Batch 350/1349: loss=15.8300 (NCE=13.508, CLS=11.608)
  Batch 360/1349: loss=14.7326 (NCE=12.544, CLS=10.943)
  Batch 370/1349: loss=15.5457 (NCE=13.220, CLS=11.628)
  Batch 380/1349: loss=15.7161 (NCE=13.326, CLS=11.949)
  Batch 390/1349: loss=15.6097 (NCE=13.257, CLS=11.765)
  Batch 400/1349: loss=16.3573 (NCE=13.948, CLS=12.044)
  Batch 410/1349: loss=15.4992 (NCE=13.221, CLS=11.393)
  Batch 420/1349: loss=16.8909 (NCE=14.538, CLS=11.763)
  Batch 430/1349: loss=14.9157 (NCE=12.703, CLS=11.066)
  Batch 440/1349: loss=15.5195 (NCE=13.186, CLS=11.666)
  Batch 450/1349: loss=16.1647 (NCE=13.867, CLS=11.488)
  Batch 460/1349: loss=16.8948 (NCE=14.446, CLS=12.244)
  Batch 470/1349: loss=15.9763 (NCE=13.640, CLS=11.682)
  Batch 480/1349: loss=14.2296 (NCE=12.042, CLS=10.936)
  Batch 490/1349: loss=15.5270 (NCE=13.409, CLS=10.589)
  Batch 500/1349: loss=16.5087 (NCE=14.090, CLS=12.095)
  Batch 510/1349: loss=15.8533 (NCE=13.598, CLS=11.279)
  Batch 520/1349: loss=15.7465 (NCE=13.455, CLS=11.458)
  Batch 530/1349: loss=16.0743 (NCE=13.652, CLS=12.111)
  Batch 540/1349: loss=15.1634 (NCE=12.701, CLS=12.311)
  Batch 550/1349: loss=16.5278 (NCE=14.105, CLS=12.115)
  Batch 560/1349: loss=16.3595 (NCE=13.955, CLS=12.021)
  Batch 570/1349: loss=15.8855 (NCE=13.435, CLS=12.253)
  Batch 580/1349: loss=15.9377 (NCE=13.584, CLS=11.770)
  Batch 590/1349: loss=14.9719 (NCE=12.659, CLS=11.565)
  Batch 600/1349: loss=15.9981 (NCE=13.504, CLS=12.470)
  Batch 610/1349: loss=13.9094 (NCE=11.827, CLS=10.414)
  Batch 620/1349: loss=16.9417 (NCE=14.511, CLS=12.155)
  Batch 630/1349: loss=16.3939 (NCE=14.016, CLS=11.889)
  Batch 640/1349: loss=15.9147 (NCE=13.447, CLS=12.337)
  Batch 650/1349: loss=16.4297 (NCE=14.218, CLS=11.057)
  Batch 660/1349: loss=15.8294 (NCE=13.575, CLS=11.272)
  Batch 670/1349: loss=16.2867 (NCE=13.865, CLS=12.106)
  Batch 680/1349: loss=16.1196 (NCE=13.668, CLS=12.260)
  Batch 690/1349: loss=15.6872 (NCE=13.398, CLS=11.447)
  Batch 700/1349: loss=15.2076 (NCE=13.094, CLS=10.570)
  Batch 710/1349: loss=15.7060 (NCE=13.480, CLS=11.130)
  Batch 720/1349: loss=15.2110 (NCE=13.022, CLS=10.946)
  Batch 730/1349: loss=14.5188 (NCE=12.386, CLS=10.665)
  Batch 740/1349: loss=16.8567 (NCE=14.362, CLS=12.474)
  Batch 750/1349: loss=15.7636 (NCE=13.497, CLS=11.331)
  Batch 760/1349: loss=16.3660 (NCE=13.941, CLS=12.127)
  Batch 770/1349: loss=15.8547 (NCE=13.402, CLS=12.266)
  Batch 780/1349: loss=15.9039 (NCE=13.610, CLS=11.469)
  Batch 790/1349: loss=16.7870 (NCE=14.299, CLS=12.440)
  Batch 800/1349: loss=16.0261 (NCE=13.732, CLS=11.472)
  Batch 810/1349: loss=16.4095 (NCE=13.999, CLS=12.053)
  Batch 820/1349: loss=15.8166 (NCE=13.415, CLS=12.010)
  Batch 830/1349: loss=15.6138 (NCE=13.367, CLS=11.236)
  Batch 840/1349: loss=16.2302 (NCE=13.726, CLS=12.520)
  Batch 850/1349: loss=16.1856 (NCE=13.806, CLS=11.897)
  Batch 860/1349: loss=16.2856 (NCE=13.931, CLS=11.773)
  Batch 870/1349: loss=16.2441 (NCE=13.878, CLS=11.828)
  Batch 880/1349: loss=15.6996 (NCE=13.328, CLS=11.860)
  Batch 890/1349: loss=15.8525 (NCE=13.576, CLS=11.382)
  Batch 900/1349: loss=15.6413 (NCE=13.404, CLS=11.187)
  Batch 910/1349: loss=16.6192 (NCE=14.064, CLS=12.774)
  Batch 920/1349: loss=16.4306 (NCE=13.931, CLS=12.496)
  Batch 930/1349: loss=15.5151 (NCE=13.184, CLS=11.655)
  Batch 940/1349: loss=16.2081 (NCE=13.878, CLS=11.650)
  Batch 950/1349: loss=16.3551 (NCE=13.916, CLS=12.197)
  Batch 960/1349: loss=15.2584 (NCE=12.958, CLS=11.503)
  Batch 970/1349: loss=16.3685 (NCE=14.005, CLS=11.816)
  Batch 980/1349: loss=15.6451 (NCE=13.132, CLS=12.566)
  Batch 990/1349: loss=16.4848 (NCE=13.947, CLS=12.691)
  Batch 1000/1349: loss=15.7264 (NCE=13.485, CLS=11.207)
  Batch 1010/1349: loss=16.1618 (NCE=13.931, CLS=11.153)
  Batch 1020/1349: loss=15.0161 (NCE=12.643, CLS=11.867)
  Batch 1030/1349: loss=16.0225 (NCE=13.643, CLS=11.900)
  Batch 1040/1349: loss=16.5730 (NCE=13.981, CLS=12.962)
  Batch 1050/1349: loss=15.5556 (NCE=13.139, CLS=12.081)
  Batch 1060/1349: loss=15.4733 (NCE=13.104, CLS=11.845)
  Batch 1070/1349: loss=16.1895 (NCE=13.950, CLS=11.200)
  Batch 1080/1349: loss=15.7283 (NCE=13.478, CLS=11.249)
  Batch 1090/1349: loss=15.9346 (NCE=13.681, CLS=11.270)
  Batch 1100/1349: loss=16.1523 (NCE=13.794, CLS=11.791)
  Batch 1110/1349: loss=15.4787 (NCE=13.151, CLS=11.637)
  Batch 1120/1349: loss=16.5156 (NCE=13.889, CLS=13.131)
  Batch 1130/1349: loss=15.1963 (NCE=13.074, CLS=10.609)
  Batch 1140/1349: loss=15.2593 (NCE=13.001, CLS=11.292)
  Batch 1150/1349: loss=16.4543 (NCE=13.931, CLS=12.618)
  Batch 1160/1349: loss=16.1947 (NCE=13.734, CLS=12.305)
  Batch 1170/1349: loss=14.3947 (NCE=12.251, CLS=10.720)
  Batch 1180/1349: loss=15.8034 (NCE=13.400, CLS=12.019)
  Batch 1190/1349: loss=15.9619 (NCE=13.468, CLS=12.472)
  Batch 1200/1349: loss=16.0068 (NCE=13.601, CLS=12.029)
  Batch 1210/1349: loss=14.8721 (NCE=12.512, CLS=11.802)
  Batch 1220/1349: loss=15.7738 (NCE=13.417, CLS=11.783)
  Batch 1230/1349: loss=15.2613 (NCE=13.007, CLS=11.272)
  Batch 1240/1349: loss=16.0998 (NCE=13.739, CLS=11.803)
  Batch 1250/1349: loss=16.2770 (NCE=13.874, CLS=12.015)
  Batch 1260/1349: loss=16.1268 (NCE=13.772, CLS=11.775)
  Batch 1270/1349: loss=16.0496 (NCE=13.777, CLS=11.361)
  Batch 1280/1349: loss=16.4542 (NCE=14.026, CLS=12.141)
  Batch 1290/1349: loss=16.5177 (NCE=14.155, CLS=11.815)
  Batch 1300/1349: loss=15.7831 (NCE=13.509, CLS=11.370)
  Batch 1310/1349: loss=16.0443 (NCE=13.554, CLS=12.450)
  Batch 1320/1349: loss=16.3150 (NCE=13.947, CLS=11.839)
  Batch 1330/1349: loss=16.2846 (NCE=13.955, CLS=11.646)
  Batch 1340/1349: loss=15.5165 (NCE=13.292, CLS=11.123)
  Train: loss=15.8784 (NCE=13.532, CLS=11.731)
  Acc: HV=0.183, HJ=0.240, LV=0.194, LJ=0.126
  Val: loss=13.8268, R@10_HV=0.011

Epoch 29/100
  Batch 10/1349: loss=16.4301 (NCE=14.001, CLS=12.143)
  Batch 20/1349: loss=16.3440 (NCE=13.965, CLS=11.894)
  Batch 30/1349: loss=16.2174 (NCE=13.825, CLS=11.961)
  Batch 40/1349: loss=15.1842 (NCE=12.929, CLS=11.278)
  Batch 50/1349: loss=15.9250 (NCE=13.567, CLS=11.791)
  Batch 60/1349: loss=15.8727 (NCE=13.468, CLS=12.023)
  Batch 70/1349: loss=16.0920 (NCE=13.736, CLS=11.778)
  Batch 80/1349: loss=15.9025 (NCE=13.400, CLS=12.514)
  Batch 90/1349: loss=15.8833 (NCE=13.627, CLS=11.280)
  Batch 100/1349: loss=15.8755 (NCE=13.678, CLS=10.986)
  Batch 110/1349: loss=15.6622 (NCE=13.361, CLS=11.507)
  Batch 120/1349: loss=15.8769 (NCE=13.485, CLS=11.958)
  Batch 130/1349: loss=14.8364 (NCE=12.724, CLS=10.563)
  Batch 140/1349: loss=15.2679 (NCE=12.959, CLS=11.545)
  Batch 150/1349: loss=15.5060 (NCE=13.160, CLS=11.729)
  Batch 160/1349: loss=17.0115 (NCE=14.489, CLS=12.614)
  Batch 170/1349: loss=15.7884 (NCE=13.420, CLS=11.843)
  Batch 180/1349: loss=15.8604 (NCE=13.614, CLS=11.231)
  Batch 190/1349: loss=16.6029 (NCE=14.167, CLS=12.179)
  Batch 200/1349: loss=15.5517 (NCE=13.177, CLS=11.872)
  Batch 210/1349: loss=15.8816 (NCE=13.614, CLS=11.340)
  Batch 220/1349: loss=15.7630 (NCE=13.139, CLS=13.121)
  Batch 230/1349: loss=16.2153 (NCE=13.940, CLS=11.375)
  Batch 240/1349: loss=15.4484 (NCE=13.108, CLS=11.701)
  Batch 250/1349: loss=16.4235 (NCE=13.972, CLS=12.256)
  Batch 260/1349: loss=16.1080 (NCE=13.813, CLS=11.477)
  Batch 270/1349: loss=16.3988 (NCE=13.942, CLS=12.284)
  Batch 280/1349: loss=15.9691 (NCE=13.505, CLS=12.321)
  Batch 290/1349: loss=15.7445 (NCE=13.358, CLS=11.932)
  Batch 300/1349: loss=15.7461 (NCE=13.447, CLS=11.493)
  Batch 310/1349: loss=14.9566 (NCE=12.803, CLS=10.768)
  Batch 320/1349: loss=15.9399 (NCE=13.620, CLS=11.600)
  Batch 330/1349: loss=16.3008 (NCE=13.862, CLS=12.192)
  Batch 340/1349: loss=15.5533 (NCE=13.212, CLS=11.708)
  Batch 350/1349: loss=15.6722 (NCE=13.346, CLS=11.630)
  Batch 360/1349: loss=15.1248 (NCE=12.953, CLS=10.859)
  Batch 370/1349: loss=16.4406 (NCE=14.088, CLS=11.766)
  Batch 380/1349: loss=16.2231 (NCE=13.700, CLS=12.615)
  Batch 390/1349: loss=16.1093 (NCE=13.725, CLS=11.921)
  Batch 400/1349: loss=15.5490 (NCE=13.336, CLS=11.066)
  Batch 410/1349: loss=16.6426 (NCE=14.177, CLS=12.328)
  Batch 420/1349: loss=16.5256 (NCE=14.008, CLS=12.588)
  Batch 430/1349: loss=16.0718 (NCE=13.712, CLS=11.801)
  Batch 440/1349: loss=15.1643 (NCE=12.963, CLS=11.004)
  Batch 450/1349: loss=16.4778 (NCE=14.084, CLS=11.967)
  Batch 460/1349: loss=16.3253 (NCE=13.932, CLS=11.966)
  Batch 470/1349: loss=16.2721 (NCE=14.016, CLS=11.279)
  Batch 480/1349: loss=15.7674 (NCE=13.510, CLS=11.286)
  Batch 490/1349: loss=15.9237 (NCE=13.587, CLS=11.684)
  Batch 500/1349: loss=16.3484 (NCE=13.906, CLS=12.210)
  Batch 510/1349: loss=15.3352 (NCE=13.174, CLS=10.804)
  Batch 520/1349: loss=15.5313 (NCE=13.124, CLS=12.036)
  Batch 530/1349: loss=16.6400 (NCE=14.062, CLS=12.890)
  Batch 540/1349: loss=15.7850 (NCE=13.369, CLS=12.081)
  Batch 550/1349: loss=16.4235 (NCE=13.974, CLS=12.247)
  Batch 560/1349: loss=15.3637 (NCE=13.082, CLS=11.407)
  Batch 570/1349: loss=15.7799 (NCE=13.521, CLS=11.297)
  Batch 580/1349: loss=16.1718 (NCE=13.734, CLS=12.189)
  Batch 590/1349: loss=16.1537 (NCE=13.717, CLS=12.182)
  Batch 600/1349: loss=14.5700 (NCE=12.274, CLS=11.481)
  Batch 610/1349: loss=16.5989 (NCE=14.154, CLS=12.226)
  Batch 620/1349: loss=15.5728 (NCE=13.289, CLS=11.420)
  Batch 630/1349: loss=15.2768 (NCE=12.800, CLS=12.384)
  Batch 640/1349: loss=16.1560 (NCE=13.788, CLS=11.842)
  Batch 650/1349: loss=16.1764 (NCE=13.748, CLS=12.140)
  Batch 660/1349: loss=16.1633 (NCE=13.843, CLS=11.601)
  Batch 670/1349: loss=15.5205 (NCE=13.381, CLS=10.699)
  Batch 680/1349: loss=14.8982 (NCE=12.494, CLS=12.021)
  Batch 690/1349: loss=16.2928 (NCE=13.908, CLS=11.922)
  Batch 700/1349: loss=15.8588 (NCE=13.457, CLS=12.009)
  Batch 710/1349: loss=16.2563 (NCE=13.896, CLS=11.802)
  Batch 720/1349: loss=14.9471 (NCE=12.645, CLS=11.510)
  Batch 730/1349: loss=15.0010 (NCE=12.721, CLS=11.398)
  Batch 740/1349: loss=15.9694 (NCE=13.737, CLS=11.163)
  Batch 750/1349: loss=16.5053 (NCE=14.185, CLS=11.599)
  Batch 760/1349: loss=16.5339 (NCE=14.182, CLS=11.761)
  Batch 770/1349: loss=16.5969 (NCE=14.251, CLS=11.730)
  Batch 780/1349: loss=16.8520 (NCE=14.292, CLS=12.800)
  Batch 790/1349: loss=15.4741 (NCE=13.133, CLS=11.707)
  Batch 800/1349: loss=16.2112 (NCE=13.804, CLS=12.035)
  Batch 810/1349: loss=16.0263 (NCE=13.651, CLS=11.877)
  Batch 820/1349: loss=16.5303 (NCE=14.148, CLS=11.913)
  Batch 830/1349: loss=15.2951 (NCE=13.069, CLS=11.133)
  Batch 840/1349: loss=16.5099 (NCE=14.146, CLS=11.819)
  Batch 850/1349: loss=15.5391 (NCE=13.269, CLS=11.348)
  Batch 860/1349: loss=16.3897 (NCE=13.931, CLS=12.295)
  Batch 870/1349: loss=15.4297 (NCE=13.170, CLS=11.300)
  Batch 880/1349: loss=15.8894 (NCE=13.454, CLS=12.175)
  Batch 890/1349: loss=16.0914 (NCE=13.722, CLS=11.846)
  Batch 900/1349: loss=15.3213 (NCE=13.152, CLS=10.845)
  Batch 910/1349: loss=15.5341 (NCE=13.332, CLS=11.011)
  Batch 920/1349: loss=15.9745 (NCE=13.741, CLS=11.166)
  Batch 930/1349: loss=15.8768 (NCE=13.603, CLS=11.369)
  Batch 940/1349: loss=16.4896 (NCE=13.977, CLS=12.563)
  Batch 950/1349: loss=15.0896 (NCE=12.895, CLS=10.971)
  Batch 960/1349: loss=15.6169 (NCE=13.306, CLS=11.553)
  Batch 970/1349: loss=15.5975 (NCE=13.322, CLS=11.377)
  Batch 980/1349: loss=15.7323 (NCE=13.504, CLS=11.139)
  Batch 990/1349: loss=15.2762 (NCE=13.034, CLS=11.213)
  Batch 1000/1349: loss=15.8347 (NCE=13.537, CLS=11.489)
  Batch 1010/1349: loss=14.9949 (NCE=12.770, CLS=11.123)
  Batch 1020/1349: loss=15.1313 (NCE=12.911, CLS=11.102)
  Batch 1030/1349: loss=16.0754 (NCE=13.631, CLS=12.224)
  Batch 1040/1349: loss=16.7388 (NCE=14.209, CLS=12.648)
  Batch 1050/1349: loss=15.3825 (NCE=13.027, CLS=11.776)
  Batch 1060/1349: loss=16.8645 (NCE=14.349, CLS=12.577)
  Batch 1070/1349: loss=15.9986 (NCE=13.757, CLS=11.210)
  Batch 1080/1349: loss=16.5603 (NCE=14.078, CLS=12.413)
  Batch 1090/1349: loss=14.6609 (NCE=12.523, CLS=10.688)
  Batch 1100/1349: loss=15.8876 (NCE=13.595, CLS=11.461)
  Batch 1110/1349: loss=15.1598 (NCE=12.981, CLS=10.892)
  Batch 1120/1349: loss=16.0597 (NCE=13.604, CLS=12.281)
  Batch 1130/1349: loss=16.2929 (NCE=13.809, CLS=12.421)
  Batch 1140/1349: loss=16.2318 (NCE=13.919, CLS=11.564)
  Batch 1150/1349: loss=15.0999 (NCE=12.757, CLS=11.717)
  Batch 1160/1349: loss=16.0945 (NCE=13.769, CLS=11.625)
  Batch 1170/1349: loss=15.2898 (NCE=13.145, CLS=10.726)
  Batch 1180/1349: loss=15.7979 (NCE=13.482, CLS=11.578)
  Batch 1190/1349: loss=16.0535 (NCE=13.650, CLS=12.017)
  Batch 1200/1349: loss=16.5873 (NCE=14.173, CLS=12.070)
  Batch 1210/1349: loss=15.9033 (NCE=13.644, CLS=11.295)
  Batch 1220/1349: loss=16.5636 (NCE=14.183, CLS=11.904)
  Batch 1230/1349: loss=15.8481 (NCE=13.592, CLS=11.281)
  Batch 1240/1349: loss=16.8210 (NCE=14.475, CLS=11.730)
  Batch 1250/1349: loss=15.7587 (NCE=13.482, CLS=11.381)
  Batch 1260/1349: loss=15.1603 (NCE=12.959, CLS=11.008)
  Batch 1270/1349: loss=16.9763 (NCE=14.520, CLS=12.280)
  Batch 1280/1349: loss=16.8118 (NCE=14.278, CLS=12.668)
  Batch 1290/1349: loss=15.1741 (NCE=12.780, CLS=11.970)
  Batch 1300/1349: loss=16.3920 (NCE=14.112, CLS=11.402)
  Batch 1310/1349: loss=16.3183 (NCE=13.889, CLS=12.146)
  Batch 1320/1349: loss=16.5444 (NCE=13.967, CLS=12.885)
  Batch 1330/1349: loss=16.0146 (NCE=13.579, CLS=12.178)
  Batch 1340/1349: loss=16.1676 (NCE=13.771, CLS=11.984)
  Train: loss=15.8732 (NCE=13.529, CLS=11.719)
  Acc: HV=0.183, HJ=0.241, LV=0.194, LJ=0.125
  Val: loss=13.8322, R@10_HV=0.011

Epoch 30/100
  Batch 10/1349: loss=16.3058 (NCE=13.800, CLS=12.530)
  Batch 20/1349: loss=16.3737 (NCE=13.992, CLS=11.907)
  Batch 30/1349: loss=15.0717 (NCE=12.816, CLS=11.279)
  Batch 40/1349: loss=14.9921 (NCE=12.748, CLS=11.220)
  Batch 50/1349: loss=15.1298 (NCE=12.895, CLS=11.173)
  Batch 60/1349: loss=15.2321 (NCE=12.960, CLS=11.360)
  Batch 70/1349: loss=15.5678 (NCE=13.219, CLS=11.742)
  Batch 80/1349: loss=16.7227 (NCE=14.310, CLS=12.066)
  Batch 90/1349: loss=16.0994 (NCE=13.687, CLS=12.061)
  Batch 100/1349: loss=15.0668 (NCE=12.943, CLS=10.621)
  Batch 110/1349: loss=15.5026 (NCE=13.157, CLS=11.726)
  Batch 120/1349: loss=16.2832 (NCE=13.983, CLS=11.502)
  Batch 130/1349: loss=15.1293 (NCE=12.756, CLS=11.867)
  Batch 140/1349: loss=16.0511 (NCE=13.762, CLS=11.445)
  Batch 150/1349: loss=17.1087 (NCE=14.560, CLS=12.745)
  Batch 160/1349: loss=15.6607 (NCE=13.254, CLS=12.034)
  Batch 170/1349: loss=17.1544 (NCE=14.668, CLS=12.433)
  Batch 180/1349: loss=16.2502 (NCE=13.843, CLS=12.034)
  Batch 190/1349: loss=16.4434 (NCE=13.974, CLS=12.345)
  Batch 200/1349: loss=16.0653 (NCE=13.740, CLS=11.626)
  Batch 210/1349: loss=15.5022 (NCE=13.197, CLS=11.527)
  Batch 220/1349: loss=16.5617 (NCE=14.100, CLS=12.307)
  Batch 230/1349: loss=16.1175 (NCE=13.677, CLS=12.203)
  Batch 240/1349: loss=15.7884 (NCE=13.392, CLS=11.981)
  Batch 250/1349: loss=15.7309 (NCE=13.471, CLS=11.301)
  Batch 260/1349: loss=16.0357 (NCE=13.602, CLS=12.167)
  Batch 270/1349: loss=14.8662 (NCE=12.670, CLS=10.983)
  Batch 280/1349: loss=17.0102 (NCE=14.532, CLS=12.389)
  Batch 290/1349: loss=15.3918 (NCE=13.134, CLS=11.287)
  Batch 300/1349: loss=15.7775 (NCE=13.461, CLS=11.582)
  Batch 310/1349: loss=15.7441 (NCE=13.289, CLS=12.273)
  Batch 320/1349: loss=15.7775 (NCE=13.441, CLS=11.684)
  Batch 330/1349: loss=16.0894 (NCE=13.590, CLS=12.499)
  Batch 340/1349: loss=15.5944 (NCE=13.216, CLS=11.893)
  Batch 350/1349: loss=16.1701 (NCE=13.791, CLS=11.895)
  Batch 360/1349: loss=16.1900 (NCE=13.858, CLS=11.662)
  Batch 370/1349: loss=15.6215 (NCE=13.313, CLS=11.545)
  Batch 380/1349: loss=15.9379 (NCE=13.580, CLS=11.787)
  Batch 390/1349: loss=14.8091 (NCE=12.724, CLS=10.428)
  Batch 400/1349: loss=15.7091 (NCE=13.324, CLS=11.926)
  Batch 410/1349: loss=15.9460 (NCE=13.636, CLS=11.550)
  Batch 420/1349: loss=16.1052 (NCE=13.855, CLS=11.253)
  Batch 430/1349: loss=15.8746 (NCE=13.698, CLS=10.880)
  Batch 440/1349: loss=16.9088 (NCE=14.459, CLS=12.247)
  Batch 450/1349: loss=15.3203 (NCE=13.039, CLS=11.408)
  Batch 460/1349: loss=15.9141 (NCE=13.601, CLS=11.566)
  Batch 470/1349: loss=16.3836 (NCE=13.937, CLS=12.233)
  Batch 480/1349: loss=14.9986 (NCE=12.816, CLS=10.913)
  Batch 490/1349: loss=16.5569 (NCE=14.179, CLS=11.887)
  Batch 500/1349: loss=16.3501 (NCE=13.856, CLS=12.472)
  Batch 510/1349: loss=16.3011 (NCE=13.940, CLS=11.804)
  Batch 520/1349: loss=15.7275 (NCE=13.448, CLS=11.398)
  Batch 530/1349: loss=15.6853 (NCE=13.257, CLS=12.140)
  Batch 540/1349: loss=14.8541 (NCE=12.573, CLS=11.408)
  Batch 550/1349: loss=16.4097 (NCE=14.068, CLS=11.709)
  Batch 560/1349: loss=16.3958 (NCE=13.933, CLS=12.314)
  Batch 570/1349: loss=15.2856 (NCE=13.003, CLS=11.411)
  Batch 580/1349: loss=16.0497 (NCE=13.709, CLS=11.704)
  Batch 590/1349: loss=16.6928 (NCE=14.123, CLS=12.851)
  Batch 600/1349: loss=16.2837 (NCE=13.850, CLS=12.168)
  Batch 610/1349: loss=16.0875 (NCE=13.732, CLS=11.778)
  Batch 620/1349: loss=15.5061 (NCE=13.030, CLS=12.381)
  Batch 630/1349: loss=16.1356 (NCE=13.759, CLS=11.883)
  Batch 640/1349: loss=15.8777 (NCE=13.563, CLS=11.574)
  Batch 650/1349: loss=15.5910 (NCE=13.339, CLS=11.258)
  Batch 660/1349: loss=15.5995 (NCE=13.300, CLS=11.498)
  Batch 670/1349: loss=15.3490 (NCE=12.801, CLS=12.741)
  Batch 680/1349: loss=16.0136 (NCE=13.716, CLS=11.488)
  Batch 690/1349: loss=16.2520 (NCE=13.905, CLS=11.735)
  Batch 700/1349: loss=15.6033 (NCE=13.181, CLS=12.111)
  Batch 710/1349: loss=17.0264 (NCE=14.585, CLS=12.205)
  Batch 720/1349: loss=16.4788 (NCE=14.066, CLS=12.062)
  Batch 730/1349: loss=15.7239 (NCE=13.317, CLS=12.033)
  Batch 740/1349: loss=16.3002 (NCE=13.961, CLS=11.694)
  Batch 750/1349: loss=15.2184 (NCE=12.983, CLS=11.179)
  Batch 760/1349: loss=16.1450 (NCE=13.737, CLS=12.038)
  Batch 770/1349: loss=15.2643 (NCE=12.998, CLS=11.330)
  Batch 780/1349: loss=15.7197 (NCE=13.411, CLS=11.544)
  Batch 790/1349: loss=16.1909 (NCE=13.860, CLS=11.656)
  Batch 800/1349: loss=15.1243 (NCE=12.872, CLS=11.264)
  Batch 810/1349: loss=16.1928 (NCE=13.943, CLS=11.247)
  Batch 820/1349: loss=17.1108 (NCE=14.534, CLS=12.885)
  Batch 830/1349: loss=15.4227 (NCE=13.072, CLS=11.755)
  Batch 840/1349: loss=15.8358 (NCE=13.574, CLS=11.309)
  Batch 850/1349: loss=16.5044 (NCE=13.899, CLS=13.029)
  Batch 860/1349: loss=15.3240 (NCE=13.165, CLS=10.794)
  Batch 870/1349: loss=15.4629 (NCE=13.175, CLS=11.441)
  Batch 880/1349: loss=15.1370 (NCE=12.856, CLS=11.405)
  Batch 890/1349: loss=15.6092 (NCE=13.213, CLS=11.981)
  Batch 900/1349: loss=16.8026 (NCE=14.281, CLS=12.606)
  Batch 910/1349: loss=15.3648 (NCE=13.172, CLS=10.964)
  Batch 920/1349: loss=15.4775 (NCE=13.249, CLS=11.141)
  Batch 930/1349: loss=15.5702 (NCE=13.265, CLS=11.526)
  Batch 940/1349: loss=15.4808 (NCE=13.224, CLS=11.286)
  Batch 950/1349: loss=16.0580 (NCE=13.652, CLS=12.031)
  Batch 960/1349: loss=16.1967 (NCE=13.780, CLS=12.085)
  Batch 970/1349: loss=15.8360 (NCE=13.494, CLS=11.709)
  Batch 980/1349: loss=15.8376 (NCE=13.426, CLS=12.060)
  Batch 990/1349: loss=15.3021 (NCE=13.020, CLS=11.413)
  Batch 1000/1349: loss=14.4799 (NCE=12.341, CLS=10.696)
  Batch 1010/1349: loss=16.0525 (NCE=13.661, CLS=11.955)
  Batch 1020/1349: loss=16.4702 (NCE=13.982, CLS=12.444)
  Batch 1030/1349: loss=15.1954 (NCE=12.898, CLS=11.486)
  Batch 1040/1349: loss=15.6727 (NCE=13.186, CLS=12.435)
  Batch 1050/1349: loss=15.8022 (NCE=13.478, CLS=11.622)
  Batch 1060/1349: loss=15.8968 (NCE=13.632, CLS=11.327)
  Batch 1070/1349: loss=16.7575 (NCE=14.317, CLS=12.202)
  Batch 1080/1349: loss=15.3528 (NCE=13.223, CLS=10.651)
  Batch 1090/1349: loss=15.8114 (NCE=13.438, CLS=11.870)
  Batch 1100/1349: loss=15.1946 (NCE=12.941, CLS=11.269)
  Batch 1110/1349: loss=16.9255 (NCE=14.331, CLS=12.974)
  Batch 1120/1349: loss=16.2853 (NCE=13.906, CLS=11.899)
  Batch 1130/1349: loss=16.1831 (NCE=13.880, CLS=11.515)
  Batch 1140/1349: loss=16.8132 (NCE=14.324, CLS=12.445)
  Batch 1150/1349: loss=15.2920 (NCE=13.128, CLS=10.821)
  Batch 1160/1349: loss=16.4177 (NCE=13.804, CLS=13.067)
  Batch 1170/1349: loss=15.3319 (NCE=13.063, CLS=11.346)
  Batch 1180/1349: loss=15.9318 (NCE=13.685, CLS=11.234)
  Batch 1190/1349: loss=16.3647 (NCE=13.983, CLS=11.907)
  Batch 1200/1349: loss=15.5411 (NCE=13.283, CLS=11.288)
  Batch 1210/1349: loss=15.9723 (NCE=13.656, CLS=11.582)
  Batch 1220/1349: loss=15.6188 (NCE=13.223, CLS=11.978)
  Batch 1230/1349: loss=16.2649 (NCE=13.929, CLS=11.679)
  Batch 1240/1349: loss=15.1613 (NCE=13.036, CLS=10.626)
  Batch 1250/1349: loss=15.5539 (NCE=13.363, CLS=10.956)
  Batch 1260/1349: loss=16.3308 (NCE=14.039, CLS=11.458)
  Batch 1270/1349: loss=16.3055 (NCE=13.872, CLS=12.167)
  Batch 1280/1349: loss=14.6257 (NCE=12.584, CLS=10.207)
  Batch 1290/1349: loss=15.2074 (NCE=12.951, CLS=11.281)
  Batch 1300/1349: loss=14.8193 (NCE=12.684, CLS=10.677)
  Batch 1310/1349: loss=15.6324 (NCE=13.291, CLS=11.706)
  Batch 1320/1349: loss=15.7578 (NCE=13.418, CLS=11.701)
  Batch 1330/1349: loss=15.9065 (NCE=13.512, CLS=11.975)
  Batch 1340/1349: loss=14.8550 (NCE=12.734, CLS=10.603)
  Train: loss=15.8627 (NCE=13.521, CLS=11.709)
  Acc: HV=0.183, HJ=0.240, LV=0.195, LJ=0.126
  Val: loss=13.8309, R@10_HV=0.011

Epoch 31/100
  Batch 10/1349: loss=16.5171 (NCE=14.191, CLS=11.632)
  Batch 20/1349: loss=16.2624 (NCE=13.895, CLS=11.839)
  Batch 30/1349: loss=15.7055 (NCE=13.462, CLS=11.219)
  Batch 40/1349: loss=15.7193 (NCE=13.338, CLS=11.907)
  Batch 50/1349: loss=16.5551 (NCE=14.058, CLS=12.487)
  Batch 60/1349: loss=16.2644 (NCE=13.889, CLS=11.878)
  Batch 70/1349: loss=16.0772 (NCE=13.693, CLS=11.921)
  Batch 80/1349: loss=15.6490 (NCE=13.282, CLS=11.836)
  Batch 90/1349: loss=15.4582 (NCE=13.088, CLS=11.850)
  Batch 100/1349: loss=15.1043 (NCE=12.997, CLS=10.539)
  Batch 110/1349: loss=16.0063 (NCE=13.553, CLS=12.268)
  Batch 120/1349: loss=16.2444 (NCE=13.790, CLS=12.274)
  Batch 130/1349: loss=15.0289 (NCE=12.777, CLS=11.261)
  Batch 140/1349: loss=16.1451 (NCE=13.667, CLS=12.392)
  Batch 150/1349: loss=15.3488 (NCE=13.093, CLS=11.279)
  Batch 160/1349: loss=16.1783 (NCE=13.711, CLS=12.335)
  Batch 170/1349: loss=15.8232 (NCE=13.481, CLS=11.711)
  Batch 180/1349: loss=16.8768 (NCE=14.427, CLS=12.249)
  Batch 190/1349: loss=16.2303 (NCE=13.931, CLS=11.498)
  Batch 200/1349: loss=16.0968 (NCE=13.833, CLS=11.319)
  Batch 210/1349: loss=16.3146 (NCE=14.061, CLS=11.269)
  Batch 220/1349: loss=15.2706 (NCE=13.028, CLS=11.214)
  Batch 230/1349: loss=15.6342 (NCE=13.294, CLS=11.701)
  Batch 240/1349: loss=15.8899 (NCE=13.603, CLS=11.433)
  Batch 250/1349: loss=15.6696 (NCE=13.400, CLS=11.347)
  Batch 260/1349: loss=15.4229 (NCE=13.236, CLS=10.936)
  Batch 270/1349: loss=16.6671 (NCE=14.150, CLS=12.587)
  Batch 280/1349: loss=15.2120 (NCE=13.106, CLS=10.528)
  Batch 290/1349: loss=16.0375 (NCE=13.611, CLS=12.130)
  Batch 300/1349: loss=15.4805 (NCE=13.002, CLS=12.390)
  Batch 310/1349: loss=14.7434 (NCE=12.484, CLS=11.296)
  Batch 320/1349: loss=16.7241 (NCE=14.264, CLS=12.298)
  Batch 330/1349: loss=15.7707 (NCE=13.427, CLS=11.718)
  Batch 340/1349: loss=15.6415 (NCE=13.165, CLS=12.384)
  Batch 350/1349: loss=16.6911 (NCE=14.244, CLS=12.234)
  Batch 360/1349: loss=16.6719 (NCE=14.196, CLS=12.378)
  Batch 370/1349: loss=16.0620 (NCE=13.740, CLS=11.608)
  Batch 380/1349: loss=15.8074 (NCE=13.597, CLS=11.050)
  Batch 390/1349: loss=16.4511 (NCE=14.026, CLS=12.125)
  Batch 400/1349: loss=15.4215 (NCE=13.137, CLS=11.422)
  Batch 410/1349: loss=15.5242 (NCE=13.288, CLS=11.183)
  Batch 420/1349: loss=15.9283 (NCE=13.643, CLS=11.428)
  Batch 430/1349: loss=15.7837 (NCE=13.576, CLS=11.036)
  Batch 440/1349: loss=15.9219 (NCE=13.585, CLS=11.684)
  Batch 450/1349: loss=15.7705 (NCE=13.405, CLS=11.826)
  Batch 460/1349: loss=16.1478 (NCE=13.828, CLS=11.598)
  Batch 470/1349: loss=15.7960 (NCE=13.315, CLS=12.404)
  Batch 480/1349: loss=15.7074 (NCE=13.362, CLS=11.726)
  Batch 490/1349: loss=15.9983 (NCE=13.643, CLS=11.777)
  Batch 500/1349: loss=15.5124 (NCE=13.156, CLS=11.784)
  Batch 510/1349: loss=15.2142 (NCE=13.032, CLS=10.912)
  Batch 520/1349: loss=15.9420 (NCE=13.567, CLS=11.874)
  Batch 530/1349: loss=15.5406 (NCE=13.429, CLS=10.560)
  Batch 540/1349: loss=15.4817 (NCE=13.014, CLS=12.338)
  Batch 550/1349: loss=15.6486 (NCE=13.343, CLS=11.529)
  Batch 560/1349: loss=15.2898 (NCE=13.182, CLS=10.537)
  Batch 570/1349: loss=16.5880 (NCE=14.212, CLS=11.880)
  Batch 580/1349: loss=16.2944 (NCE=13.901, CLS=11.968)
  Batch 590/1349: loss=16.2984 (NCE=13.892, CLS=12.031)
  Batch 600/1349: loss=15.9260 (NCE=13.558, CLS=11.840)
  Batch 610/1349: loss=15.2985 (NCE=12.869, CLS=12.146)
  Batch 620/1349: loss=15.3703 (NCE=13.197, CLS=10.864)
  Batch 630/1349: loss=15.9208 (NCE=13.595, CLS=11.629)
  Batch 640/1349: loss=15.8064 (NCE=13.640, CLS=10.830)
  Batch 650/1349: loss=16.0413 (NCE=13.645, CLS=11.980)
  Batch 660/1349: loss=15.9304 (NCE=13.508, CLS=12.109)
  Batch 670/1349: loss=16.1463 (NCE=13.745, CLS=12.007)
  Batch 680/1349: loss=15.4144 (NCE=13.104, CLS=11.550)
  Batch 690/1349: loss=15.1830 (NCE=12.968, CLS=11.078)
  Batch 700/1349: loss=15.3517 (NCE=13.018, CLS=11.666)
  Batch 710/1349: loss=16.3528 (NCE=13.956, CLS=11.982)
  Batch 720/1349: loss=16.6550 (NCE=14.324, CLS=11.656)
  Batch 730/1349: loss=15.4784 (NCE=13.308, CLS=10.853)
  Batch 740/1349: loss=15.1586 (NCE=12.912, CLS=11.232)
  Batch 750/1349: loss=15.3883 (NCE=13.021, CLS=11.836)
  Batch 760/1349: loss=14.5308 (NCE=12.379, CLS=10.757)
  Batch 770/1349: loss=15.5589 (NCE=13.352, CLS=11.033)
  Batch 780/1349: loss=16.4340 (NCE=14.098, CLS=11.682)
  Batch 790/1349: loss=15.8242 (NCE=13.532, CLS=11.460)
  Batch 800/1349: loss=15.6912 (NCE=13.372, CLS=11.596)
  Batch 810/1349: loss=15.3045 (NCE=13.113, CLS=10.958)
  Batch 820/1349: loss=15.2347 (NCE=13.079, CLS=10.777)
  Batch 830/1349: loss=15.7221 (NCE=13.415, CLS=11.534)
  Batch 840/1349: loss=16.1420 (NCE=13.834, CLS=11.539)
  Batch 850/1349: loss=15.9176 (NCE=13.554, CLS=11.817)
  Batch 860/1349: loss=16.9423 (NCE=14.526, CLS=12.084)
  Batch 870/1349: loss=15.3722 (NCE=13.079, CLS=11.464)
  Batch 880/1349: loss=16.8992 (NCE=14.467, CLS=12.160)
  Batch 890/1349: loss=15.7391 (NCE=13.385, CLS=11.772)
  Batch 900/1349: loss=15.7862 (NCE=13.514, CLS=11.359)
  Batch 910/1349: loss=16.3290 (NCE=13.632, CLS=13.484)
  Batch 920/1349: loss=16.3939 (NCE=13.904, CLS=12.448)
  Batch 930/1349: loss=16.1535 (NCE=13.804, CLS=11.749)
  Batch 940/1349: loss=16.3696 (NCE=13.871, CLS=12.491)
  Batch 950/1349: loss=16.1231 (NCE=13.739, CLS=11.922)
  Batch 960/1349: loss=15.7259 (NCE=13.364, CLS=11.810)
  Batch 970/1349: loss=15.2691 (NCE=13.125, CLS=10.722)
  Batch 980/1349: loss=16.2987 (NCE=13.877, CLS=12.110)
  Batch 990/1349: loss=15.9098 (NCE=13.586, CLS=11.618)
  Batch 1000/1349: loss=15.2196 (NCE=13.024, CLS=10.978)
  Batch 1010/1349: loss=17.0642 (NCE=14.696, CLS=11.842)
  Batch 1020/1349: loss=15.2681 (NCE=13.029, CLS=11.195)
  Batch 1030/1349: loss=16.0089 (NCE=13.436, CLS=12.863)
  Batch 1040/1349: loss=15.5197 (NCE=13.248, CLS=11.361)
  Batch 1050/1349: loss=16.2188 (NCE=13.843, CLS=11.881)
  Batch 1060/1349: loss=15.6440 (NCE=13.388, CLS=11.282)
  Batch 1070/1349: loss=15.8272 (NCE=13.478, CLS=11.745)
  Batch 1080/1349: loss=15.4331 (NCE=13.195, CLS=11.192)
  Batch 1090/1349: loss=16.2084 (NCE=13.781, CLS=12.136)
  Batch 1100/1349: loss=16.4506 (NCE=14.038, CLS=12.061)
  Batch 1110/1349: loss=15.9490 (NCE=13.443, CLS=12.531)
  Batch 1120/1349: loss=13.7992 (NCE=11.866, CLS=9.663)
  Batch 1130/1349: loss=15.0619 (NCE=12.490, CLS=12.859)
  Batch 1140/1349: loss=16.5846 (NCE=14.111, CLS=12.366)
  Batch 1150/1349: loss=16.3362 (NCE=14.026, CLS=11.553)
  Batch 1160/1349: loss=15.5216 (NCE=13.308, CLS=11.069)
  Batch 1170/1349: loss=15.3700 (NCE=13.122, CLS=11.241)
  Batch 1180/1349: loss=16.0253 (NCE=13.644, CLS=11.907)
  Batch 1190/1349: loss=15.8282 (NCE=13.489, CLS=11.698)
  Batch 1200/1349: loss=15.4982 (NCE=13.140, CLS=11.791)
  Batch 1210/1349: loss=16.1425 (NCE=13.745, CLS=11.986)
  Batch 1220/1349: loss=15.8402 (NCE=13.413, CLS=12.136)
  Batch 1230/1349: loss=15.7180 (NCE=13.391, CLS=11.636)
  Batch 1240/1349: loss=15.0142 (NCE=12.500, CLS=12.569)
  Batch 1250/1349: loss=15.2039 (NCE=12.889, CLS=11.576)
  Batch 1260/1349: loss=16.4875 (NCE=14.010, CLS=12.387)
  Batch 1270/1349: loss=15.4472 (NCE=13.039, CLS=12.040)
  Batch 1280/1349: loss=15.9323 (NCE=13.568, CLS=11.823)
  Batch 1290/1349: loss=15.4797 (NCE=13.120, CLS=11.798)
  Batch 1300/1349: loss=16.1638 (NCE=13.795, CLS=11.845)
  Batch 1310/1349: loss=15.9976 (NCE=13.464, CLS=12.670)
  Batch 1320/1349: loss=15.5810 (NCE=13.320, CLS=11.302)
  Batch 1330/1349: loss=15.2844 (NCE=13.093, CLS=10.956)
  Batch 1340/1349: loss=15.5702 (NCE=13.206, CLS=11.819)
  Train: loss=15.8553 (NCE=13.514, CLS=11.705)
  Acc: HV=0.183, HJ=0.241, LV=0.194, LJ=0.128
  Val: loss=13.8287, R@10_HV=0.011

Early stopping at epoch 31

============================================================
Building scaffold bank (mode: benchmark)...
============================================================
Benchmark mode: using only training data (no data leakage)
[benchmark mode] Training data: HV=129, HJ=62, LV=108, LJ=71
Bank built: ScaffoldBank(HV=129, HJ=62, LV=108, LJ=71)
Bank saved to checkpoints/scaffold_v1/scaffold_bank_benchmark.json

============================================================
Demo: Retrieving scaffolds for first sample
============================================================
Ground truth:
  HV: NAGVTQTPKFRVLKTGQSMTLLCAQDMNHEYMYWYRQDPG...
  HJ: SYEQYFGPGTRLTVT

H_V top-3:
  1. score=0.514, seq=AQKITQTQPGMFVQEKEAVTLDCTYDTSDPSYGLFWYKQP...
  2. score=0.499, seq=NAGVTQTPKFRVLKTGQSMTLLCAQDMNHEYMYWYRQDPG...
  3. score=0.407, seq=DAGVTQSPTHLIKTRGQQVTLRCSPKSGHDTVSWYQQALG...

H_J top-3:
  1. score=0.522, seq=NSGYSTLTFGKGTMLLVSP...
  2. score=0.513, seq=NSGNTPLVFGKGTRLSVIA...
  3. score=0.391, seq=SYNTDKLIFGTGTRLQVFP...

L_V top-3:
  1. score=0.514, seq=AQKITQTQPGMFVQEKEAVTLDCTYDTSDPSYGLFWYKQP...
  2. score=0.499, seq=NAGVTQTPKFRVLKTGQSMTLLCAQDMNHEYMYWYRQDPG...
  3. score=0.407, seq=DAGVTQSPTHLIKTRGQQVTLRCSPKSGHDTVSWYQQALG...

L_J top-3:
  1. score=0.522, seq=NSGYSTLTFGKGTMLLVSP...
  2. score=0.513, seq=NSGNTPLVFGKGTRLSVIA...
  3. score=0.391, seq=SYNTDKLIFGTGTRLQVFP...

Training complete! Models saved to checkpoints/scaffold_v1
Done at Mon Dec  1 04:30:24 +08 2025
